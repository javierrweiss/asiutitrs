/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"8233E102-E1AE-4C2B-B026-76D6F74BEB6B",variableType:4}
 */
var fichaaneste_modificacion = 0;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"694A58C0-DAA7-4D42-9465-05F102A56F3A",variableType:4}
 */
var fichaaneste_vLegajo = 0;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"B96468A4-D0A0-411E-AF4D-B6A240E3881A",variableType:4}
 */
var fichaaneste_vLega = 0;

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"4BFD360A-60F7-4948-849A-AA9B753E9173"}
 */
var fichaaneste_vOperador = null;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"B6E2E223-1986-4376-B405-8BBDED2C9FD2",variableType:4}
 */
var fichaaneste_anes_carga_fecha = null;

/**
 * @properties={typeid:35,uuid:"47CFB753-40C1-4071-90BB-390CEC845E11",variableType:-4}
 */
var gbl_permisos = new Array();

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"398D330F-1EA7-4888-A98B-557ED002BB2D",variableType:4}
 */
var fichaaneste_anes_carga_hora = null;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"984B8059-A89D-4335-B725-8945CFF36661",variableType:4}
 */
var fichaaneste_nro_anestesia = null;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"485DB0A6-67A2-4C1C-A734-9C10CD6A36BA",variableType:4}
 */
var fichaaneste_ayudante_tipo = null;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"856A22ED-A06D-49F2-8C17-3192B461934E",variableType:4}
 */
var fichaaneste_auxiliar_tipo = null;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"6E580D87-EC91-4871-998D-3512453878A1",variableType:4}
 */
var fichaaneste_cirujano_tipo = null;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"6D5E98FC-1DB0-4618-AB91-0DB42FC9ABA2",variableType:4}
 */
var fichaaneste_protocolo = null;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"26750EF1-33DA-4966-9987-7A0C87BB5879",variableType:4}
 */
var fichaaneste_hora_inicio_grilla = null;

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"35ECB389-4677-40F0-AD83-B91175E9DDD8"}
 */
var fichaaneste_cirujano_nombre = null;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"A8908D8C-E72E-4E3D-85A2-C889A49A0225",variableType:4}
 */
var fichaaneste_cirujano_cod = null;

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"EAE870EE-8A83-4986-B6D7-3C55B55FA473"}
 */
var fichaaneste_cirujano_alf = null;

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"06C1DD58-8DC3-4670-9F4F-738F6FEEF000"}
 */
var fichaaneste_anestesiologo_nombre = null;

/**
 * @properties={typeid:35,uuid:"9AB6F8C9-B0F6-41AA-B67C-C3D5286C5B67",variableType:-4}
 */
var EsAnestesista = false;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"4409408F-3E2F-4D6D-9153-12922BBE0DEE",variableType:4}
 */
var fichaaneste_anestesiologo_tipo = null;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"EF4C09D0-66EB-42B0-9A03-05B872EA2AD8",variableType:4}
 */
var fichaaneste_histcliuni = null;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"D0583F83-AE26-4DDB-9271-8B00C767DEF9",variableType:4}
 */
var fichaaneste_tipoPac = 0;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"5B3D1574-072B-4E5A-A47B-5308952778EB",variableType:4}
 */
var fichaaneste_obrasocial = null;

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"2D055238-145B-49F1-B163-5B135D8A09D3"}
 */
var fichaaneste_interven_des = null;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"6F41ABBD-5EA9-427E-937E-1B6753CB0E23",variableType:4}
 */
var fichaaneste_interven = null;

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"5E3610A8-82AF-474F-8EA4-AC5A24921088"}
 */
var fichaaneste_vHisclistrynro = null;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"4063352F-F3FB-40B7-9E4E-3189B34A8C3D",variableType:4}
 */
var fichaaneste_horas_agregar = 0;

/**
 * @type {Date}
 *
 * @properties={typeid:35,uuid:"D35E3757-F35D-4B2E-A71E-53056A962E02",variableType:93}
 */
var fichaaneste_vfecha_inicial = new Date();

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"39CDB720-88E7-4C25-81F3-BF10A9037EBE",variableType:4}
 */
var fichaaneste_vanes_hora_ini = null;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"B0DD94D6-051C-410F-83A0-AE8A38E0F8A6",variableType:4}
 */
var fichaaneste_vurgencia = 0;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"D260F07C-F26A-4E14-8041-34B7177DE1C6",variableType:4}
 */
var fichaaneste_vpresion_min = 0;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"B65D701D-2970-4943-9B52-E27AD45E5CC2",variableType:4}
 */
var fichaaneste_vpresion_max = 0;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"DA5E757E-503D-4CD2-9E4D-D12984810B55",variableType:4}
 */
var fichaaneste_pasomin = 5;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"348C9CEF-02B4-41B1-BA3F-CE9CC790E481",variableType:4}
 */
var fichaaneste_horas = 2;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"D5DC8C69-EA74-4701-B38B-2069DF37F40F",variableType:4}
 */
var fichaaneste_vpiso = null;

/**
 * @type {Date}
 *
 * @properties={typeid:35,uuid:"092D6E80-EFFC-4F77-A116-5451D774DE96",variableType:93}
 */
var fichaaneste_hora_inicio_grilla_date = new Date();

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"1392EE34-DA1E-43BD-81A8-88A18EB9FA08",variableType:4}
 */
var fichaaneste_med_cod = null;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"0B749EAF-79C9-482F-8171-8F8A00FF59C8",variableType:4}
 */
var fichaaneste_cab_id = null;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"3D192DA9-8DCB-4116-B1C3-A0F489253A71",variableType:4}
 */
var fichaaneste_vdos = 2;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"E6C494D7-C06C-444E-970C-D79AE688E691",variableType:4}
 */
var fichaaneste_vuno = 1;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"32E6E03E-11F6-41E8-83B5-F2D51E9CEB19",variableType:4}
 */
var fichaaneste_vop_propuesta = null;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"C44D65C4-85A9-497C-B6E1-0B4821F884C6",variableType:8}
 */
var fichaaneste_vpulso = null;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"381289AF-239D-4CC5-AFC2-2C4531052BAE",variableType:4}
 */
var fichaaneste_vriesgo = null;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"70252173-EDE1-4354-A9FC-C6F19705A20E",variableType:4}
 */
var fichaaneste_vfecha8 = null;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"2BA13CF4-2ADC-4E2C-B083-3476C38A3FCE",variableType:4}
 */
var fichaaneste_vfecnac = null;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"9BFC767D-8A39-4226-9D66-B2FD71D45A2E",variableType:4}
 */
var fichaaneste_vhabita = null;

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"789EF08C-9917-4D12-9704-45D977BEB6D9"}
 */
var fichaaneste_vcama = null;

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"0CE5E6C2-9A71-498F-AF2D-F0458BC41CC1"}
 */
var fichaaneste_valfa = '';

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"D5781BFC-E0C6-4E4F-925D-CB62DA560EE9"}
 */
var fichaaneste_vmensaje = null;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"0C3F129D-05CE-4043-B0D6-D81AFEBF0459",variableType:4}
 */
var fichaaneste_vhora = null;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"DAE696D8-B188-4E7A-816F-71ACF26E3C09",variableType:4}
 */
var fichaaneste_anestesiologo_legajo;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"BC7E0389-3DBE-4A0E-AB36-E8B2E1247C41",variableType:4}
 */
var fichaaneste_vcero = 0;

/**
 * @type {Date}
 *
 * @properties={typeid:35,uuid:"A2F1AA6C-27B9-4F33-B9F8-425254FE5B94",variableType:93}
 */
var fichaaneste_vfecha = null;

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"BD718B83-8671-4F50-9773-17316C64D091"}
 */
var fichaaneste_vpaciente = null;

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"C926E3D8-5CB5-4DE1-A804-EEC8E883935E"}
 */
var fichaaneste_medico = null;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"3E0594E2-EE25-4DA2-8F09-80B134E09234",variableType:4}
 */
var fichaaneste_histcli = null;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"FE8753C9-8613-408F-83BA-228B012751B2",variableType:4}
 */
var fichaaneste_vedad = null;

/**
 * @AllowToRunInFind
 * 
 * @param args
 *
 * @properties={typeid:24,uuid:"814F3805-1F8B-41B7-82AD-4B20E5360DE5"}
 */
function llamada_desde_Menu(args) {
	 
	// Trae datos desde el Menu
	args = args.toString()
	args=args.split(';') 
	globals.vLegajo=utils.stringToNumber(args[0])
	globals.vLega=utils.stringToNumber(args[1])
	globals.vOperador=args[2]
	//**//**//**//  salvar estas tres variables porque al volver no dibuja el menu del usuario con
	//  el que se ingreso al menu
	scopes.globals.fichaaneste_vLegajo   = globals.vLegajo   
	scopes.globals.fichaaneste_vLega     = globals.vLega      
	scopes.globals.fichaaneste_vOperador = globals.vOperador
	//**//**//**// 
	globals.vTipoOperador=utils.stringToNumber(args[3])
	globals.gbl_transacciones_1=args[4] 
	globals.vEmpresa=args[5]	
	globals.gbl_expanding_Nodes=args[6] 
	globals.gbl_title = ' '
	
	//Cargar permisos
	var $ip         = application.getIPAddress()
	var $solucion   =  application.getSolutionName()	
	var $Args       = new Array()
	var $SQL ="select  PERF.codigo_perfil, PERF.codigo_solucion, PERF.codigo_formulario, PERF.codigo_elemento, " 
             +"PERF.visible, PERF.accesible, SOL.control_acceso "
	         +"from tbl_permiso "
             +"left join tbl_perfil_itm PERF on tbl_permiso.codigo_perfil = PERF.codigo_perfil "
             +"left join tbl_solucion SOL on PERF.codigo_solucion = SOL.codigo "
             +"where tbl_permiso.codigo_legajo = "
             + globals.vLega
			 if (globals.vLega == 0){
				 $SQL = $SQL + " and ip = '"
				 + $ip + "'"
			 }
			 $SQL = $SQL + " and PERF.codigo_solucion = '"
			 + $solucion
             +"' order by PERF.codigo_perfil asc, PERF.codigo_solucion asc, PERF.codigo_formulario asc, PERF.codigo_elemento asc"
    gbl_permisos = databaseManager.getDataSetByQuery("desal", $SQL, $Args, -1);	
    var $max = gbl_permisos.getMaxRowIndex()
	if(!$max){ return}
    
    //Pide legajo si la Solucion lo requiere
    if(gbl_permisos.getValue(1,7)== true){
    	var win = application.createWindow("Legajo",JSWindow.MODAL_DIALOG)	
        win.title= 'Legajo'
        win.resizable = false
        win.show(forms.psw_legajo)
		win.destroy()
		if(globals.gbl_user == false){return}
    }
	//Muestra Formulario Principal 

	if(globals.gbl_transacciones_1 != 0){
	    var $form = ''
	    switch (globals.gbl_transacciones_1){		
		    case  1: $form = 'fichaaneste_cons'  
			       ;break
		    case  2: $form = 'fichaaneste_PideLegajo'
	                ;break		    
	     }

	     //Pide legajo si el Formulario lo requiere
	     if(gbl_permisos.getValue(1,7)== false){	    	 
			 var fs = databaseManager.getFoundSet("desal","tbl_formulario")
			 fs.find()
			 fs['codigo_solucion']= $solucion
			 fs['codigo']= $form
			 fs.search()
			 if(fs.getSize()>0 && fs['control_acceso'] == 1){
			   	 win = application.createWindow("Legajo",JSWindow.MODAL_DIALOG)	
	             win.title= 'Legajo'
	             win.resizable = false
	             win.show(forms.psw_legajo)
	 	 	     win.destroy()
	 	 	     if(globals.gbl_user == false){return}
			 }			 	          
	     }
	     win = application.createWindow("Menu_itm",JSWindow.MODAL_DIALOG)	
         win.title= globals.gbl_title
         win.resizable = false
         win.show(forms[$form])
		 win.destroy()
	}
}

/**
 * @param $form
 *
 * @properties={typeid:24,uuid:"AFB8ED23-6DBD-4223-A111-AC9282EC0B9D"}
 */
function controlar_elementos($form){
	var $tope_form = globals.gbl_permisos.getMaxRowIndex()
	var $element = forms[$form].elements.allnames
	var $tope_elem = $element.length
	
	for (var i = 1; i <= $tope_form; i++){		
		if ($form == globals.gbl_permisos.getValue(i,3)){
			for(var j=0;j <= $tope_elem; j++){
				if($element[j]== globals.gbl_permisos.getValue(i,4)){
					if(globals.gbl_permisos.getValue(i,5)==true){
						forms[$form].elements[$element[j]].visible = true
					}else{
						forms[$form].elements[$element[j]].visible = false
					}
					if(globals.gbl_permisos.getValue(i,6)==true){
						forms[$form].elements[$element[j]].enabled = true
					}else{
						forms[$form].elements[$element[j]].enabled = false
					}
					j = 99
				}
			}
		}
	}
}

/**
 * Callback method for when solution is closed, force boolean argument tells if this is a force (not stopable) close or not.
 *
 * @param {Boolean} force if false then solution close can be stopped by returning false
 *
 * @returns {Boolean}
 *
 * @properties={typeid:24,uuid:"06D019F1-AE26-4A46-A33C-A5B91F648ADF"}
 */
function onSolutionClose_AsiCirTrs_Fichaaneste(force) {
	// TODO Auto-generated method stub
	return globals.vClose
}

/**
 * Callback method for when solution is opened.
 *
 * @properties={typeid:24,uuid:"262FF252-DCB3-40FF-BDB2-BC51EFE77217"}
 */
function onSolutionOpen_AsiCirTrs_Fichaaneste() {
	globals.vClose = false
}
