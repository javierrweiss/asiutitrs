/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"B145559E-FF27-4AA0-A509-D418C8A55192",variableType:8}
 */
var gbl_sit_iva = 0;

/**
 * @properties={typeid:35,uuid:"8E92996E-E2F3-404B-B32A-8B105CEAE7A7",variableType:-4}
 */
var gbl_cerrarConsultaRegistro = false;
/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"DBFAC1D8-A1F9-4DD8-9C40-C217F092FB82"}
 */
var gbl_Form = ''
/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"86A6BE81-FEE8-43BD-A180-1A93A4BD8FBB",variableType:4}
 */
var gbl_orienta = 0
/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"4E1811ED-88D2-4E80-8228-E2BDA9B902F6",variableType:4}
 */
var gbl_ente = 0;

/**
 * @properties={typeid:35,uuid:"D95C8DE3-8B46-4CEB-A6DC-2DBB79E51CB1",variableType:-4}
 */
var gbl_permisos = new Array();

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"1139369F-B132-4A9F-B072-EEE9368FC526",variableType:4}
 */
var gbl_tabla = 0;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"99998C24-A109-4E53-A650-74C581ED623A",variableType:4}
 */
var gbl_codigo = 0;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"0149D2E7-7438-4055-B49A-2E7DF04B1A3A",variableType:4}
 */
var gbl_max2 = 0;

/**
 * @properties={typeid:35,uuid:"EFEB19E7-B9A9-4F55-87A9-8DFE7FC85F83",variableType:-4}
 */
var gbl_fec_actual = null;

/**
 * @properties={typeid:35,uuid:"A1D183EE-C727-4167-8A2A-4AE4F8A0EA72",variableType:-4}
 */
var gbl_index_5 = null;

/**
 * @properties={typeid:35,uuid:"49BF1522-DB4B-4745-AE05-3DFC8FFE99EB",variableType:-4}
 */
var gbl_index_6 = null;

/**
 * @properties={typeid:35,uuid:"528302E5-6189-4515-BEBE-BC66B4018400",variableType:-4}
 */
var gbl_index_7 = null;

/**
 * @properties={typeid:35,uuid:"98F92C65-A488-45AF-888C-6F7F2C6E17EC",variableType:-4}
 */
var gbl_index_4 = null;

/**
 * @properties={typeid:35,uuid:"E0590245-B636-4492-A61E-B794B3F058D0",variableType:-4}
 */
var gbl_index_3 = null;

/**
 * @properties={typeid:35,uuid:"A55F1B14-C817-488A-A709-9C7B3F1E5059",variableType:-4}
 */
var gbl_index_2 = null;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"CB9EFE39-2A90-4651-8377-5DAD459BA6FC",variableType:4}
 */
var gbl_tip_compras = 0;

/**
 * @properties={typeid:35,uuid:"2C946482-03E0-46B6-A572-CC08A6EEFE08",variableType:-4}
 */
var gbl_ano_tit = new Array();

/**
 * @properties={typeid:35,uuid:"9A3B0168-2A4D-426F-9380-EA2DDEA90503",variableType:-4}
 */
var gbl_mes_tit = new Array();

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"C3870215-3DAB-45C6-8029-8535E5AEA2B5",variableType:4}
 */
var gbl_categclie = 0;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"6B96A5EF-8196-46F5-A7F5-F4F4F075B72B",variableType:4}
 */
var gbl_comparar = 0;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"65955994-7EBF-44C7-BEF3-3B8F469E041B",variableType:4}
 */
var gbl_sector = 0;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"E6CE82F3-C75F-428A-B152-D5DCE64B679E",variableType:4}
 */
var gbl_meses = 0;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"A99B12E1-AE0F-46CF-9EAE-C848611C723E",variableType:4}
 */
var gbl_agrupacion = 1;

/**
 * @properties={typeid:35,uuid:"9ABC8EA9-7D3D-4C42-B3DC-441B5518E37F",variableType:-4}
 */
var periodo_tabla_per = new Array();

/**
 * @properties={typeid:35,uuid:"A019FD05-E76F-4308-9EC7-6BE94CB51A17",variableType:-4}
 */
var gbl_razonsoc = null;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"21E26B8C-2F7C-4756-BEED-91B4E42B7F2C",variableType:4}
 */
var gbl_periodo = 0;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"3DE35588-3970-42EC-834B-9BB13AB3DC55",variableType:4}
 */
var gbl_tipmov = 0;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"CF4910D9-F5A0-4E11-93A2-CA5DF7108F4D",variableType:4}
 */
var gbl_tipoprest = 0;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"C67324A5-27CF-4990-9BC2-BD75A1996188",variableType:4}
 */
var gbl_concepto = 0;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"0CA1189F-8703-4E72-A7E9-450B02A7B652",variableType:4}
 */
var gbl_subconcepto = 0;

/**
 * @properties={typeid:35,uuid:"E897DF07-A238-4AD4-8BD8-51915352F0BF",variableType:-4}
 */
var gbl_periodo_desde = null;

/**
 * @properties={typeid:35,uuid:"AB5F2DD2-C851-445C-8A70-70A62478CFA7",variableType:-4}
 */
var gbl_periodo_hasta = null;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"3D9D907C-F9D5-4388-81BA-6E10107FD583",variableType:4}
 */
var gbl_index = 0;

/*** 
 * @param formname
 * @param rec
 * @param orienta
 * @properties={typeid:24,uuid:"6296E36F-BD96-45AF-ACAE-D65CDC312E88"}
 */
function printRoutine(formname, rec, orienta) {
	gbl_Form = formname;
	var oneRecord = rec;
    gbl_orienta = orienta;
	if(!oneRecord) oneRecord = false

	if(!gbl_Form) return;
	
	var win = application.createWindow("prn",JSWindow.MODAL_DIALOG)	
	win.title= ' '
	win.resizable = true
	win.setSize(1300,800)
	solutionModel.removeForm
	win.show(forms.prn_previous)
	win.hide()
	win.destroy()
}

/*** 
 * @param args
 *
 * @properties={typeid:24,uuid:"79CD714B-00F2-416C-867F-B82DDD27A711"}
 * @AllowToRunInFind
 */
function llamada_desde_Menu(args) { 

	// Trae datos desde el Menu
	args = args.toString()
	args=args.split(';') 
	globals.vLegajo=utils.stringToNumber(args[0])
	globals.vLega=utils.stringToNumber(args[1])
	globals.vOperador=args[2]
	globals.vTipoOperador=utils.stringToNumber(args[3])
	globals.gbl_transacciones_1=args[4] 
	globals.vEmpresa=args[5]	
	globals.gbl_expanding_Nodes=args[6] 
	globals.gbl_title = ' '
	
	//Cargar permisos
	var $ip         = application.getIPAddress()
	var $solucion   =  application.getSolutionName()	
	var $Args       = new Array()
	var $SQL ="select  PERF.codigo_perfil, PERF.codigo_solucion, PERF.codigo_formulario, PERF.codigo_elemento, " 
             +"PERF.visible, PERF.accesible, SOL.control_acceso "
	         +"from tbl_permiso "
             +"left join tbl_perfil_itm PERF on tbl_permiso.codigo_perfil = PERF.codigo_perfil "
             +"left join tbl_solucion SOL on PERF.codigo_solucion = SOL.codigo "
             +"where tbl_permiso.codigo_legajo = "
             + globals.vLega
			 if (globals.vLega == 0){ 
				 $SQL = $SQL + " and ip = '"
				 + $ip + "'"
			 }
			 $SQL = $SQL + " and PERF.codigo_solucion = '"
			 + $solucion
             +"' order by PERF.codigo_perfil asc, PERF.codigo_solucion asc, PERF.codigo_formulario asc, PERF.codigo_elemento asc"
    gbl_permisos = databaseManager.getDataSetByQuery("desal", $SQL, $Args, -1);	
    var $max = gbl_permisos.getMaxRowIndex()
	if(!$max){ return}
    
    //Pide legajo si la Solucion lo requiere
    if(gbl_permisos.getValue(1,7)== true){
    	var win = application.createWindow("Legajo",JSWindow.MODAL_DIALOG)	
        win.title= 'Legajo'
        win.resizable = false
        win.show(forms.psw_legajo)
		win.destroy()
		if(globals.gbl_user == false){return}
    }
	//Muestra Formulario Principal 
	if(globals.gbl_transacciones_1 != 0){
	    var $form = ''
	    switch (globals.gbl_transacciones_1){		
		    case  1: $form = 'frm_convenios_prof_convenios'
			       ;break
		    case  2: $form = 'frm_convenios_prof_convenios_aumentos'
		           ;break
		    case  3: $form = 'frm_liquid_prof_validacion'
		           ;break
		    case  4: $form = 'frm_cons_liquid_honorarios_med'
	               ;break
		    case  5: $form = 'frm_cons_convenios_prof_convenios'
	               ;break
	     }
	     
	     //Pide legajo si el Formulario lo requiere
	     if(gbl_permisos.getValue(1,7)== false){	    	 
			 var fs = databaseManager.getFoundSet("desal","tbl_formulario")
			 fs.find()
			 fs['codigo_solucion']= $solucion
			 fs['codigo']= $form
			 fs.search()
			 if(fs.getSize()>0 && fs['control_acceso'] == 1){
			   	 win = application.createWindow("Legajo",JSWindow.MODAL_DIALOG)	
	             win.title= 'Legajo'
	             win.resizable = false
	             win.show(forms.psw_legajo)
	 	 	     win.destroy()
	 	 	     if(globals.gbl_user == false){return}
			 }			 	          
	     }
	     win = application.createWindow("Menu_itm",JSWindow.MODAL_DIALOG)	
         win.title= globals.gbl_title
         win.resizable = false
         win.show(forms[$form])
		 win.destroy()
	}
}

/**
 * @properties={typeid:24,uuid:"91EF6EC1-A9A5-437D-8133-08E3573D1C63"}
 */
function onSolutionOpen_quitar_menu() { 
	plugins.window.getMenuBar().setVisible(false)
    plugins.window.setToolBarAreaVisible(false)
    
    var names1 = plugins.window.getToolbarNames();
    for (var i = 0 ; i < names1.length ; i++) {
         plugins.window.removeToolBar(names1[i])
    }    
    plugins.window.setFullScreen(false)
    plugins.window.maximize()
    plugins.window.getMenuBar().setVisible(false)
    plugins.window.setToolBarAreaVisible(false)
    
	plugins.scheduler.addCronJob("actualiza_hora",'0 0/1 * * * ?',actualiza_hora_conv)
}

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"9CAA51CF-CB11-4CC5-B328-108035F2B062"}
 */
var gbl_operador = ''
	
/**
 * @properties={typeid:24,uuid:"28804D56-3089-404A-81EC-11C555AE0600"}
 */
function actualiza_hora_conv() { 
	globals.gbl_fecha_hoy = application.getServerTimeStamp()
}

/**
 * TODO generated, please specify type and doc for the params
 * @param nombre
 *
 * @properties={typeid:24,uuid:"D1AAA580-512B-40B4-80FE-ED1CC811470D"}
 */
function abreviarNombre(nombre){
	return nombre.replace(/\b(\w)\w+/g, '$1.')
    .replace(/\s/g, '')
    .replace(/\.$/, '')
    .toUpperCase();
}
/**
 * 
 * @param $form
 *
 * @properties={typeid:24,uuid:"BF7D5D10-A880-41B0-A188-8353F119614D"}
 */
function controlar_elementos($form){ 
	var $tope_form = globals.gbl_permisos.getMaxRowIndex()
	var $element = forms[$form].elements.allnames
	var $tope_elem = $element.length
	
	for (var i = 1; i <= $tope_form; i++){		
		if ($form == globals.gbl_permisos.getValue(i,3)){
			for(var j=0;j <= $tope_elem; j++){
				if($element[j]== globals.gbl_permisos.getValue(i,4)){
					if(globals.gbl_permisos.getValue(i,5)==true){
						forms[$form].elements[$element[j]].visible = true
					}else{
						forms[$form].elements[$element[j]].visible = false
					}
					if(globals.gbl_permisos.getValue(i,6)==true){
						forms[$form].elements[$element[j]].enabled = true
					}else{
						forms[$form].elements[$element[j]].enabled = false
					}
					j = 99
				}
			}
		}
	}
}