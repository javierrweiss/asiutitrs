/**
 * @properties={typeid:35,uuid:"B403A131-3F15-4AF1-93AB-CA352A3F2D40",variableType:-4}
 */
var $_wHayArm = false;

/**
 * @properties={typeid:35,uuid:"602F623B-BFD1-4243-83F4-1D164BB7FA6D",variableType:-4}
 */
var isValid = true;

/**
 * @properties={typeid:35,uuid:"EA9E710A-9078-4A4B-AE9D-FE64644158C8",variableType:-4}
 */
var f_aislado_paciente = false;

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"C9801F79-D58E-4E3A-84F0-1C50F5AA7017"}
 */
var f_analgésicos = '';


/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"716F8184-DFE7-494C-B081-A21E3CF25E18"}
 */
var f_disnea = ''


/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"BABEF82E-59DE-436A-BA30-213217576049"}
 */
var f_mecanica = '';


/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"4E560D7E-114B-4DAC-BF4D-291B77359852",variableType:4}
 */
var f_bloqueantes_neuromsuculares = 0

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"172060BB-BD09-47E2-880D-06A2DEB429DC",variableType:4}
 */
var f_cam_icu = 0;

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"EBA1E974-5E03-4387-88F1-065C41728ED7"}
 */
var f_sedación = '';

/**
 * @properties={typeid:35,uuid:"D79D09C1-FE7B-40AF-9BC9-A586F829F797",variableType:-4}
 */
var bloqueado = false;

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"16F8DE2B-0A97-4CF3-9F60-51503FDF6DD7"}
 */
var messageError = '';

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"845E6F34-CAC3-437C-85F2-5D2DDAC0EC16",variableType:4}
 */
var f_arm = 0;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"D8EEE70A-A936-4C22-A35C-C88AC425F9E0",variableType:4}
 */
var AsiVm_Monitoreo_grupoTxt = 0;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"B48199CA-D5B9-4170-9EAB-056CEB23DFE4",variableType:4}
 */
var AsiVm_Monitoreo_lineaTxt = 0;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"5345E0E2-E2B7-435E-AB5B-835BD2C84671",variableType:4}
 */
var AsiVm_Monitoreo_horaTxt = 0;

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"02F74B39-4413-485B-BBBE-14A1A0C46140"}
 */
var f_derivado = null;

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"A5825010-15D6-41DB-AD73-7E0AC6F55AEA"}
 */
var f_ingresoUco = null;

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"786D2008-8318-4C62-90E7-BEE6A855EA58"}
 */
var f_ingresoSanatorio = null;

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"950D604D-F9D2-4B73-8EF7-87817D69ABD0"}
 */
var $_msgSMS = '';

/**
 * @properties={typeid:35,uuid:"4E0A638B-15AE-4889-BB28-FA6BCAB0C033",variableType:-4}
 */
var $_listNumberSMS = new Array();

/**
 * @properties={typeid:35,uuid:"F4AE559B-99A6-495E-AD0E-73606A5EF3A1",variableType:-4}
 */
var $_wtrau = false;

/**
 * @properties={typeid:35,uuid:"6F4DB90F-38A5-448C-9D44-CB2E2A8A9560",variableType:-4}
 */
var $_wsele = false;

/**
 * @properties={typeid:35,uuid:"C7DF5380-79C8-4916-8A68-0C68BB5145C8",variableType:-4}
 */
var $_isUserOSTEE = false;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"3D08E005-B4B9-452B-A1CD-87A69F83B026",variableType:4}
 */
var $_countChange = 1;

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"2E628C57-A16E-467F-A182-5181E27CC6F9"}
 */
var f_habita = null;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"E8B6EF3E-2311-4D27-A5C0-89376B713B9E",variableType:4}
 */
var f_lugar_internacion = 0

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"2E425C79-8394-4CCB-BEEB-9CE2705C0388"}
 */
var f_cama = null;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"05C8BD2B-F2DF-4A3E-973A-FF3D42D6493F",variableType:4}
 */
var f_marca_arm = -1

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"2EA77286-D3EF-4324-9C05-4F2F4E6A563D",variableType:4}
 */
var f_sexo = null;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"AE7AB9DE-0A79-45E5-ABE3-E59C63204006",variableType:4}
 */
var f_soporte_ventilatorio = 0 // 1,2


/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"A54C7189-F82C-4E7E-8BB5-AE91FBF1E472"}
 */
var f_fecha_monitoreo = ''



/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"07657022-91CB-45BD-BE85-C33E47E1761B"}
 */
var f_modo_ventilatorio = ''

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"1457FEAB-0323-4E63-86B5-C39106DDDDC3",variableType:4}
 */
var f_pulso_frecuencia = 0;


/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"32C2C937-2650-4C51-AF30-A5C1DBE9ABFC",variableType:4}
 */
var f_estado_general_frecuencia_respiratoria = 0;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"7F1B2CF5-D303-46B2-AED7-AE1CEBD6BC80",variableType:4}
 */
var f_saturacion = 0;
/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"5E487D6E-7D8D-4740-AED2-98EC96E54E84",variableType:4}
 */
var f_tension_arterial_min = 0;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"8A6B4F79-5125-45B0-A37C-8D92789DDFFB",variableType:4}
 */
var f_tension_arterial_max = 0;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"D00D39AE-590B-4ADB-AF43-C2CFFD2DD8CD",variableType:4}
 */
var f_tension_arterial_media = 0;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"4A38D0E0-BFC5-4112-9F5B-390BF484AC28",variableType:4}
 */
var f_frecuencia_cardiaca = 0;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"E12F1386-34FF-483E-9869-96D769BBE9AC",variableType:4}
 */
var f_rass = 0;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"D6BB57F9-F5C4-438E-8FAC-FEE728F00327",variableType:4}
 */
var f_frecuencia_respiratoria = 0;



/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"7E702E79-CE6C-46AF-B162-067D6A627B0C"}
 */
var f_cpot = '';


/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"C22431CD-AF23-4F06-9002-1D47E59E4C61",variableType:8}
 */
var f_temperatura = 0.0;

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"6056CB70-F6CD-4220-86C8-537C9D99B728"}
 */
var f_tipo_temperatura = ' ';

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"18CC212C-B5DE-4FB4-AA23-3BEEAEAB6A58"}
 */
var f_tipo_sonda = ' ';

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"B8FC499D-B1B9-47D3-A723-E9D87B2C23E5"}
 */
var f_patologia1 = '';

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"0AE8B1D0-9D02-4867-B4A4-0F5BA726A24E"}
 */
var f_patologia2 = '';

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"5EF6CDB6-8179-4101-A726-600856E7C150"}
 */
var f_patologia3 = '';

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"EC298050-F963-4971-BB58-9F0D175A399B"}
 */
var f_patologia = '';

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"A5F9C829-DB09-46CC-BDE7-980835417B5A"}
 */
var f_descripcion_patologia1 = '';

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"EE673CEC-8209-4DBE-A776-ED89079A838E"}
 */
var f_descripcion_patologia2 = '';

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"CB2FB1E1-50B7-4F16-93A7-D611A2911590"}
 */
var f_descripcion_patologia3 = '';

/**
 * @properties={typeid:35,uuid:"C0F2E7FF-3E9D-4A0F-8971-764788493467",variableType:-4}
 */
var f_cerrarForm = false;

/**
 * @properties={typeid:35,uuid:"82D65E52-D3D2-49DB-A825-062D295AE190",variableType:-4}
 */
var $isDirty = false;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"CE1DD5B7-9D29-498D-9719-AE15C3A74998",variableType:4}
 */
var f_protocolo = null;

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"F6A11DAB-E243-4E30-BEA9-0DD7F1D48EFC"}
 */
var $messageErrorInter = null;

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"64ED7FAA-9018-47DF-8643-50BC60B526D5"}
 */
var f_medico = null;

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"2958D0B3-DD74-4127-A9BA-A7452F4307AB"}
 */
var f_edad = null;

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"EC23BBA9-268C-4284-BE11-BF74D2DD9AFF"}
 */
var f_cobertura = null;

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"5EA11E53-5B34-4F1C-8530-F21DCA732562"}
 */
var f_histClinUnica = null;

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"A5AF99D5-A570-4FCC-AB0B-95646084B6C4"}
 */
var f_paciente = null;

/**
 * @properties={typeid:35,uuid:"1EE8109D-79FD-4473-8EF0-F2724060A1DD",variableType:-4}
 */
var $_AsiVm_Monitoreo_READ_ONLY = false;

/**
 * @properties={typeid:35,uuid:"9EC9782B-EC87-49CF-ACC8-DAFA258B1C76",variableType:-4}
 */
var $_AsiVm_Monitoreo_Recurso_Tomado = false;

/**
 * TODO generated, please specify type and doc for the params
 * @param firstShow
 * @param event
 *
 * @properties={typeid:24,uuid:"445A4428-CEFA-4340-8C08-3A25BD58A2A4"}
 */
function onShow_inicializarForm(firstShow, event) {

	//initFormFirstShow();
	elements.txt_paciente.requestFocus(); 
}

/**
 * Perform the element default action.
 *
 * @param {JSEvent} event the event that triggered the action
 *
 * @properties={typeid:24,uuid:"0323684E-7AFE-40A8-AD1C-1CBF7AD9B091"}
 */
/*function onAction_btnBuscarPaciente(event) {

	globals.AsiVm_Monitoreo_eventSourceButton = 1;
	openSearch();
}


function openSearch() {

	var win2 = application.createWindow("seleccion_internado", JSWindow.MODAL_DIALOG);
	win2.title = 'Búsqueda de Pacientes Internados';
	win2.resizable = false;
	win2.show(forms.AsiVm_Monitoreo_dlg_buscar_internado);

}*/

/**
 * @properties={typeid:24,uuid:"FBC5B57D-31D5-4193-BA4A-729AD036472B"}
 * @AllowToRunInFind
 * @SuppressWarnings(wrongparameters)
 */
function loadData() {
	globals.AsiVm_Monitoreo_bloqueado=false;
	$_AsiVm_Monitoreo_READ_ONLY = false;
	relacionBuscarAdmision = asivm_rel_buscar_admision
		
	if(asivm_rel_buscar_admision.getSize()==0){
		relacionBuscarAdmision = asivm_rel_buscar_admision_con_alta
	}
	bloqueado = globals.AsistFunciones_isRegisterTableLocked(application.getSolutionName(),controller.getName(),relacionBuscarAdmision.adm_histclin.toString(),globals.Srv_Login_Sanatorio_vLega.toString(),"Monitoreo de Ficha", null, null);
	//si bloqueado solo readonly
	if(bloqueado){
		$_AsiVm_Monitoreo_READ_ONLY = true;
		//globals.DIALOGS.showWarningDialog("Recurso en Uso","La historia clínica que quiere acceder esta siendo usada actualmente por otro profesional. Aguarde o reintente mas tarde para poder editar información o Agregar Nueva Historia")
	}else{
		$_AsiVm_Monitoreo_Recurso_Tomado = true;
		
	}
	if(!bloqueado){//si NO ESTA EN USO
		var message = '';
		globals.AsiVm_Monitoreo_bloqueado = true
		if (asivm_ficha_monitoreo!=null && asivm_ficha_monitoreo.getSize() ==1){
				$_AsiVm_Monitoreo_READ_ONLY = true
//				configurarCamposSegunPrestacion();
				setFieldRequired();
				elements.btn_imprimir.enabled=true
				cargarDatos();
				if(globals.AsiVm_Ficha_Cerrada || $_AsiVm_Monitoreo_READ_ONLY){
					var dias = globals.contar_dias(asivm_ficha_monitoreo.fecha,application.getServerTimeStamp())
					if(globals.Srv_Login_Sanatorio_vLegajo!='118319' && dias>=1){
//if(dias>=1){
						setReadOnlyField();
						elements.btn_grabar.enabled=false
					}else{
						elements.btn_grabar.enabled=true
					}
					
					
				}
				/*if($_AsiVm_Monitoreo_READ_ONLY){
					mostrarSoloLectura();
				}else{
					mostrarModoEditable();
				}*/
				$isDirty = false;
		} 
		else { // FICHA NUEVA
//				editable(false);
				setEnableFields()
				f_paciente = formatear_HistClinInter(asivm_rel_buscar_admision.adm_histclin) + ' ' + utils.stringTrim(asivm_rel_buscar_admision.adm_apelnom);
				f_histClinUnica = asivm_rel_buscar_admision.adm_histclinuni;
				globals.AsiVm_histClinUnica  = asivm_rel_buscar_admision.adm_histclinuni;
				f_sexo = asivm_rel_buscar_admision.adm_sexo;
				f_edad = globals.CalculoEdad(asivm_rel_buscar_admision.adm_fecnac) + ' ' + globals.vTipoEdad;
				f_habita = asivm_rel_buscar_admision.adm_habita;
				f_cama = asivm_rel_buscar_admision.adm_cama;
//				configurarCamposSegunPrestacion(); //habilita o deshablita campos segun prestacion
				setFieldRequired()
				elements.btn_grabar.enabled=true
//				elements.btn_grabar.enabled=true
//				forms.AsiVm_Monitoreo.elements.btn_imprimir.readOnly=true
				//scopes.globals.AsiVm_Monitoreo_fechaHciint= fechaHoy;
				asivm_ficha_monitoreo.newRecord();
				scopes.globals.InicializarDatosDeRelacion(asivm_ficha_monitoreo, "desal", "fichakine_monitoreo")
				asivm_ficha_monitoreo.histcli = scopes.globals.AsiVm_hisclin
//				asivm_ficha_monitoreo.fichavm = scopes.globals.AsiVm_ficha_id // cuando agrega nuevo pone 0, mal. hay que poner ficha_kine_id
				asivm_ficha_monitoreo.fichavm = asivm_fichakine.ficha_id
//				
				forms.AsiVm_tab_Monitoreo_VM.elements.txt_delta_presion.editable=false
				forms.AsiVm_tab_Monitoreo_VM.elements.txt_compliance.editable=false
//				visibleBody(true);
//				elements.txt_frecuencia_respiratoria.requestFocus();	
		}
		elements.txt_frecuencia_respiratoria.requestFocus();
	}else{
		f_cerrarForm = true;
		 limpiarForm();
			var $win = application.getWindow(application.getActiveWindow().getName());
			if ($win != null) {
				$win.hide();
				$win.destroy();
			}
	}
			

}


/**
 * @properties={typeid:24,uuid:"8C00C0FD-E1E4-4AEB-939F-DB8A2793E77F"}
 */
function setReadOnlyField(){
	var funcion = globals.setearEnModoLecturaCampos;
	globals.modificarCampos("AsiVm_Monitoreo", funcion,'txt_');
	globals.modificarCampos("AsiVm_Monitoreo", funcion,'cbo_');
	globals.modificarCampos("AsiVm_Monitoreo", funcion,'multi_')
	forms.AsiVm_tab_Monitoreo_VM.elements.grp_tab_monitoreo.readOnly=true
	forms.AsiVm_tab_EAB.elements.grp_eab.readOnly=true
//	forms.AsiVm_tab_seteo_vni.elements.grp_seteo.readOnly=true
//	forms.AsiVm_tab_Programacion.elements.grp_cnaf_vm.readOnly=true
//	forms.AsiVm_tab_Programacion.elements.grp_cnaf_vm_caf.readOnly=true
//	forms.AsiVm_tab_Programacion.elements.grp_cnaf_caf.readOnly=true
	forms.AsiVm_tab_Varios.elements.grp_varios.readOnly=true
	forms.AsiVm_tab_seteo_vm.elements.grp_seteo_vm.readOnly=true
	forms.AsiVm_tab_seteo_vni.elements.grp_seteo_vni.readOnly=true
	forms.AsiVm_tab_cnaf.elements.grp_cnaf.readOnly=true
	
}

/**
 * @properties={typeid:24,uuid:"2A806399-872A-4D06-9008-99B0F7F7C9A8"}
 */
function setEnableFields(){
	var funcion = globals.habilitarCampos;
	globals.modificarCampos("AsiVm_Monitoreo", funcion,'txt_');
	globals.modificarCampos("AsiVm_Monitoreo", funcion,'cbo_');
	globals.modificarCampos("AsiVm_Monitoreo", funcion,'multi_')
	forms.AsiVm_tab_Monitoreo_VM.elements.grp_tab_monitoreo.readOnly=false
	forms.AsiVm_tab_EAB.elements.grp_eab.readOnly=false
	forms.AsiVm_tab_seteo_vni.elements.grp_seteo_vni.readOnly=false
//	forms.AsiVm_tab_Programacion.elements.grp_cnaf_vm.readOnly=false
//	forms.AsiVm_tab_Programacion.elements.grp_cnaf_vm_caf.readOnly=false
//	forms.AsiVm_tab_Programacion.elements.grp_cnaf_caf.readOnly=false
	forms.AsiVm_tab_Varios.elements.grp_varios.readOnly=false
	forms.AsiVm_tab_seteo_vni.elements.grp_seteo_vni.readOnly=false
	forms.AsiVm_tab_cnaf.elements.grp_cnaf.readOnly=false
	forms.AsiVm_tab_seteo_vm.elements.grp_seteo_vm.readOnly=false
	
}
/**
 * @properties={typeid:24,uuid:"521F31C8-DCC5-455F-B6BA-2033F5DE5C29"}
 */
function setFieldRequired(){
	var frmMoni = solutionModel.getForm('AsiVm_Monitoreo')
	var fldFrecRespiratoria = frmMoni.getField('txt_frecuencia_respiratoria')
	var frmProgra = solutionModel.getForm('AsiVm_tab_seteo_vm')
	var frmTabMon = solutionModel.getForm('AsiVm_tab_Monitoreo_VM')
	var flCpot = frmMoni.getField('cbo_cpot')
	switch (globals.Asivm_prestacion) {
	case 1:
		
		fldFrecRespiratoria.putDesignTimeProperty('requerido', false)
		var fld = frmProgra.getField('txt_flujo')
		var fld2 = frmProgra.getField('txt_fio2')
		
		flCpot.putDesignTimeProperty('requerido',false)
		var mecanica = frmMoni.getField('multi_mecanica')
		var modoVentilatorio = frmProgra.getField('cbo_modo_ventilario')
		modoVentilatorio.putDesignTimeProperty('requerido',true)
		mecanica.putDesignTimeProperty('requerido',false)
		fld.removeDesignTimeProperty('requerido')
		fld2.removeDesignTimeProperty('requerido')
		fld.putDesignTimeProperty('requerido', false)
		fld2.putDesignTimeProperty('requerido', false)
		
		forms.AsiVm_tab_seteo_vm.controller.recreateUI()
		forms.AsiVm_tab_Monitoreo_VM.controller.recreateUI()
		forms.AsiVm_Monitoreo.controller.recreateUI()
		
		
		
		break;
		
	case 2:
	fldFrecRespiratoria.putDesignTimeProperty('requerido', true)
	var sedacion = frmMoni.getField('multi_sedacion')
	var bloqNeurom = frmMoni.getField('cbo_bloq_neurom')
	var analgesicos = frmMoni.getField('multi_analgesicos')
	var camIcu = frmMoni.getField('cbo_icu')
	var mecanica = frmMoni.getField('multi_mecanica')
	
		
		flCpot.putDesignTimeProperty('requerido',false)
		
	analgesicos.putDesignTimeProperty('requerido',false)
	bloqNeurom.putDesignTimeProperty('requerido',false)
	mecanica.putDesignTimeProperty('requerido',true)
	camIcu.putDesignTimeProperty('requerido',false)
	sedacion.putDesignTimeProperty('requerido',false)
	forms.AsiVm_Monitoreo.controller.recreateUI()
		break;
	
	case 3:
	fldFrecRespiratoria.putDesignTimeProperty('requerido', true)
//	forms..elements.txt_fio2.putDesignTimeProperty('requerido',true)
	var fld4 = frmProgra.getField('txt_flujo')
	fld4.removeDesignTimeProperty('requerido')
	var fld5 = frmProgra.getField('txt_fio2')
	fld5.removeDesignTimeProperty('requerido')
	fld4.removeDesignTimeProperty('requerido')
	
		
	flCpot.putDesignTimeProperty('requerido',false)
	forms.AsiVm_tab_seteo_vm.controller.recreateUI()
	forms.AsiVm_Monitoreo.controller.recreateUI()
	break;
	
}
forms.AsiVm_Monitoreo.controller.recreateUI()
	
	
}
/**
 * @properties={typeid:24,uuid:"0DB6599E-A888-4CC1-BFD8-1D178C475BFE"}
 */
function configurarCamposSegunPrestacion(){
	
//	elements.txt_temperatura.putClientProperty("requerido",false)
//	
//	forms.AsiVm_tab_EAB.elements.txt_ph.putClientProperty("requerido",false)
//	forms.AsiVm_tab_EAB.elements.txt_po2.putClientProperty("requerido",false)
//	forms.AsiVm_tab_EAB.elements.txt_pco2.putClientProperty("requerido",false)
//	forms.AsiVm_tab_EAB.elements.txt_hco3.putClientProperty("requerido",false)
//	forms.AsiVm_tab_EAB.elements.txt_eab_pao2_fio2.putClientProperty("requerido",false)
//	
//	forms.AsiVm_tab_Programacion.elements.txt_presion_inspiratoria.putClientProperty("requerido",false)
//	forms.AsiVm_tab_Programacion.elements.txt_presion_soporte.putClientProperty("requerido",false)
//	forms.AsiVm_tab_Programacion.elements.txt_flujo.putClientProperty("requerido",false)
//	forms.AsiVm_tab_Programacion.elements.txt_tiempo_inspiratorio.putClientProperty("requerido",false)
//	forms.AsiVm_tab_Programacion.elements.txt_peep.putClientProperty("requerido",false)
	
	forms.AsiVm_Monitoreo.elements.txt_frecuencia_cardiaca.readOnly=false
	forms.AsiVm_Monitoreo.elements.txt_tension_minima.readOnly=false
	forms.AsiVm_Monitoreo.elements.txt_tension_máxima.readOnly=false
	forms.AsiVm_Monitoreo.elements.txt_tension_arterial_media.readOnly=false
	forms.AsiVm_Monitoreo.elements.txt_temperatura.readOnly=false
	forms.AsiVm_Monitoreo.elements.cbo_rass.readOnly=false
	
//	forms.AsiVm_Monitoreo.elements.txt_frecuencia_cardiaca.enabled=true
//	forms.AsiVm_Monitoreo.elements.txt_tension_minima.enabled=true
//	forms.AsiVm_Monitoreo.elements.txt_tension_máxima.enabled=true
//	forms.AsiVm_Monitoreo.elements.txt_tension_arterial_media.enabled=true
//	forms.AsiVm_Monitoreo.elements.txt_temperatura.enabled=true
//	forms.AsiVm_Monitoreo.elements.cbo_rass.enabled=true
//	
	var frmMoni = solutionModel.getForm('AsiVm_Monitoreo')
	var fldFrecRespiratoria = frmMoni.getField('txt_frecuencia_respiratoria')
	var frmProgra = solutionModel.getForm('AsiVm_tab_Programacion')
	var frmTabMon = solutionModel.getForm('AsiVm_tab_Monitoreo_VM')
	//PRESTACION
	switch (globals.Asivm_prestacion) {
		case 1:
			
//			elements.multi_analgesicos.putClientProperty("requerido",false)
//			elements.cbo_rass.putClientProperty("requerido",false)
			
			/*forms.AsiVm_tab_Programacion.elements.txt_fio2.putClientProperty("requerido",false)
			forms.AsiVm_tab_Monitoreo_VM.elements.txt_presion_plateau.putClientProperty("requerido",false)
			forms.AsiVm_tab_Monitoreo_VM.elements.txt_delta_presion.putClientProperty("requerido",false)
			forms.AsiVm_tab_Monitoreo_VM.elements.txt_peep_total.putClientProperty("requerido",false)
			forms.AsiVm_tab_Monitoreo_VM.elements.txt_compliance.putClientProperty("requerido",false)
			forms.AsiVm_tab_Monitoreo_VM.elements.txt_resistencia.putClientProperty("requerido",false)
			forms.AsiVm_tab_Monitoreo_VM.elements.txt_pmi.putClientProperty("requerido",false)
			forms.AsiVm_tab_Monitoreo_VM.elements.txt_presion_oclusion.putClientProperty("requerido",false)
			forms.AsiVm_tab_Varios.elements.cbo_exito.putClientProperty("requerido",false)
			forms.AsiVm_tab_Varios.elements.cbo_traqueal.putClientProperty("requerido",false)
			forms.AsiVm_tab_Varios.elements.txt_balance_diario.putClientProperty("requerido",false)
			forms.AsiVm_tab_Varios.elements.txt_sofa.putClientProperty("requerido",false)*/
			
			fldFrecRespiratoria.putDesignTimeProperty('requerido', false)
			var fld = frmProgra.getField('txt_flujo')
			var fld2 = frmProgra.getField('txt_fio2')
			fld.removeDesignTimeProperty('requerido')
			fld2.removeDesignTimeProperty('requerido')
			fld.putDesignTimeProperty('requerido', false)
			fld2.putDesignTimeProperty('requerido', false)
			forms.AsiVm_Monitoreo.controller.recreateUI()
			
//			forms.AsiVm_Monitoreo.elements.cbo_modo_ventilario.enabled=true
//			forms.AsiVm_Monitoreo.elements.txt_cpot.readOnly=false
			forms.AsiVm_Monitoreo.elements.multi_analgesicos.readOnly=false
			forms.AsiVm_Monitoreo.elements.multi_sedacion.readOnly=false
			forms.AsiVm_Monitoreo.elements.cbo_icu.readOnly=false
			forms.AsiVm_Monitoreo.elements.cbo_bloq_neurom.readOnly=false
			forms.AsiVm_Monitoreo.elements.cbo_rass.readOnly=false
			
			forms.AsiVm_tab_EAB.elements.grp_eab.readOnly=false
			forms.AsiVm_tab_Monitoreo_VM.elements.grp_tab_monitoreo.readOnly=false
			forms.AsiVm_tab_Monitoreo_VM.elements.grp_tab_monitoreo.enabled=true
			forms.AsiVm_tab_Varios.elements.grp_varios.readOnly=false
			forms.AsiVm_tab_Varios.elements.grp_varios.enabled=true
			
			forms.AsiVm_tab_Varios.elements.grp_varios.readOnly=false
		
			elements.txt_frecuencia_respiratoria.enabled=false
			elements.txt_saturacion.enabled=false
			elements.txt_saturacion.readOnly=false
			forms.AsiVm_tab_seteo_vni.elements.grp_seteo.readOnly=true
			forms.AsiVm_tab_seteo_vni.elements.grp_seteo.enabled=false
			elements.txt_frecuencia_respiratoria.readOnly=true
			//habilitar
//			elements.txt_cpot.readOnly=false
			elements.multi_analgesicos.readOnly=false
			elements.multi_sedacion.readOnly=false
			elements.cbo_icu.readOnly=false
			elements.cbo_bloq_neurom.readOnly=false
			
//			elements.txt_cpot.enabled=true
			elements.multi_analgesicos.enabled=true
			elements.multi_sedacion.enabled=true
			elements.cbo_icu.enabled=true
			elements.cbo_bloq_neurom.enabled=true
			
			
//			elements.cbo_modo_ventilario.readOnly=false
			elements.cbo_disnea.readOnly=true
			elements.multi_mecanica.readOnly=true
			elements.cbo_disnea.enabled=false
			elements.multi_mecanica.enabled=false
			

			
			break;
			
		case 2:
		fldFrecRespiratoria.putDesignTimeProperty('requerido', true)
		forms.AsiVm_Monitoreo.controller.recreateUI()
		forms.AsiVm_tab_seteo_vni.elements.grp_seteo.readOnly=false
		forms.AsiVm_tab_seteo_vni.elements.grp_seteo.enabled=true
		
		forms.AsiVm_tab_EAB.elements.grp_eab.readOnly=false
		forms.AsiVm_Monitoreo.elements.cbo_modo_ventilario.enabled=false
		forms.AsiVm_tab_Monitoreo_VM.elements.grp_tab_monitoreo.readOnly=true
		forms.AsiVm_tab_Varios.elements.grp_varios.readOnly=true
	
		//deshabilitar
		forms.AsiVm_tab_Monitoreo_VM.elements.grp_tab_monitoreo.enabled=false
		forms.AsiVm_tab_Varios.elements.grp_varios.enabled=false

		
		
		elements.txt_frecuencia_respiratoria.readOnly=false
		elements.txt_frecuencia_respiratoria.enabled=true
		elements.txt_saturacion.enabled=true
		elements.txt_saturacion.readOnly=false
//		elements.txt_cpot.readOnly=true
		elements.multi_mecanica.readOnly=false
		elements.cbo_disnea.readOnly=false
		elements.multi_mecanica.enabled=true
		elements.cbo_disnea.enabled=true
		
//		elements.txt_cpot.enabled=false
		elements.multi_analgesicos.enabled=false
		elements.multi_sedacion.enabled=false
		elements.cbo_icu.enabled=false
		elements.cbo_bloq_neurom.enabled=false
		
		
		
//		forms.AsiVm_tab_seteo_vni.elements.txt_seteo_presion_insp.putClientProperty("requerido",false)
//		forms.AsiVm_tab_seteo_vni.elements.txt_seteo_tiempo_inspi.putClientProperty("requerido",false)
//		forms.AsiVm_tab_seteo_vni.elements.txt_seteo_frec_resp.putClientProperty("requerido",false)
			break;
		
		case 3:
		fldFrecRespiratoria.putDesignTimeProperty('requerido', true)
//		forms..elements.txt_fio2.putDesignTimeProperty('requerido',true)
		var fld4 = frmProgra.getField('txt_flujo')
		fld4.removeDesignTimeProperty('requerido')
		var fld5 = frmProgra.getField('txt_fio2')
		fld5.removeDesignTimeProperty('requerido')
		fld4.removeDesignTimeProperty('requerido')

		forms.AsiVm_Monitoreo.controller.recreateUI()
		
		forms.AsiVm_Monitoreo.elements.cbo_modo_ventilario.enabled=false

		
		forms.AsiVm_tab_EAB.elements.grp_eab.readOnly=false
		elements.txt_frecuencia_respiratoria.readOnly=false
		
		forms.AsiVm_tab_EAB.elements.grp_eab.enabled=true
		elements.txt_frecuencia_respiratoria.enabled=true
		elements.txt_saturacion.enabled=true
		
//		forms.AsiVm_Monitoreo.elements.tab_informe_1.tabIndex(1)
		//solo lectura
		forms.AsiVm_tab_Programacion.elements.grp_cnaf_vm.readOnly=true
		forms.AsiVm_tab_Monitoreo_VM.elements.grp_tab_monitoreo.readOnly=true
		forms.AsiVm_tab_Varios.elements.grp_varios.readOnly=true
		forms.AsiVm_tab_seteo_vni.elements.grp_seteo.readOnly=true
		//disabled
		forms.AsiVm_tab_Programacion.elements.grp_cnaf_vm.enabled=false
		forms.AsiVm_tab_Monitoreo_VM.elements.grp_tab_monitoreo.enabled=false
		forms.AsiVm_tab_Varios.elements.grp_varios.enabled=false
		forms.AsiVm_tab_seteo_vni.elements.grp_seteo.enabled=false
		
		elements.txt_cpot.enabled=false
		elements.multi_analgesicos.enabled=false
		elements.multi_sedacion.enabled=false
		elements.cbo_icu.enabled=false
		elements.cbo_bloq_neurom.enabled=false
		elements.multi_mecanica.readOnly=false
		elements.cbo_disnea.readOnly=false
		elements.multi_mecanica.enabled=true
		elements.cbo_disnea.enabled=true
		
		/*forms.AsiVm_tab_Programacion.elements.txt_frecuencia_resp.readOnly=true
		forms.AsiVm_tab_Programacion.elements.txt_volumen_corriente.readOnly=true
		forms.AsiVm_tab_Programacion.elements.txt_presion_soporte.readOnly=true
		forms.AsiVm_tab_Programacion.elements.txt_tiempo_inspiratorio.readOnly=true
		forms.AsiVm_tab_Programacion.elements.txt_peep.readOnly=true*/
			break;
	
	}
	forms.AsiVm_Monitoreo.controller.recreateUI()
}

/**
 * @properties={typeid:24,uuid:"EF596267-2EFE-43A3-91EE-D2B032EA2011"}
 */
function isValidDatosPacienteInter() {

	isValid = true;
	$messageErrorInter = '';

	 if(!isValid){
		 globals.DIALOGS.showWarningDialog("Atención!", $messageErrorInter, "Aceptar")
	 }
	
	return isValid;
}

/**
 * TODO generated, please specify type and doc for the params
 * @param value
 *
 * @properties={typeid:24,uuid:"64D069FC-6584-4134-A111-7033E545A9B2"}
 */
function editablePaciente(value) {
	elements.txt_paciente.editable = value;
	elements.btn_buscarPaciente.enabled = value;
}

/**
 * @properties={typeid:24,uuid:"3722F503-F923-42A6-98DC-3F0385A7349F"}
 */
function limpiarForm() {

	databaseManager.revertEditedRecords();

	inicializarForm();

	elements.txt_paciente.requestFocus();
	//elements.txt_paciente.requestFocus();
	$isDirty = false;

}

/**
 * @properties={typeid:24,uuid:"CFF651A8-7B62-4ABE-AB91-9421FC80C162"}
 */
function inicializarForm() {

	f_histClinUnica = null;
	f_paciente = null;
	f_marca_arm = -1
	f_cerrarForm=false
	
	//estado general
	f_frecuencia_respiratoria = 0
	f_estado_general_frecuencia_respiratoria = 0
	f_frecuencia_cardiaca = 0
	f_tension_arterial_max=0
	f_tension_arterial_min=0
	f_tension_arterial_media=0
	f_rass= 0
	f_fecha_monitoreo = ''
	
		f_temperatura=0
		f_cpot = ''
		f_analgésicos = ''
		f_sedación=''
			f_saturacion=0
		f_cam_icu= 0
		f_bloqueantes_neuromsuculares=0
		
		//vm
		f_modo_ventilatorio = 0
		
		//monitereo
		forms.AsiVm_tab_Monitoreo_VM.f_monitoreo_frec_respiratoria_total=0
		forms.AsiVm_tab_Monitoreo_VM.f_monitoreo_presion_pico=0
		forms.AsiVm_tab_Monitoreo_VM.f_monitoreo_presion_plateau=0
		forms.AsiVm_tab_Monitoreo_VM.f_monitoreo_presion_media=0
		forms.AsiVm_tab_Monitoreo_VM.f_monitoreo_peep_total=0
		forms.AsiVm_tab_Monitoreo_VM.f_monitoreo_delta_presion=0
		forms.AsiVm_tab_Monitoreo_VM.f_monitoreo_p01=0
		forms.AsiVm_tab_Monitoreo_VM.f_monitoreo_volumen_corriente_exhalado=0
		forms.AsiVm_tab_Monitoreo_VM.f_monitoreo_compliance=0
		forms.AsiVm_tab_Monitoreo_VM.f_monitoreo_resistencia=0
		forms.AsiVm_tab_Monitoreo_VM.f_monitoreo_pmi=0
		forms.AsiVm_tab_Monitoreo_VM.f_monitoreo_presion_oclusion=0
		
		//varios
		forms.AsiVm_tab_Varios.f_varios_sat=0
		forms.AsiVm_tab_Varios.f_varios_exito=0
		forms.AsiVm_tab_Varios.f_varios_pre=0
		forms.AsiVm_tab_Varios.f_varios_eot=0
		forms.AsiVm_tab_Varios.f_varios_dialisis=0
		forms.AsiVm_tab_Varios.f_varios_aspirado_traqueal=0
		forms.AsiVm_tab_Varios.f_varios_balance_diario=0
		forms.AsiVm_tab_Varios.f_varios_sofa_diario=0
		
		f_mecanica = ''
		f_disnea =null
	
	//eab
	forms.AsiVm_tab_EAB.f_eab_ph = 0.0
	forms.AsiVm_tab_EAB.f_eab_po2 =  0.0
	forms.AsiVm_tab_EAB.f_eab_pco2 =  0.0
	forms.AsiVm_tab_EAB.f_eab_hco3= 0.0
	forms.AsiVm_tab_EAB.f_pao2_fio2 =  0.0
	//programacion //CNAF
	forms.AsiVm_tab_cnaf.f_cnaf_frecuencia_respiratoria =0
//	forms.AsiVm_tab_Programacion.f_volumen_corriente = 0
	
//	forms.AsiVm_tab_Programacion.f_presion_inspiratoria=0
//	forms.AsiVm_tab_Programacion.f_cnaf_presion_inspiratoria=0
//	forms.AsiVm_tab_Programacion.f_presion_soporte=0
//	forms.AsiVm_tab_Programacion.f_cnaf_presion_soporte=0
//	forms.AsiVm_tab_Programacion.f_tiempo_inspiratorio=0
//	forms.AsiVm_tab_Programacion.f_peep=0
//	forms.AsiVm_tab_Programacion.f_cnaf_peep= 0.0;
	
	forms.AsiVm_tab_cnaf.f_cnaf_flujo = 0
	forms.AsiVm_tab_cnaf.f_cnaf_FiO2 = 0
	forms.AsiVm_tab_cnaf.f_cnaf_equipo = ''
	forms.AsiVm_tab_cnaf.f_cnaf_tamanio_canula = ''
	forms.AsiVm_tab_cnaf.f_cnaf_spo2 = 0
	forms.AsiVm_tab_cnaf.f_cnaf_presencia_secrecion = 0
	//seteo
	forms.AsiVm_tab_seteo_vni.f_seteo_vni_ventilador=''
	forms.AsiVm_tab_seteo_vni.f_seteo_vni_interfase=''
	forms.AsiVm_tab_seteo_vni.f_seteo_vni_modo=''
	forms.AsiVm_tab_seteo_vni.f_seteo_vni_presion_inspiratoria=0
	forms.AsiVm_tab_seteo_vni.f_seteo_vni_peep=0
	forms.AsiVm_tab_seteo_vni.f_seteo_vni_frecuencia_respiratoria=0
	forms.AsiVm_tab_seteo_vni.f_seteo_vni_tiempo_inspiratorio=0
	forms.AsiVm_tab_seteo_vni.f_seteo_vni_fio2=0
	forms.AsiVm_tab_seteo_vni.f_seteo_vni_volumen_corriente=0
	
	//seteo vm
	forms.AsiVm_tab_seteo_vm.f_vm_seteo_modo_ventilatorio=''
	forms.AsiVm_tab_seteo_vm.f_vm_seteo_volumen_corriente=0
	forms.AsiVm_tab_seteo_vm.f_vm_seteo_presion_inspiratoria=0
	forms.AsiVm_tab_seteo_vm.f_vm_seteo_frecuencia_respiratoria=0
	forms.AsiVm_tab_seteo_vm.f_vm_seteo_tiempo_inspiratorio=0
	forms.AsiVm_tab_seteo_vm.f_vm_seteo_pausa=0
	forms.AsiVm_tab_seteo_vm.f_vm_seteo_flujo=0
	forms.AsiVm_tab_seteo_vm.f_vm_seteo_FiO2=0
	forms.AsiVm_tab_seteo_vm.f_vm_seteo_peep=0
	
	//CNAF
	forms.AsiVm_tab_cnaf.f_cnaf_frecuencia_respiratoria= 0
	forms.AsiVm_tab_cnaf.f_cnaf_FiO2 = 0
	forms.AsiVm_tab_cnaf.f_cnaf_flujo= 0
	forms.AsiVm_tab_cnaf.f_cnaf_equipo= ''
	forms.AsiVm_tab_cnaf.f_cnaf_tamanio_canula= ''
	forms.AsiVm_tab_cnaf.f_cnaf_empleo_musculo_acc = 0
	forms.AsiVm_tab_cnaf.f_cnaf_indice_rox = 0
	
	//observaciones
	forms.AsiVm_tab_Observaciones.f_observaciones=''
	
	
	
//	elements.lbl_procesando.visible = false;
	application.updateUI();
//	visibleBody(false);
//	editablePaciente(true);
}

/**
 * Perform the element default action.
 *
 * @param {JSEvent} event the event that triggered the action
 *
 * @properties={typeid:24,uuid:"3546265C-3F24-4D5D-AD3B-073628329779"}
 * @AllowToRunInFind
 */
function onAction_btnGuardar(event) {
	elements.txt_frecuencia_cardiaca.requestFocus()
	if(globals.errorDato){//ultimo onchange valido
		var res = globals.DIALOGS.showQuestionDialog('¡Atención!', '¿ Esta seguro que desea guardar el monitoreo ?', 'Si', 'No');
		
		if (res == 'Si') {
	
			if ($isDirty) {
	
				if (isValidDataForm()) {
	
					if (isValidData()) {
						
	//					var fecha = 0;
	//					var hora = 0;
	//					var nuevoHciint = false;
						var fechahora = application.getServerTimeStamp()
						
						if (asivm_ficha_monitoreo.fecha == 0) {
							
	//						nuevoHciint = true;
	//						fecha = utils.stringToNumber(globals.CapturaFechaSistema());
	//						hora = utils.stringToNumber(globals.CapturaHoraSistema("HHMM"));
							//FECHA SERVIDOR
//							fechahora = application.getServerTimeStamp()
							// Completando cabecera
							//asivm_ficha_monitoreo.histcli = asivm_rel_buscar_admision.adm_histclin;
							asivm_ficha_monitoreo.fecha = fechahora;
//							asivm_ficha_monitoreo.fichavm = globals.AsiVm_ficha_id
							asivm_ficha_monitoreo.fichavm = asivm_fichakine.ficha_id
							asivm_ficha_monitoreo.marcaarm=f_marca_arm
							//guardo tambien marca arm
//							asivm_ficha_monitoreo.arm = f_marca_arm
//							asivm_rel_admision_arm.admArm = f_marca_arm
//							scopes.globals.AsiVm_ficha_id
							//asivm_ficha_monitoreo.fichavm = globals.asivm_fichakine.ficha_id
	//						asivm_ficha_monitoreo.huchora = hora;
						}
						else{// si no es ficha nueva y quiere corregir algo
						//no modifico 
	//						fecha = utils.stringToNumber(globals.CapturaFechaSistema());
	//						hora = utils.stringToNumber(globals.CapturaHoraSistema("HHMM"));
//							asivm_ficha_monitoreo.fecha = fechahora						
						}
						// Actualizando base de datos
						try {
							var isSaveMarcaArm=false
							var isSaveArmUso=false
							var fechaIngresoArmUso = 0
							var horaIngresoArmUso = 0
//							asivm_ficha_monitoreo.fecha = application.getServerTimeStamp()
							
							guardarDatos();
							databaseManager.startTransaction();
							var resultSave = databaseManager.saveData(asivm_ficha_monitoreo.getRecord(1));
//							scopes.globals.AsiVm_adm_HistClin= asivm_rel_buscar_admision.adm_histclin
							if(resultSave==true && asivm_rel_admision_arm.getSize()==1){ //actualizo marcaArrm siempre en admision
								isSaveMarcaArm =globals.saveMarcaArmAdmision(f_marca_arm)
//								isSaveMarcaArm =true
								//finaliza arm
								var variable =1
								if(isSaveMarcaArm==true && resultSave==true && asivm_rel_asistencial_arm_uso_abierta.getSize()==variable && f_marca_arm==0){// luego mirar porque debe ser la ultima
									fechaIngresoArmUso =asivm_rel_asistencial_arm_uso_abierta.armusofecing
									horaIngresoArmUso =asivm_rel_asistencial_arm_uso_abierta.armusohoring
									isSaveArmUso = globals.saveArmUsoFin(asivm_rel_buscar_admision.adm_histclin,fechahora)
									if(isSaveArmUso==true){//informar a rend cab y det
										//Defini variables rend y rendcab
										globals.AsiVm_Mod_rcHClinica=asivm_rel_buscar_admision.adm_histclin
										globals.AsiVm_Mod_rcPeriodo=utils.dateFormat(fechahora,'yyyyMM')
										globals.AsiVm_Mod_rcCierre =1
										globals.AsiVm_Mod_rcAdmision=0 //internados
										globals.AsiVm_Mod_rcEmpresa=1
										globals.AsiVm_Mod_ploObra = asivm_rel_admision_arm.adm_obrsoc;
										globals.AsiVm_Mod_ploPlanx10 = asivm_rel_admision_arm.adm_planobr

										var isSaveRendDet = globals.saveRendDet(globals.AsiVm_Mod_rcHClinica,fechahora, fechaIngresoArmUso, horaIngresoArmUso)
										if(isSaveRendDet==true){
											globals.saveRendCab(asivm_rel_buscar_admision.adm_histclin,fechahora);
										}
										
									}
									//si falla que hago? rollback!!
								}
								//comienza un arm
								if(isSaveMarcaArm==true && resultSave==true && asivm_rel_asistencial_arm_uso_abierta.getSize()==0 && f_marca_arm==1){// luego mirar porque debe ser la ultima
									isSaveArmUso = globals.saveArmUsoInicio(asivm_rel_buscar_admision.adm_histclin,fechahora)
//									if(isSaveArmUso==true){//informar a rend cab y det
//										globals.saveRendDet(asivm_rel_buscar_admision.adm_histclin,fechahora)
//										globals.saveRendCab(asivm_rel_buscar_admision.adm_histclin,fechahora);
										
//									}
									//si falla que hago? rollback!!
								}
								
								//si sigue en arm , no modifico.
							
							}

						} catch (e) {
//							plugins.dialogs.showInfoDialog("Error al procesar los datos cargados. Avise a Sistemas, por favor!",e.toString(),"ok")
							// TODO: handle exception
							//plugins.Log.error("ERROR PERSISTENCIA - ", e.message);
						}
						// Guardando alertas
					/*	if (asiucotrs_hoja_rel_alerta.aler_histclin == 0) {
							asiucotrs_hoja_rel_alerta.aler_histclin = asivm_rel_buscar_admision.adm_histclin;
							asiucotrs_hoja_rel_alerta.aler_tipadmi = 0;
							asiucotrs_hoja_rel_alerta.aler_tipoper = globals.Srv_Login_Sanatorio_vTipoOperador;
							asiucotrs_hoja_rel_alerta.aler_codoper = globals.Srv_Login_Sanatorio_vLega;
							
						}
						else{
							asiucotrs_hoja_rel_alerta.aler_alergico = ( asiucotrs_hoja_rel_alerta.aler_tipaler_1 == 1 ? forms.AsiVm_Monitoreo_txt_alerta.f_alergia : ' ');
						}
						
						resultSave = databaseManager.saveData(asiucotrs_hoja_rel_alerta.getRecord(1));*/
						if (resultSave == true && isSaveMarcaArm==true) {
							databaseManager.commitTransaction();
							globals.DIALOGS.showInfoDialog("Resultado", "El monitoreo fue guardado exitosamente.", "Aceptar");
	//						editablePaciente(false);	
	//						imprimir(asivm_ficha_monitoreo.huchiscli, asivm_ficha_monitoreo.hucfecha, asivm_ficha_monitoreo.huchora);
							//globals.AsistFunciones_unLockRegisterTable(application.getSolutionName(),controller.getName(),asivm_rel_buscar_admision.adm_histclin.toString(),globals.Srv_Login_Sanatorio_vLega.toString(),"Historia Clinica");
							//cerrarForm();
							//limpiarForm();
							$isDirty = false;
						} else {
							var error1 = ''
							var error2 = ''
							var array = databaseManager.getFailedRecords()
							for (var i = 0; i < array.length; i++) {
								var record = array[i];
								var jstable = databaseManager.getTable(record);
								var tableSQLName = jstable.getSQLName();
								error1 = 'Error de Grabación en Tabla:' + tableSQLName + ' en server:' + jstable.getServerName() + ' falló la grabación. Avise urgente a Sistemas, por favor!'
								error2 = 'Error en grabación ' + record.exception;
								if (record.exception.getErrorCode() == ServoyException.RECORD_VALIDATION_FAILED) {
									// exception thrown in pre-insert/update/delete event method
									var thrown = record.exception.getMessage()
									//plugins.dialogs.showErrorDialog("Error de grabación","Record validation failed: " + thrown)
								}
							}
							databaseManager.rollbackTransaction()
							if (error1 != '') {
								globals.DIALOGS.showErrorDialog("Error de grabación", "Record validation failed: " + thrown)
								globals.DIALOGS.showErrorDialog("Error en grabacion de Histórico", error1, "Aceptar")
								globals.DIALOGS.showErrorDialog("Error en grabacion de Histórico", error2, "Aceptar")
							}
//							globals.DIALOGS.showErrorDialog("Error en grabación", "Se ha producido un error de grabación. " + '\n' + "Avise a Sistemas, por favor.", "Aceptar")
						elements.btn_grabar.enabled=true
						}
					}
				}
			} else {
				globals.DIALOGS.showWarningDialog("Atención!", "No hay datos para guardar.", "Aceptar")
				elements.txt_paciente.requestFocus();
			}
		} else
			elements.txt_paciente.requestFocus();
	}
}


/**
 * @properties={typeid:24,uuid:"42ABC96A-2709-408E-84D0-5ED7A4717D1A"}
 */
function isValidDataForm() {
	globals.isValid = true;
	globals.messageError = "No ha sido posible guardar el monitoreo. Corrija los siguientes errores y vuelva a intentar."		//var borderError = 'LineBorder,1,#ff0000';
	
	if(forms.AsiVm_tab_Observaciones.f_observaciones.length>800){
		globals.isValid=false
		globals.messageError += "\nEl campo observaciones no puede tener mas de 800 caracteres."
	}
	
	//  INICIO VALIDADOR MASIVO GENERICO 
	if(globals.Asivm_prestacion==1){
		globals.validateRequired("AsiVm_Monitoreo",true,'multi_',false,0)
		globals.validateRequired("AsiVm_Monitoreo",true,'cbo_',false,0)
		globals.validateRequired("AsiVm_Monitoreo",true,'txt_',false,0)
		
		globals.validateRequired("AsiVm_tab_Monitoreo_VM",true,'txt_',false,0)
//		globals.validateRequired("AsiVm_tab_Monitoreo_VM",true,'cbo_',false,0)
		globals.validateRequired("AsiVm_tab_Varios",true,'txt_',false,0)
		globals.validateRequired("AsiVm_tab_Varios",true,'cbo_',false,0)
		globals.validateRequired("AsiVm_tab_EAB",true,'txt_',false,0)
		globals.validateRequired("AsiVm_tab_seteo_vm",true,'txt_',false,0)
		globals.validateRequired("AsiVm_tab_seteo_vm",true,'cbo_',false,0)
		
	}else if(globals.Asivm_prestacion==2){
		globals.validateRequired("AsiVm_Monitoreo",true,'multi_',false,0) 
		globals.validateRequired("AsiVm_Monitoreo",true,'txt_',false,0)
		globals.validateRequired("AsiVm_Monitoreo",true,'cbo_',false,0)
		
		globals.validateRequired("AsiVm_tab_EAB",true,'txt_',false,0)
		
		globals.validateRequired("AsiVm_tab_seteo_vni",true,'txt_',false,0)
		globals.validateRequired("AsiVm_tab_seteo_vni",true,'cbo_',false,0)
		globals.validateRequired("AsiVm_tab_seteo_vni",true,'multi_',false,0)
		
		//globals.validateRequired("AsiVm_Monitoreo",true,'cbo_',false,0);
	}else if(globals.Asivm_prestacion==3){
		globals.validateRequired("AsiVm_Monitoreo",true,'txt_',false,0);
		globals.validateRequired("AsiVm_Monitoreo",true,'cbo_',false,0);
		globals.validateRequired("AsiVm_Monitoreo",true,'multi_',false,0);
		
		globals.validateRequired("AsiVm_tab_EAB",true,'txt_',false,0)
		
		globals.validateRequired("AsiVm_tab_cnaf",true,'txt_',false,0)
		globals.validateRequired("AsiVm_tab_cnaf",true,'cbo_',false,0)
	}
	
	if(f_tension_arterial_min>f_tension_arterial_max){
		globals.messageError += "\n La Tensión Arterial Mínima debe ser menor o igual a la Máxima.";
		globals.isValid = false;
	}
	
	
		 if(f_marca_arm==-1 || f_marca_arm==null){
				globals.messageError += "\n El valor de Marca ARM debe ser cargada.";
				globals.isValid = false;
		}
		 if(f_marca_arm!=-1){
			var resArm = globals.DIALOGS.showQuestionDialog('¡Atención!', '¿ Esta seguro de cargar el ARM en: '+application.getValueListDisplayValue('AsiVm_vl_SINO_ARM',f_marca_arm)+'?. Recuerde!. Este campo no podra ser modificado luego de guardar', 'Si', 'No');
			if(resArm=='No'){
				globals.messageError += "\n Por favor Asegurese el ARM que corresponde.";
				globals.isValid = false;
			}
		 }	
	
//	var elementosTab1 = forms.AsiVm_Monitoreo.elements.tab_informe_1.getMaxTabIndex()
//	for (var index = 1; index <= elementosTab1; index++) {
//		var nombreFormulario = forms.AsiVm_Monitoreo.elements.tab_informe_1.getTabFormNameAt(index);
//		globals.validateRequired(nombreFormulario,true,'tea_',true,17);
//		
//	}
//	var elementosTab2 = forms.AsiVm_Monitoreo.elements.tab_informe_2.getMaxTabIndex()
//	for (var index2 = 1; index2 <= elementosTab2; index2++) {
//		var nombreFormulario2 = forms.AsiVm_Monitoreo.elements.tab_informe_2.getTabFormNameAt(index2);
//		
//		globals.validateRequired(nombreFormulario2,true,'tea_',true,17);
//	}
//	
	// FIN  VALIDADOR MASIVO GENERICO 

	// fin val arm 
	if (!globals.isValid) {
		globals.DIALOGS.showWarningDialog("¡Atención!",globals.messageError, "Aceptar")
	}
	
	return globals.isValid;
}

/**
 * @properties={typeid:24,uuid:"EC082D6A-1D6B-478F-A11E-87892672C275"}
 */
function isValidData() {

	 isValid = true;
//	var messageError = "No ha sido posible guardar la solicitud. Corrija los siguientes errores y vuelva a intentar."
//	if(forms.AsiVm_tab_Observaciones.f_observaciones.length>200){
//		isValid=false
//		 messageError += "\nEl campo observaciones no puede tener mas de 200 caracteres."
//	}
	
	//var borderError = 'LineBorder,1,#ff0000';
		//setDefaultBorderElements();
		/*
	 if(isValid){

	 if(f_protocolo == null){

	 var res = globals.DIALOGS.showQuestionDialog('¡Atención!','¿ Desea Guardar Ingreso de Historia Clinica de Cirugia sin Protocolo ?', 'Si', 'No');
	 if( res == 'Si'){
	 }
	 else{

	 messageError += "\nHistoria Clinica de Cirugia sin Protocolo."
	 isValid = false;
	 }
	 }
	 }
	 else{
	 globals.DIALOGS.showWarningDialog("Atención!",messageError,"Aceptar")
	 elements.txt_paciente.requestFocus();
	 }
	 */
//	if(isValid==false){
//		globals.DIALOGS.showWarningDialog("Atención!",messageError,"Aceptar")
//	}
	
	return isValid;

}

/**
 * Perform the element default action.
 *
 * @param {JSEvent} event the event that triggered the action
 *
 * @properties={typeid:24,uuid:"C55DE10E-6235-45A2-AC84-ACE2CD73B59F"}
 */
function onAction_btnCerrar(event) {
	forms.AsiVm_Monitoreo.controller.recreateUI()
	if ($isDirty) {
		if (globals.DIALOGS.showQuestionDialog('¡Atención!', 'Existen datos que no han sido guardados. ¿Está seguro que desea continuar?', 'Si', 'No') == 'Si')
			f_cerrarForm = true;
	} else {
		f_cerrarForm = true;
	}

	if (f_cerrarForm) {
		
		cerrarForm();
	}
	limpiarForm()
}

/**
 * @properties={typeid:24,uuid:"4F8C7B9F-5A9A-4203-B0B2-4EE276A68404"}
 */
function cerrarForm(){
	
	f_cerrarForm = true;
	var buscarRelacion = asivm_rel_buscar_admision
	if(asivm_rel_buscar_admision_con_alta.getSize()==1){
		buscarRelacion=asivm_rel_buscar_admision_con_alta
	}
	if(buscarRelacion.getSize() > 0){
		if(globals.AsiVm_Monitoreo_bloqueado){
			globals.AsistFunciones_unLockRegisterTable(application.getSolutionName(),controller.getName(),buscarRelacion.adm_histclin.toString(),globals.Srv_Login_Sanatorio_vLega.toString(),"Monitoreo de Ficha");
		}
	}
	var $win = application.getWindow(application.getActiveWindow().getName());
	if ($win != null) {
		$win.hide();
		$win.destroy();
	}
}

/**
 * Handle hide window.
 *
 * @param {JSEvent} event the event that triggered the action
 *
 * @returns {Boolean}
 *
 * @properties={typeid:24,uuid:"079742D2-9DF2-4C02-AB43-C5B39E0A5DEE"}
 */
function onHide_cerrarForm(event) {
	forms.AsiVm_Monitoreo.controller.recreateUI()
	if(!f_cerrarForm)
		globals.DIALOGS.showInfoDialog("Atención","Para cerrar el programa debe presionar el boton Salir.","Aceptar")
	return f_cerrarForm;
}

/**
 * Perform the element default action.
 *
 * @param {JSEvent} event the event that triggered the action
 *
 * @properties={typeid:24,uuid:"83FE2661-0DF2-4B96-97F6-6356E9BDEDFD"}
 */
function onAction_buscarPatologia_1(event) {

	globals.AsiVm_Monitoreo_patDataProvider = 'hucpat1';
	openBuscarPatologia();

}

/**
 * @properties={typeid:24,uuid:"9646A49B-09F1-4DF4-9AC4-5BD421A59777"}
 */
function openBuscarPatologia() {

	if(!$_AsiVm_Monitoreo_READ_ONLY){
		var win2 = application.createWindow("seleccion_patologia", JSWindow.MODAL_DIALOG);
		win2.title = 'Búsqueda de Diagnóstico';
		win2.resizable = false;
		win2.show(forms.AsiVm_Monitoreo_dlg_buscar_patologia);
	}


}

/**
 * Perform the element default action.
 *
 * @param {JSEvent} event the event that triggered the action
 *
 * @properties={typeid:24,uuid:"0C178189-2E30-4E64-B248-3C4DE5BDEF77"}
 */
function onAction_buscarPatologia_2(event) {

	if(forms.AsiVm_Monitoreo.elements.txt1_diagnostico2.editable==true){
		globals.AsiVm_Monitoreo_patDataProvider = 'hucpat2';
		openBuscarPatologia();
	}
	
}

/**
 * Perform the element default action.
 *
 * @param {JSEvent} event the event that triggered the action
 *
 * @properties={typeid:24,uuid:"32A84C86-0F38-4F20-8A55-0258DE42FC9C"}
 */
function onAction_buscarPatologia_3(event) {

	if(forms.AsiVm_Monitoreo.elements.txt1_diagnostico3.editable==true){
		globals.AsiVm_Monitoreo_patDataProvider = 'hucpat3';
		openBuscarPatologia();
	}

}

/**
 * @properties={typeid:24,uuid:"D56D6F0D-75EC-4B7B-838A-B7DEB6E63401"}
 */
function tieneAlertas() {

	var value = false;

	var dataprovidersNames = asiucotrs_hoja_rel_alerta.alldataproviders;
	for (var i = 0; i < dataprovidersNames.length; i++) {
		if (asiucotrs_hoja_rel_alerta[dataprovidersNames[i]] == 1) {
			value = true;
			break;
		}
	}

	return value;
}

/**
 * TODO generated, please specify type and doc for the params
 * @param {Date} Fecha_Desde
 * @param {Date} Fecha_Hasta
 *
 * @properties={typeid:24,uuid:"0EB0C562-0528-40B2-8252-F9208A27ACEC"}
 */
function contar_dias(Fecha_Desde, Fecha_Hasta) {
	// El hasta dede ser mayor al desde
	var $contar = 0;

	var $x = Fecha_Hasta - Fecha_Desde//diferencias entre dos dias y lo muestra en milisegundos
	var $un_dia = 1000 * 60 * 60 * 24 //ms * sec * min * hrs de un día
	var $dif_dias = $x / $un_dia //calcula la diferencia en días
		//$contar = Math.ceil($dif_dias )   //redondea
	//$contar = Math.round($dif_dias)
	$contar = Math.floor($dif_dias) //redondea

	return $contar
}

/**
 * TODO generated, please specify type and doc for the params
 * @param {Number} realValue
 *
 * @properties={typeid:24,uuid:"F3EF0A4D-3B2B-4C7A-9784-C473297DE4CD"}
 */
function convertNumberToHour_HHMM(realValue) {

	var hora = "";
	if (realValue != null) {
		var value = realValue;
		if (value < 1) {
			hora = "00:00";
		} else {
			if (value < 10) {
				hora = "00:0" + value.toString().substr(0, 1);
			} else {
				if (value < 100) {
					hora = "00:" + value.toString().substr(0, 2);
				} else {
					if (value < 1000) {
						hora = "0" + value.toString().substr(0, 1) + ":" + value.toString().substr(1, 2);
					} else {
						if (value <= 2359) {
							hora = value.toString().substr(0, 2) + ":" + value.toString().substr(2, 2);
						}
					}
				}
			}
		}
	}

	return hora;
}

/**
 * Callback method when the user changes tab in a tab panel or divider position in split pane.
 *
 * @param {Number} previousIndex index of tab shown before the change
 * @param {JSEvent} event the event that triggered the action
 *
 * @properties={typeid:24,uuid:"642BC87D-4A76-473C-A863-5A65C3FB6A8F"}
 */
function onTabChange_informe_1(previousIndex, event) {

	elements.tab_informe_1.setTabFGColorAt(previousIndex, '#000000');
	elements.tab_informe_1.setTabFGColorAt(elements.tab_informe_1.tabIndex, '#3336ff');
	var current = forms.AsiVm_Monitoreo.elements.tab_informe_1.tabIndex;
	
	var nameTab= forms.AsiVm_Monitoreo.elements.tab_informe_1.getTabFormNameAt(current);
	
	/*if(forms[nameTab].elements[0]!=undefined && nameTab!='AsiUtiTrs_Ti_Examen_Fisico'){
		forms[nameTab].elements[0].requestFocus();
	}*/
	
	/*elements.tab_informe_1.setTabFGColorAt(previousIndex, '#000000');
	elements.tab_informe_1.setTabFGColorAt(elements.tab_informe_1.tabIndex, '#3336ff');
	
	if(elements.tab_informe_1.tabIndex == 1)
		forms.AsiVm_Monitoreo_txt_alerta.elements.chk_alergia.requestFocus();
	
	if(elements.tab_informe_1.tabIndex == 2)
		forms.AsiVm_Monitoreo_txt_motivo_ingreso.elements.tea_texto.requestFocus();
	
	if(elements.tab_informe_1.tabIndex == 3)
		forms.AsiVm_Monitoreo_txt_motivo_consulta.elements.tea_texto.requestFocus();
	
	if(elements.tab_informe_1.tabIndex == 4)
		forms.AsiVm_Monitoreo_txt_enfermedad_actual.elements.tea_texto.requestFocus();
	
	if(elements.tab_informe_1.tabIndex == 5)
		forms.AsiVm_Monitoreo_txt_antec_personal.elements.tea_texto.requestFocus();
	
	if(elements.tab_informe_1.tabIndex == 6)
		forms.AsiVm_Monitoreo_txt_antec_familiar.elements.tea_texto.requestFocus();*/
}

/**
 * Callback method when the user changes tab in a tab panel or divider position in split pane.
 *
 * @param {Number} previousIndex index of tab shown before the change
 * @param {JSEvent} event the event that triggered the action
 *
 * @properties={typeid:24,uuid:"F7FD2F0C-38E0-4444-9B8E-17DE9DC3123B"}
 */
function onTabChange_informe_2(previousIndex, event) {

	elements.tab_informe_2.setTabFGColorAt(previousIndex, '#000000');
	elements.tab_informe_2.setTabFGColorAt(elements.tab_informe_2.tabIndex, '#3336ff');
	var current2 = forms.AsiVm_Monitoreo.elements.tab_informe_2.tabIndex;
	
	var nameTab2= forms.AsiVm_Monitoreo.elements.tab_informe_2.getTabFormNameAt(current2);
	
	/*if(forms[nameTab2].elements[0]!=undefined){
		forms[nameTab2].elements[0].requestFocus();
	}*/
	
	/*elements.tab_informe_2.setTabFGColorAt(previousIndex, '#000000');
	elements.tab_informe_2.setTabFGColorAt(elements.tab_informe_2.tabIndex, '#3336ff');
	
	if(elements.tab_informe_2.tabIndex == 1)
		forms.AsiVm_Monitoreo_txt_examen_clinico.elements.tea_texto.requestFocus();
	
	if(elements.tab_informe_2.tabIndex == 2)
		forms.AsiVm_Monitoreo_txt_examen_complementario.elements.tea_texto.requestFocus();
	
	if(elements.tab_informe_2.tabIndex == 3)
		forms.AsiVm_Monitoreo_txt_comentario_ingreso.elements.tea_texto.requestFocus();
	
	if(elements.tab_informe_2.tabIndex == 4)
		forms.AsiVm_Monitoreo_txt_plan_terapeutico.elements.tea_texto.requestFocus();
	
	if(elements.tab_informe_2.tabIndex == 5)
		forms.AsiVm_Monitoreo_txt_diagnostico_diferencial.elements.tea_texto.requestFocus();
	
	if(elements.tab_informe_2.tabIndex == 6)
		forms.AsiVm_Monitoreo_txt_mediacion_habitual.elements.tea_texto.requestFocus();*/
}

/**
 * 
 * @param {Number} histClin
 * @param {Number} fecha
 * @param {Number} hora
 *
 * @properties={typeid:24,uuid:"73471402-98C8-4ED7-B6AC-61DCEC8FABB5"}
 */
function imprimir(histClin, fecha, hora) {
	
	var texto = '';
	if(asivm_ficha_monitoreo.hucimpresa == 0)
		texto =  '¿Imprime Hoja de Evolucion Medica UCO?' 
	else
		texto = '¿Desea reimprimir Hoja de Evolucion Medica UCO?';
	
	var print = globals.DIALOGS.showQuestionDialog('¡Atención!', texto, 'Si', 'No');
	if (print == 'Si') {
		
		// 0 : imprime hoja 1 : genera PDF 
//		var absoluteFileName = globals.AsiUcoMod_Rep_imprimir(histClin,fecha,hora,0,false);
		var absoluteFileName = globals.AsiUcoMod_Rep_imprimirHoja(histClin,fecha,hora,0,false);
		
		
		/*if(asivm_ficha_monitoreo.hucimpresa == 0){
			
			asivm_ficha_monitoreo.hucimpresa = 1;
			databaseManager.saveData(asivm_ficha_monitoreo.getRecord(1));
		}*/
	}
	
	//forms.Hcipiso_print.controller.setPageFormat(210,297,10,10,10,10,1,0);
	//forms.Hcipiso_print.controller.print(false,false);
	/*
	 var win = application.createWindow("impri_paciente",JSWindow.MODAL_DIALOG);
	 win.title = "Impresion de Hitória Clínica";
	 win.resizable = false;
	 win.show(forms.Hcipiso_print)
	 */
}

/**
 * Handle changed data.
 *
 * @param {Number} oldValue old value
 * @param {Number} newValue new value
 * @param {JSEvent} event the event that triggered the action
 *
 * @returns {Boolean}
 *
 * @properties={typeid:24,uuid:"08683037-2E07-4847-91B7-C1395BFED5F2"}
 */
function onDataChange_txtFieldPatologia1(oldValue, newValue, event) {
	// TODO Auto-generated method stub
	validarPatologia(f_patologia1,'hucpat1');
	$isDirty = true;
	return true
}

/**
 * TODO generated, please specify type and doc for the params
 * @param oldValue
 * @param newValue
 * @param event
 *
 * @properties={typeid:24,uuid:"ABD63086-8494-4E69-A5A5-CB8BF83A84C2"}
 */
function onDataChange_txtFieldPatologia2(oldValue, newValue, event) {
	// TODO Auto-generated method stub
	validarPatologia(f_patologia2,'hucpat2');
	$isDirty = true;
	return true
}

/**
 * TODO generated, please specify type and doc for the params
 * @param oldValue
 * @param newValue
 * @param event
 *
 * @properties={typeid:24,uuid:"266AEF65-FAA4-485F-B449-509EFE74B12C"}
 */
function onDataChange_txtFieldPatologia3(oldValue, newValue, event) {
	// TODO Auto-generated method stub
	validarPatologia(f_patologia3,'hucpat3');
	$isDirty = true;
	return true
}

/**
 * @AllowToRunInFind
 * 
 * TODO generated, please specify type and doc for the params
 * @param patologia
 * @param secPatologia
 *
 * @properties={typeid:24,uuid:"95227962-A13F-4AE0-AEC2-4C4C46EF4F06"}
 */
function validarPatologia(patologia, secPatologia){ //htidiagnos1, htidiagnos2, htidiagnos3
	var codigo=0;
	if(patologia==null || globals.IsBlank(patologia)){
		patologia="";
	}
	if(patologia!=0  && (!isNaN(patologia) && utils.stringToNumber(patologia)>2147483647)){
		plugins.dialogs.showInfoDialog("Valor Diagnostico","valor no valido","ok")
		return;
	}
	
	// si es codigo
	if(!globals.IsBlank(patologia) && !isNaN(patologia)){
		codigo= utils.stringToNumber(patologia);
		switch (secPatologia) {
		case 'hucpat1':
			asivm_ficha_monitoreo.asiucotrs_hoja_rel_buscar_patologia_1.pat_codi=codigo;
			asivm_ficha_monitoreo[secPatologia]=codigo;
			f_descripcion_patologia1=asivm_ficha_monitoreo.asiucotrs_hoja_rel_buscar_patologia_1.pat_descrip
			forms.AsiVm_Monitoreo.elements.txt1_diagnostico2.editable=true;
			if(asivm_ficha_monitoreo.asiucotrs_hoja_rel_buscar_patologia_1.getSize()==0){
				asivm_ficha_monitoreo[secPatologia]=0;
				forms.AsiVm_Monitoreo.elements.txt1_diagnostico2.editable=false;
				f_patologia2='';
			}
			break;
		case 'hucpat2':
			asivm_ficha_monitoreo.asiucotrs_hoja_rel_buscar_patologia_2.pat_codi=codigo;
			asivm_ficha_monitoreo[secPatologia]=codigo;
			f_descripcion_patologia2=asivm_ficha_monitoreo.asiucotrs_hoja_rel_buscar_patologia_2.pat_descrip
			forms.AsiVm_Monitoreo.elements.txt1_diagnostico3.editable=true;
			if(asivm_ficha_monitoreo.asiucotrs_hoja_rel_buscar_patologia_2.getSize()==0){
				asivm_ficha_monitoreo[secPatologia]=0;
				forms.AsiVm_Monitoreo.elements.txt1_diagnostico3.editable=false;
				f_patologia3='';
				
			}
			break;
		case 'hucpat3':
			asivm_ficha_monitoreo.asiucotrs_hoja_rel_buscar_patologia_3.pat_codi=codigo;
			asivm_ficha_monitoreo[secPatologia]=codigo;
			f_descripcion_patologia3=asivm_ficha_monitoreo.asiucotrs_hoja_rel_buscar_patologia_3.pat_descrip
			if(asivm_ficha_monitoreo.asiucotrs_hoja_rel_buscar_patologia_3.getSize()==0){
				asivm_ficha_monitoreo[secPatologia]=0;
			}
			break
		
		default:
			break;
		}
		
	}
	else{ 
		
		
	/*	switch (secPatologia) {
		case "hucpat1":
			forms.AsiVm_Monitoreo.elements.txt1_diagnostico2.editable=true;
			forms.AsiVm_Monitoreo.f_patologia1=foundset.pat_codi;
			forms.AsiVm_Monitoreo.f_descripcion_patologia1 = foundset.pat_descrip
			break;
		case "hucpat2":
			forms.AsiVm_Monitoreo.elements.txt1_diagnostico3.editable=true;
			forms.AsiVm_Monitoreo.f_patologia2=foundset.pat_codi;
			forms.AsiVm_Monitoreo.f_descripcion_patologia2 = foundset.pat_descrip
			break;
		
		case "hucpat3":
			forms.AsiVm_Monitoreo.f_patologia3=foundset.pat_codi;
			forms.AsiVm_Monitoreo.f_descripcion_patologia3 = foundset.pat_descrip
			break;

		default:
			break;
		}
		*/
		
		/*if(!globals.IsBlank(patologia)){
			f_pendienteDeSeleccion=true;
		}else{
			asiutitrs_rel_tbc_hciti_to_tbc_hciti[secPatologia]=0;
			switch (secPatologia) {
			case 'hucpat1':
			forms.AsiVm_Monitoreo.elements.txt_diagnostico2.editable=false;
			forms.AsiVm_Monitoreo.elements.txt_diagnostico3.editable=false;
			forms.AsiVm_Monitoreo.f_patologia2="";
			forms.AsiVm_Monitoreo.f_patologia3="";
				break;
			case 'hucpat2':
			forms.AsiVm_Monitoreo.elements.txt_diagnostico3.editable=false;
			forms.AsiVm_Monitoreo.f_patologia3="";
				break;
				
			default:
				break;
			}
		}*/
		
	}
	
	
	$isDirty = true;
	return true
	
}

/**
 * Handle changed data.
 *
 * @param {Number} oldValue old value
 * @param {Number} newValue new value
 * @param {JSEvent} event the event that triggered the action
 *
 * @returns {Boolean}
 *
 * @properties={typeid:24,uuid:"8DDA9ACC-33B0-4FEB-8843-8918649362A0"}
 */
function onDataChange_cboSelect(oldValue, newValue, event) {
	// TODO Auto-generated method stub
	$isDirty = true;
	elements.txt_temperatura.requestFocus();
	return true
}

/**
 * Perform the element default action.
 *
 * @param {JSEvent} event the event that triggered the action
 *
 * @properties={typeid:24,uuid:"41996585-2234-4E99-B10A-CFDA942BC969"}
 */
function onAction_imprimir(event) {
	
//var texto = '';
//	
//	texto = '¿Desea imprimir los datos de monitoreo?';
//	
//	var print = globals.DIALOGS.showQuestionDialog('¡Atención!', texto, 'Si', 'No');
//	if (print == 'Si') {
		forms.AsiVm_Template_print.imprimirReporte(asivm_ficha_monitoreo.histcli,asivm_ficha_monitoreo.fecha,2);
//		
//	}else
//		globals.DIALOGS.showWarningDialog("Atención!", "No existe el monitoreo para imprimir.", "Aceptar");
//	
	
}

/**
 * Callback method when form is (re)loaded.
 *
 * @param {JSEvent} event the event that triggered the action
 *
 * @properties={typeid:24,uuid:"031B59AF-F9C8-47E6-885F-339C5B42B2FE"}
 */
function onLoad_inicializarForm(event) {
	
	initFormFirstShow();
}

/**
 * @properties={typeid:24,uuid:"F4312099-9795-4DF0-841A-6F8B29065F42"}
 */
function initFormFirstShow(){
	
	inicializarForm()
	f_medico = utils.stringTrim(globals.Srv_Login_Sanatorio_vOperador);
	
	/*if(globals.Srv_Aislamiento_Sanatorio_vTipoOperador == 0){
		
		var ds_personal = databaseManager.getDataSetByQuery('maestros','select per_espemed from tbc_personal where per_legajo = ' + globals.Srv_Login_Sanatorio_vLega,null,-1);
		globals.Srv_Login_Sanatorio_vEspeMed = ds_personal.getMaxRowIndex() > 0 ? ds_personal.getValue(1,1) : 0;
	}	
	else{
		
		var ds_medicos = databaseManager.getDataSetByQuery('maestros','select med_espemed from tbc_medicos where med_codigo = ' + globals.Srv_Login_Sanatorio_vLega,null,-1);
		globals.Srv_Login_Sanatorio_vEspeMed = ds_medicos.getMaxRowIndex() > 0 ? ds_medicos.getValue(1,1) : 0;
	}*/
}

/**
 * 
 * @param {Number} value
 *
 * @properties={typeid:24,uuid:"5F5FFA28-3996-4BF4-8279-1C972BDAE263"}
 */
function formatear_HistClinInter(value)
{
	var hiscli1 = value.toString();
	switch (hiscli1.length){
		case 2:	hiscli1 = hiscli1.substr(0,1)+'/'+hiscli1.substr(1,1);break;
		case 3:	hiscli1 = hiscli1.substr(0,2)+'/'+hiscli1.substr(2,1);break;
		case 4:	hiscli1 = hiscli1.substr(0,3)+'/'+hiscli1.substr(3,1);break;
		case 5:	hiscli1 = hiscli1.substr(0,4)+'/'+hiscli1.substr(4,1);break;
		case 6:	hiscli1 = hiscli1.substr(0,5)+'/'+hiscli1.substr(5,1);break;
		case 7:	hiscli1 = hiscli1.substr(0,6)+'/'+hiscli1.substr(6,1);break;
		case 8:	hiscli1 = hiscli1.substr(0,7)+'/'+hiscli1.substr(7,1);break;
	}	
	return hiscli1;
}

/**
 * TODO generated, please specify type and doc for the params
 * @param texto
 * @param histClin
 *
 * @properties={typeid:24,uuid:"F165D6C7-D51B-46D9-819A-9C2B426DD103"}
 */
function grabaLog(texto,histClin) {
	
	var id = application.getUUID();
	//Verificando si existe clave primaria
	var sql = "SELECT EXISTS( SELECT id FROM cirugia_errores WHERE id='" + id + "')"
	var dsExists = databaseManager.getDataSetByQuery('bases_auxiliares',sql,null,-1);
	while(dsExists.getValue(1,1) == 1){
		id = application.getUUID();
		sql = "SELECT EXISTS( SELECT id FROM cirugia_errores WHERE id='" + id + "')"
		dsExists = databaseManager.getDataSetByQuery('bases_auxiliares',sql,null,-1);
	}
	
	var fs = databaseManager.getFoundSet("bases_auxiliares","cirugia_errores")
	var fechacarga = application.getServerTimeStamp();
	fs.newRecord()
	fs['id'] = id;
	fs['hiscli'] = histClin;
	fs['protocolo'] = 0;
	fs['texto_errores'] = application.getSolutionName() + "|" +  application.getIPAddress() + "|" + controller.getName() + "|" +  texto;
	fs['tipo_pac'] = 'Int';
	fs['fecha']=application.getServerTimeStamp();
	fs['hora']=fechacarga.getHours()+''+fechacarga.getMinutes()
	
	databaseManager.startTransaction()
	var result = databaseManager.saveData(fs);
	if(result){
		databaseManager.commitTransaction();				
	}
	else{
		var error1 = ''
		var error2 = ''
		var array = databaseManager.getFailedRecords()
		for (var i = 0; i < array.length; i++) {
			var record = array[i];
			var jstable = databaseManager.getTable(record);
			var tableSQLName = jstable.getSQLName();
			error1='Error de Grabación en Tabla:' + tableSQLName + ' en server:' + jstable.getServerName() + ' falló la grabación. Avise urgente a Sistemas, por favor!'
			error2='Error en grabación '+record.exception;
			if (record.exception.getErrorCode() == ServoyException.RECORD_VALIDATION_FAILED) {
		
				var thrown = record.exception.getValue()
			
			}
		}
		databaseManager.rollbackTransaction()
	}
}

/**
 * 
 * @param {Number} hisCli
 * @param {String} to
 * @param {String} cc
 * @param {String} cco
 * @param {String} asunto
 * @param {String} mensaje
 * @param {Array<Object>} attachment
 * @param {String} cuenta
 *
 * @properties={typeid:24,uuid:"14562566-5C20-4D65-B0ED-3AEA4ED016E8"}
 */
function grabarReenviaMail(hisCli,to,cc,cco,asunto,mensaje,attachment,cuenta){
	
	var id = application.getUUID();
	//Verificando si existe clave primaria
	var sql = "SELECT EXISTS( SELECT id FROM reenvia_mail WHERE id='" + id + "')";
	var dsExists = databaseManager.getDataSetByQuery('desal',sql,null,-1);
	while(dsExists.getValue(1,1) == 1){
		id = application.getUUID();
		sql = "SELECT EXISTS( SELECT id FROM reenvia_mail WHERE id='" + id + "')";
		dsExists = databaseManager.getDataSetByQuery('desal',sql,null,-1);
	}
	
	var fs = databaseManager.getFoundSet("desal","reenvia_mail");
	fs.newRecord();
	
	fs['id'] = id;
	fs['hiscli'] = hisCli;
	fs['fecha'] = application.getServerTimeStamp();;
	fs['mail_para'] = to;
	fs['mail_cc'] = cc;
	fs['mail_cco'] = cco;
	fs['id_cuenta_origen'] = cuenta;
	fs['asunto'] = asunto;
	fs['mensaje'] = mensaje;
	fs['estado'] = false;
	
	var fsItem = databaseManager.getFoundSet('desal','reenvia_mail_adjunto');
	if(attachment != null){
		
		var idItem;
		for(var k=0; k<attachment.length; k++){
			
			fsItem.newRecord();
			idItem = application.getUUID();
			//Verificando si existe clave primaria
			sql = "SELECT EXISTS( SELECT id FROM reenvia_mail_adjunto WHERE id='" + idItem + "')";
			dsExists = databaseManager.getDataSetByQuery('desal',sql,null,-1);
			while(dsExists.getValue(1,1) == 1){
				idItem = application.getUUID();
				sql = "SELECT EXISTS( SELECT id FROM reenvia_mail_adjunto WHERE id='" + idItem + "')";
				dsExists = databaseManager.getDataSetByQuery('desal',sql,null,-1);
			}
			
			fsItem['id'] = idItem;
			fsItem['id_reenvia_mail'] = id;
			fsItem['nombre_archivo'] = attachment[k]['nombre'];
			fsItem['archivo'] = plugins.file.readFile(attachment[k]['path']);
		}
	}
	
	databaseManager.startTransaction()
	var resultFs = databaseManager.saveData(fs);
	
	var resultItem = true;
	if(fsItem.getSize() > 0)
		resultItem = databaseManager.saveData(fsItem);
	
	if(resultFs && resultItem){

		databaseManager.commitTransaction();				
	}
	else{
		
		databaseManager.rollbackTransaction();
		var msgMail = "No ha sido posible grabar en tabla reenvia_mail. HC " + hisCli + "para " + to + cc + cco;
		grabaLog(msgMail,hisCli);
	}
}

/**
 * @properties={typeid:24,uuid:"2F0204AA-B914-484D-9786-BC801FC24AF1"}
 */
function inicializarRelacionCodAuto(){
	
	asiucotrs_hoja_rel_codauto.codautoadmi = 0;
	asiucotrs_hoja_rel_codauto.codautocdar = 0;
	asiucotrs_hoja_rel_codauto.codautoempr = 0;
	asiucotrs_hoja_rel_codauto.codautofsol = 0;
	asiucotrs_hoja_rel_codauto.codautohist = 0;
	asiucotrs_hoja_rel_codauto.codautohsol = 0;
	asiucotrs_hoja_rel_codauto.codautoobra = 0;
	asiucotrs_hoja_rel_codauto.codautoplan = ' ';
	asiucotrs_hoja_rel_codauto.codautoserv = 0;
	asiucotrs_hoja_rel_codauto.codautotipo = 0;
	asiucotrs_hoja_rel_codauto.codautoempr5 = 0;
	asiucotrs_hoja_rel_codauto.codautoesta3 = 0;
	asiucotrs_hoja_rel_codauto.codautoesta4 = 0;
	asiucotrs_hoja_rel_codauto.codautoesta6 = 0;
	asiucotrs_hoja_rel_codauto.codautofaut = 0;
	asiucotrs_hoja_rel_codauto.codautohabita = 0;
	asiucotrs_hoja_rel_codauto.codautohaut = 0;
	asiucotrs_hoja_rel_codauto.codautohist3 = 0;
	asiucotrs_hoja_rel_codauto.codautohist4 = 0;
	asiucotrs_hoja_rel_codauto.codautohist5 = 0;
	asiucotrs_hoja_rel_codauto.codautohist6 = 0;
	asiucotrs_hoja_rel_codauto.codautoimpre = 0;
	asiucotrs_hoja_rel_codauto.codautomedi = 0;
	asiucotrs_hoja_rel_codauto.codautoobra3 = 0;
	asiucotrs_hoja_rel_codauto.codautoobra4 = 0;
	asiucotrs_hoja_rel_codauto.codautoobra6 = 0;
	asiucotrs_hoja_rel_codauto.codautooper = 0;
	asiucotrs_hoja_rel_codauto.codautopant = 0;
	asiucotrs_hoja_rel_codauto.codautopedi = 0;
	asiucotrs_hoja_rel_codauto.codautoplan3 = ' ';
	asiucotrs_hoja_rel_codauto.codautoplan4 = ' ';
	asiucotrs_hoja_rel_codauto.codautoplan6 = ' ';
	asiucotrs_hoja_rel_codauto.codautosect = 0;
	asiucotrs_hoja_rel_codauto.codautoserv3 = 0;
	asiucotrs_hoja_rel_codauto.codautoserv4 = 0;
	asiucotrs_hoja_rel_codauto.codautoserv6 = 0;
	asiucotrs_hoja_rel_codauto.codautotmed = 0;
	asiucotrs_hoja_rel_codauto.codautotope = 0;
	asiucotrs_hoja_rel_codauto.codautoutiliza = 0;
}

/**
 * Perform the element default action.
 *
 * @param {JSEvent} event the event that triggered the action
 *
 * @properties={typeid:24,uuid:"CFDCC73E-CA9C-4948-B067-B458655F1AC8"}
 */
function onAction_txt_tensionMaxima(event) {
	elements.txt_tension_máxima.requestFocus()
	
	var secuencia = controller.getTabSequence();
	 var tabSeq=secuencia.indexOf(forms.AsiVm_Monitoreo.elements.txt_tension_máxima.getName());
	 
	 forms.AsiVm_Monitoreo.controller.focusField(secuencia[tabSeq+1], true);
	 
}

/**
 * Perform the element default action.
 *
 * @param {JSEvent} event the event that triggered the action
 *
 * @properties={typeid:24,uuid:"CBF091C8-8F71-496D-9B7B-AAD0FF8A2E9E"}
 */
function onAction_txtfrecuenciac(event) {
	elements.txt_frecuencia_cardiaca.requestFocus()
	
	var secuencia = controller.getTabSequence();
	 var tabSeq=secuencia.indexOf(forms.AsiVm_Monitoreo.elements.txt_frecuencia_cardiaca.getName());
	 
	 forms.AsiVm_Monitoreo.controller.focusField(secuencia[tabSeq+1], true);
	 
}

/**
 * Perform the element default action.
 *
 * @param {JSEvent} event the event that triggered the action
 *
 * @properties={typeid:24,uuid:"344D51D7-3076-470F-A55B-A12A9E4DF910"}
 */
function onAction_txttensionMin(event) {
	elements.txt_tension_minima.requestFocus()
	
	var secuencia = controller.getTabSequence();
	 var tabSeq=secuencia.indexOf(forms.AsiVm_Monitoreo.elements.txt_tension_minima.getName());
	 
	 forms.AsiVm_Monitoreo.controller.focusField(secuencia[tabSeq+1], true);
	 
	 
}

/**
 * @properties={typeid:24,uuid:"ECEE5DC8-B767-4BA0-A2D3-F0846F983C37"}
 */
function guardarDatos(){
	
	//ESTADO GENERAL
	asivm_ficha_monitoreo.frecuencia_cardiaca = f_frecuencia_cardiaca
	asivm_ficha_monitoreo.tension_arterial_diastolica = f_tension_arterial_min
	asivm_ficha_monitoreo.tension_arterial_sistolica = f_tension_arterial_max
	asivm_ficha_monitoreo.tesion_arterial_media = f_tension_arterial_media
	asivm_ficha_monitoreo.temperatura = f_temperatura
	asivm_ficha_monitoreo.rass= f_rass
	asivm_ficha_monitoreo.fecha = application.getServerTimeStamp()
	
//	if(globals.Asivm_prestacion==1){
		asivm_ficha_monitoreo.cpot = f_cpot
		asivm_ficha_monitoreo.analgesicos = utils.stringReplace(f_analgésicos,'\n',',') 
		asivm_ficha_monitoreo.sedacion = utils.stringReplace(f_sedación,'\n',',')
		asivm_ficha_monitoreo.bloqueantes_neuromsucualares = f_bloqueantes_neuromsuculares
		asivm_ficha_monitoreo.cam_icu = f_cam_icu
		
		//Monitoreo
		asivm_ficha_monitoreo.vm_monit_frec_respitoria_total=forms.AsiVm_tab_Monitoreo_VM.f_monitoreo_frec_respiratoria_total
		asivm_ficha_monitoreo.vm_monit_presion_pico=forms.AsiVm_tab_Monitoreo_VM.f_monitoreo_presion_pico
		asivm_ficha_monitoreo.vm_monit_presion_plateau=forms.AsiVm_tab_Monitoreo_VM.f_monitoreo_presion_plateau
		asivm_ficha_monitoreo.vm_monit_presion_media=forms.AsiVm_tab_Monitoreo_VM.f_monitoreo_presion_media
		asivm_ficha_monitoreo.vm_monit_peep_total=forms.AsiVm_tab_Monitoreo_VM.f_monitoreo_peep_total
		asivm_ficha_monitoreo.vm_monit_delta_presion=forms.AsiVm_tab_Monitoreo_VM.f_monitoreo_delta_presion
		asivm_ficha_monitoreo.vm_monit_p01=forms.AsiVm_tab_Monitoreo_VM.f_monitoreo_p01
		asivm_ficha_monitoreo.vm_monit_vol_corriente_exhalado=forms.AsiVm_tab_Monitoreo_VM.f_monitoreo_volumen_corriente_exhalado
		asivm_ficha_monitoreo.vm_monit_compliance=forms.AsiVm_tab_Monitoreo_VM.f_monitoreo_compliance
		asivm_ficha_monitoreo.vm_monit_resistencia=forms.AsiVm_tab_Monitoreo_VM.f_monitoreo_resistencia
		asivm_ficha_monitoreo.vm_monit_pmi=forms.AsiVm_tab_Monitoreo_VM.f_monitoreo_pmi
		asivm_ficha_monitoreo.vm_monit_presion_oclusion=forms.AsiVm_tab_Monitoreo_VM.f_monitoreo_presion_oclusion
		//varios
		asivm_ficha_monitoreo.vm_varios_sat=forms.AsiVm_tab_Varios.f_varios_sat
		asivm_ficha_monitoreo.vm_varios_exito=forms.AsiVm_tab_Varios.f_varios_exito
		asivm_ficha_monitoreo.vm_varios_pre=forms.AsiVm_tab_Varios.f_varios_pre
		asivm_ficha_monitoreo.vm_varios_eot=forms.AsiVm_tab_Varios.f_varios_eot
		asivm_ficha_monitoreo.vm_varios_dialisis=forms.AsiVm_tab_Varios.f_varios_dialisis
		asivm_ficha_monitoreo.vm_varios_aspirado_traqueal=forms.AsiVm_tab_Varios.f_varios_aspirado_traqueal
		asivm_ficha_monitoreo.vm_varios_balance_diario=forms.AsiVm_tab_Varios.f_varios_balance_diario
		asivm_ficha_monitoreo.vm_sofa_diario=forms.AsiVm_tab_Varios.f_varios_sofa_diario
//	}
//	if(globals.Asivm_prestacion==2 || globals.Asivm_prestacion==3){
		asivm_ficha_monitoreo.mecanica=utils.stringReplace(f_mecanica,'\n',',') 
		asivm_ficha_monitoreo.disnea=f_disnea
		asivm_ficha_monitoreo.frecuencia_respiratoria = f_estado_general_frecuencia_respiratoria
		asivm_ficha_monitoreo.saturacion = f_saturacion
//	}
	//EAB
	asivm_ficha_monitoreo.eab_hc03 = forms.AsiVm_tab_EAB.f_eab_hco3
	asivm_ficha_monitoreo.eab_p02= forms.AsiVm_tab_EAB.f_eab_po2
	asivm_ficha_monitoreo.eab_pa02_fi02= forms.AsiVm_tab_EAB.f_pao2_fio2
	asivm_ficha_monitoreo.eab_pc02= forms.AsiVm_tab_EAB.f_eab_pco2
	asivm_ficha_monitoreo.eab_ph = forms.AsiVm_tab_EAB.f_eab_ph
	
	//PROG es igual Seteo VM
//	if(globals.Asivm_prestacion==1
//	){
	//modo ventilatorio
		asivm_ficha_monitoreo.vm_modo_ventilatorio = forms.AsiVm_tab_seteo_vm.f_vm_seteo_modo_ventilatorio
		asivm_ficha_monitoreo.vm_seteo_volumen_corriente=forms.AsiVm_tab_seteo_vm.f_vm_seteo_volumen_corriente
		asivm_ficha_monitoreo.vm_seteo_presion_inspiratoria=forms.AsiVm_tab_seteo_vm.f_vm_seteo_presion_inspiratoria
		asivm_ficha_monitoreo.vm_seteo_frec_respiratoria=forms.AsiVm_tab_seteo_vm.f_vm_seteo_frecuencia_respiratoria
		asivm_ficha_monitoreo.vm_seteo_tiempo_inspiratorio = forms.AsiVm_tab_seteo_vm.f_vm_seteo_tiempo_inspiratorio
		asivm_ficha_monitoreo.vm_seteo_pausa = forms.AsiVm_tab_seteo_vm.f_vm_seteo_pausa
		asivm_ficha_monitoreo.vm_seteo_flujo = forms.AsiVm_tab_seteo_vm.f_vm_seteo_flujo
		asivm_ficha_monitoreo.vm_seteo_fio2 = forms.AsiVm_tab_seteo_vm.f_vm_seteo_FiO2
//		asivm_ficha_monitoreo.vm_seteo_fio2 = forms.AsiVm_tab_seteo_vm.f_vm_seteo_fi02
		asivm_ficha_monitoreo.vm_seteo_peep=forms.AsiVm_tab_seteo_vm.f_vm_seteo_peep
		
//		asivm_ficha_monitoreo.vm_seteo_pres=forms.AsiVm_tab_Programacion.f_cnaf_presion_soporte
//		asivm_ficha_monitoreo.vm_seteo_tiempo_inspiratorio=forms.AsiVm_tab_Programacion.f_vm_seteo_tiempo_inspiratorio
		
		
		//CNAF
		asivm_ficha_monitoreo.caf_prog_equipo=forms.AsiVm_tab_cnaf.f_cnaf_equipo
		asivm_ficha_monitoreo.caf_prog_tamanio_canula=forms.AsiVm_tab_cnaf.f_cnaf_tamanio_canula
	
		asivm_ficha_monitoreo.caf_prog_flujo=forms.AsiVm_tab_cnaf.f_cnaf_flujo
		asivm_ficha_monitoreo.caf_prog_fio2=forms.AsiVm_tab_cnaf.f_cnaf_FiO2
		asivm_ficha_monitoreo.caf_prog_frec_respi=forms.AsiVm_tab_cnaf.f_cnaf_frecuencia_respiratoria
		asivm_ficha_monitoreo.cnaf_spo2 = forms.AsiVm_tab_cnaf.f_cnaf_spo2
		asivm_ficha_monitoreo.cnaf_presen_secre = forms.AsiVm_tab_cnaf.f_cnaf_presencia_secrecion
		asivm_ficha_monitoreo.cnaf_empleo_muscu_accesorio = forms.AsiVm_tab_cnaf.f_cnaf_empleo_musculo_acc
	
		asivm_ficha_monitoreo.cnaf_indice_rox = forms.AsiVm_tab_cnaf.f_cnaf_indice_rox
//	}
//	if(globals.Asivm_prestacion==1 || globals.Asivm_prestacion==3){
//		asivm_ficha_monitoreo.progr_flujo=forms.AsiVm_tab_Programacion.f_cnaf_flujo
//		asivm_ficha_monitoreo.vm_seteo_fio2=forms.AsiVm_tab_Programacion.f_cnaf_FiO2
//		asivm_ficha_monitoreo.caf_prog_equipo=forms.AsiVm_tab_Programacion.f_equipo
//		asivm_ficha_monitoreo.caf_prog_tamanio_canula=forms.AsiVm_tab_Programacion.f_tamaño_canula
//	}
	//SETEO
//	if(globals.Asivm_prestacion==2){
		asivm_ficha_monitoreo.vni_seteo_ventilador=forms.AsiVm_tab_seteo_vni.f_seteo_vni_ventilador
		asivm_ficha_monitoreo.vni_seteo_interfase=forms.AsiVm_tab_seteo_vni.f_seteo_vni_interfase
		asivm_ficha_monitoreo.vni_seteo_modo=forms.AsiVm_tab_seteo_vni.f_seteo_vni_modo
		asivm_ficha_monitoreo.vni_seteo_presion_inspiratoria=forms.AsiVm_tab_seteo_vni.f_seteo_vni_presion_inspiratoria
		asivm_ficha_monitoreo.vni_seteo_peep=forms.AsiVm_tab_seteo_vni.f_seteo_vni_peep
		asivm_ficha_monitoreo.vni_seteo_frec_respiratoria=forms.AsiVm_tab_seteo_vni.f_seteo_vni_frecuencia_respiratoria
		asivm_ficha_monitoreo.vni_seteo_tiempo_inspiratorio=forms.AsiVm_tab_seteo_vni.f_seteo_vni_tiempo_inspiratorio
		asivm_ficha_monitoreo.vni_seteo_fio2=forms.AsiVm_tab_seteo_vni.f_seteo_vni_fio2
		asivm_ficha_monitoreo.vni_seteo_volumen_corriente = forms.AsiVm_tab_seteo_vni.f_seteo_vni_volumen_corriente

		//observaciones
		asivm_ficha_monitoreo.observaciones = forms.AsiVm_tab_Observaciones.f_observaciones
//	}

		//guardo tambien marca arm
//		asivm_ficha_monitoreo.arm = f_marca_arm
	
}

/**
 * @properties={typeid:24,uuid:"DACECCF3-5CEB-43A3-9AAD-FC840FB7770B"}
 */
function cargarDatos(){
//	var cbo_tipo_temp = application.getValueListItems('HciUcoTrs_Hoja_vl_temperatura')
//	var cbo_tipo_sonda = application.getValueListItems('HciUcoTrs_Hoja_vl_sonda')
	
	//estado general
	f_estado_general_frecuencia_respiratoria = asivm_ficha_monitoreo.frecuencia_respiratoria
	f_frecuencia_cardiaca = asivm_ficha_monitoreo.frecuencia_cardiaca
	f_tension_arterial_max=asivm_ficha_monitoreo.tension_arterial_sistolica
	f_tension_arterial_min=asivm_ficha_monitoreo.tension_arterial_diastolica
	f_tension_arterial_media=asivm_ficha_monitoreo.tesion_arterial_media
	f_rass= asivm_ficha_monitoreo.rass
	f_fecha_monitoreo = utils.dateFormat(asivm_ficha_monitoreo.fecha,'dd/MM/yyyy hh:mm aa')
	f_temperatura=asivm_ficha_monitoreo.temperatura
//	globals.AsiVm_fecha_monitoreo=utils.dateFormat(asivm_ficha_monitoreo.fecha,'dd/MM/yyyy hh:mm aa')
	if(asivm_fichakine.getSize()==1){
		f_lugar_internacion = asivm_fichakine.lugar_internacion
	}
	
//	if(globals.Asivm_prestacion==1){
		
		f_cpot = asivm_ficha_monitoreo.cpot
		f_analgésicos = utils.stringReplace(asivm_ficha_monitoreo.analgesicos,',','\n') 
		f_sedación=utils.stringReplace(asivm_ficha_monitoreo.sedacion,',','\n') 
		f_cam_icu= asivm_ficha_monitoreo.cam_icu
		f_bloqueantes_neuromsuculares=asivm_ficha_monitoreo.bloqueantes_neuromsucualares
		
		//vm
		f_modo_ventilatorio = globals.IsBlank(asivm_ficha_monitoreo.vm_modo_ventilatorio)?'':asivm_ficha_monitoreo.vm_modo_ventilatorio
		
		//monitereo
		forms.AsiVm_tab_Monitoreo_VM.f_monitoreo_frec_respiratoria_total=asivm_ficha_monitoreo.vm_monit_frec_respitoria_total
		forms.AsiVm_tab_Monitoreo_VM.f_monitoreo_presion_pico=asivm_ficha_monitoreo.vm_monit_presion_pico
		forms.AsiVm_tab_Monitoreo_VM.f_monitoreo_presion_plateau=asivm_ficha_monitoreo.vm_monit_presion_plateau
		forms.AsiVm_tab_Monitoreo_VM.f_monitoreo_presion_media=asivm_ficha_monitoreo.vm_monit_presion_media
		forms.AsiVm_tab_Monitoreo_VM.f_monitoreo_peep_total=asivm_ficha_monitoreo.vm_monit_peep_total
		forms.AsiVm_tab_Monitoreo_VM.f_monitoreo_delta_presion=asivm_ficha_monitoreo.vm_monit_delta_presion
		forms.AsiVm_tab_Monitoreo_VM.f_monitoreo_p01=asivm_ficha_monitoreo.vm_monit_p01
		forms.AsiVm_tab_Monitoreo_VM.f_monitoreo_volumen_corriente_exhalado=asivm_ficha_monitoreo.vm_monit_vol_corriente_exhalado
		forms.AsiVm_tab_Monitoreo_VM.f_monitoreo_compliance=asivm_ficha_monitoreo.vm_monit_compliance
		forms.AsiVm_tab_Monitoreo_VM.f_monitoreo_resistencia=asivm_ficha_monitoreo.vm_monit_resistencia
		forms.AsiVm_tab_Monitoreo_VM.f_monitoreo_pmi=asivm_ficha_monitoreo.vm_monit_pmi
		forms.AsiVm_tab_Monitoreo_VM.f_monitoreo_presion_oclusion=asivm_ficha_monitoreo.vm_monit_presion_oclusion
		
		//varios
		forms.AsiVm_tab_Varios.f_varios_sat=asivm_ficha_monitoreo.vm_varios_sat
		forms.AsiVm_tab_Varios.f_varios_exito=asivm_ficha_monitoreo.vm_varios_exito
		forms.AsiVm_tab_Varios.f_varios_pre=asivm_ficha_monitoreo.vm_varios_pre
		forms.AsiVm_tab_Varios.f_varios_eot=asivm_ficha_monitoreo.vm_varios_eot
		forms.AsiVm_tab_Varios.f_varios_dialisis=asivm_ficha_monitoreo.vm_varios_dialisis
		forms.AsiVm_tab_Varios.f_varios_aspirado_traqueal=asivm_ficha_monitoreo.vm_varios_aspirado_traqueal
		forms.AsiVm_tab_Varios.f_varios_balance_diario=asivm_ficha_monitoreo.vm_varios_balance_diario
		forms.AsiVm_tab_Varios.f_varios_sofa_diario=asivm_ficha_monitoreo.vm_sofa_diario
		
//	}else{
		f_mecanica = utils.stringReplace(asivm_ficha_monitoreo.mecanica,',','\n') 
		f_disnea =asivm_ficha_monitoreo.disnea
		f_saturacion = asivm_ficha_monitoreo.saturacion
//	}
	
	//eab
	forms.AsiVm_tab_EAB.f_eab_ph = utils.numberFormat(asivm_ficha_monitoreo.eab_ph,'#.0') //(100006.749, '#,###.00'); //returns 100,006.75

	forms.AsiVm_tab_EAB.f_eab_po2 = asivm_ficha_monitoreo.eab_p02
	forms.AsiVm_tab_EAB.f_eab_pco2 = asivm_ficha_monitoreo.eab_pc02
	forms.AsiVm_tab_EAB.f_eab_hco3=asivm_ficha_monitoreo.eab_hc03
	forms.AsiVm_tab_EAB.f_pao2_fio2 = asivm_ficha_monitoreo.eab_pa02_fi02
	
	

	
	//programacion vm
//	if(globals.Asivm_prestacion==1 ||
//	globals.Asivm_prestacion==3){
//		forms.AsiVm_tab_Programacion.f_cnaf_frecuencia_respiratoria = asivm_ficha_monitoreo.progr_frec_respira
//		forms.AsiVm_tab_Programacion.f_volumen_corriente = asivm_ficha_monitoreo.progr_volumen_corriente
//		forms.AsiVm_tab_Programacion.f_presion_inspiratoria=asivm_ficha_monitoreo.progr_presion_inspiratoria
//		forms.AsiVm_tab_Programacion.f_presion_soporte=asivm_ficha_monitoreo.progr_presion_soporte
//		forms.AsiVm_tab_Programacion.f_cnaf_flujo=asivm_ficha_monitoreo.progr_flujo
//		forms.AsiVm_tab_Programacion.f_cnaf_tiempo_inspiratorio=utils.numberFormat(asivm_ficha_monitoreo.progr_tiempo_inspiratorio,'#.0')
//		forms.AsiVm_tab_Programacion.f_cnaf_FiO2=asivm_ficha_monitoreo.progr_fi02
////		forms.AsiVm_tab_Programacion.f_peep=asivm_ficha_monitoreo.progr_peep
//		forms.AsiVm_tab_Programacion.f_equipo= asivm_ficha_monitoreo.caf_prog_equipo
//		forms.AsiVm_tab_Programacion.f_cnaf_presion_soporte= asivm_ficha_monitoreo.progr_presion_soporte
//		forms.AsiVm_tab_Programacion.f_tamaño_canula= asivm_ficha_monitoreo.caf_prog_tamanio_canula
//		forms.AsiVm_tab_Programacion.f_cnaf_presion_inspiratoria = asivm_ficha_monitoreo.progr_presion_inspiratoria
//		forms.AsiVm_tab_Programacion.f_cnaf_peep=asivm_ficha_monitoreo.progr_peep
		//CNAF
	forms.AsiVm_tab_cnaf.f_cnaf_equipo=asivm_ficha_monitoreo.caf_prog_equipo
	forms.AsiVm_tab_cnaf.f_cnaf_tamanio_canula=asivm_ficha_monitoreo.caf_prog_tamanio_canula
	forms.AsiVm_tab_cnaf.f_cnaf_flujo=asivm_ficha_monitoreo.caf_prog_flujo
	forms.AsiVm_tab_cnaf.f_cnaf_FiO2=asivm_ficha_monitoreo.caf_prog_fio2
	forms.AsiVm_tab_cnaf.f_cnaf_frecuencia_respiratoria=asivm_ficha_monitoreo.caf_prog_frec_respi
	forms.AsiVm_tab_cnaf.f_cnaf_spo2= asivm_ficha_monitoreo.cnaf_spo2
	forms.AsiVm_tab_cnaf.f_cnaf_presencia_secrecion = asivm_ficha_monitoreo.cnaf_presen_secre 
	forms.AsiVm_tab_cnaf.f_cnaf_empleo_musculo_acc = asivm_ficha_monitoreo.cnaf_empleo_muscu_accesorio 
	forms.AsiVm_tab_cnaf.f_cnaf_indice_rox = asivm_ficha_monitoreo.cnaf_indice_rox 
//		forms.AsiVm_tab_Programacion.f_cnaf_presion_soporte = asivm_ficha_monitoreo.progr_presion_soporte
//	}
//	if(globals.Asivm_prestacion==2){
		//seteo
		forms.AsiVm_tab_seteo_vni.f_seteo_vni_ventilador=asivm_ficha_monitoreo.vni_seteo_ventilador
		forms.AsiVm_tab_seteo_vni.f_seteo_vni_interfase=asivm_ficha_monitoreo.vni_seteo_interfase
		forms.AsiVm_tab_seteo_vni.f_seteo_vni_modo=asivm_ficha_monitoreo.vni_seteo_modo
		forms.AsiVm_tab_seteo_vni.f_seteo_vni_presion_inspiratoria=asivm_ficha_monitoreo.vni_seteo_presion_inspiratoria
		forms.AsiVm_tab_seteo_vni.f_seteo_vni_peep=asivm_ficha_monitoreo.vni_seteo_peep
		forms.AsiVm_tab_seteo_vni.f_seteo_vni_frecuencia_respiratoria=asivm_ficha_monitoreo.vni_seteo_frec_respiratoria
		forms.AsiVm_tab_seteo_vni.f_seteo_vni_tiempo_inspiratorio=asivm_ficha_monitoreo.vni_seteo_tiempo_inspiratorio
		forms.AsiVm_tab_seteo_vni.f_seteo_vni_fio2=asivm_ficha_monitoreo.vni_seteo_fio2
		forms.AsiVm_tab_seteo_vni.f_seteo_vni_volumen_corriente=asivm_ficha_monitoreo.vni_seteo_volumen_corriente
//	}
	 //SETEO VM
		forms.AsiVm_tab_seteo_vm.f_vm_seteo_modo_ventilatorio=asivm_ficha_monitoreo.vm_modo_ventilatorio 
		forms.AsiVm_tab_seteo_vm.f_vm_seteo_volumen_corriente=asivm_ficha_monitoreo.vm_seteo_volumen_corriente
		forms.AsiVm_tab_seteo_vm.f_vm_seteo_presion_inspiratoria=asivm_ficha_monitoreo.vm_seteo_presion_inspiratoria
		forms.AsiVm_tab_seteo_vm.f_vm_seteo_frecuencia_respiratoria=asivm_ficha_monitoreo.vm_seteo_frec_respiratoria
		forms.AsiVm_tab_seteo_vm.f_vm_seteo_tiempo_inspiratorio=asivm_ficha_monitoreo.vm_seteo_tiempo_inspiratorio 
		forms.AsiVm_tab_seteo_vm.f_vm_seteo_pausa=asivm_ficha_monitoreo.vm_seteo_pausa
		forms.AsiVm_tab_seteo_vm.f_vm_seteo_flujo=asivm_ficha_monitoreo.vm_seteo_flujo
		forms.AsiVm_tab_seteo_vm.f_vm_seteo_FiO2=asivm_ficha_monitoreo.vm_seteo_fio2 
//		asivm_ficha_monitoreo.vm_seteo_fio2 = forms.AsiVm_tab_seteo_vm.f_vm_seteo_fi02
		forms.AsiVm_tab_seteo_vm.f_vm_seteo_peep=asivm_ficha_monitoreo.vm_seteo_peep
		forms.AsiVm_tab_Observaciones.f_observaciones = asivm_ficha_monitoreo.observaciones
}



/**
 * TODO generated, please specify type and doc for the params
 * @author gennari gustavo
 * @param formName
 * @param validarSinPropertys
 * @param patron campos con coinciden validara. Vacio validara "txt_"
 * @param validarCantCaracteres valida cantidad de caracteres en campo
 * @param minCaracteres complemento al parametro anterior 
 * @param noValidarEstosCampos Ejemplo si no quiero validar txt_hola, txt_cbo_pepe, pongo "txt_hola txt_cbo_pepe "
 *
 * @properties={typeid:24,uuid:"29398039-D756-4A01-AB7C-22AF1F70E06D"}
 */
function validateRequired(formName, validarSinPropertys, patron, validarCantCaracteres, minCaracteres) { //noValidarEstosCampos
    var ok = true;
    var textReplace=(patron!=null && !globals.IsBlank(patron))?patron:'txt_';
    var flds = forms[formName].elements;
    for (var item in flds) {
        var elm = flds[item];
        var propEncontrada = elm.getDesignTimeProperty('requerido');
        var name= elm.getName();
        if(elm.enabled==false || elm.visible==false){// SI ESTA DESHABILILTADO o Oculto NO VALIDO CAMPO.
        	continue;
    	}
        //application.output(name); ver campos que se validan
        if(patron!=null && !globals.IsBlank(patron)){//pasa de largo lo que no tienen el patron.
        	if(name.indexOf(patron)==-1 && propEncontrada==undefined){ //si propEncontra no es nula hay que validar igual o no.
        		continue;
        	}
        	/*if(!globals.IsBlank(noValidarEstosCampos)){// si hay campos que no se quieren valiar. Esto sera distinto a null o vacio
        		if(name.indexOf(noValidarEstosCampos)!=-1){ // si el nombre del campo aparece en noValidarEstosCampos no se valida y sigue de largo.
        			continue;
        		}
        	}*/
        	
        }
        if (name!=null && name.indexOf("grp")==-1 && propEncontrada==true || validarSinPropertys &&  propEncontrada==undefined) {//si tiene propertys hay que validar // ojo cuando no es relacion
            var dp = elm.getDataProviderID() //obtenemos variable asociada
            //if (!forms[formName].foundset.getSegetSelectedRecord()[dp]) { //esto se usaba para obtener el recurso.
            var arrRelacion = (dp!=null)?dp.split("."):'';
            if (arrRelacion!='' && dp.indexOf("rel")>0 &&!globals[arrRelacion[0]][arrRelacion[1]]>=1) {
               // forms[formName].elements[name].bgcolor = "#ffbc78";
                isValid = false;
                if(propEncontrada && name.indexOf(textReplace)==-1){
        			messageError += "\nDebe ingresar: " + forms[formName].elements[name].getName().replace('txt_','').replace(/\_/g,' ');
        		}else{
        			messageError += "\nDebe ingresar: " + forms[formName].elements[name].getName().replace(textReplace,'').replace(/\_/g,' ');
        		}
        		if(validarCantCaracteres && propEncontrada==undefined){
        			messageError+=' Con '+ minCaracteres +' caracteres como mínimo.';
        		}
            	
            }else if(dp.indexOf("rel")==-1 && dp.indexOf("cbo")==-1){
            	if((validarCantCaracteres && forms[formName][dp]!=null && forms[formName][dp].length<minCaracteres) || ""==utils.stringTrim(forms[formName][dp]) || "0"==utils.stringTrim(forms[formName][dp])  ){
            		
            		  //forms[formName].elements[name].bgcolor = "#ffbc78";
            		isValid = false;
            		if(propEncontrada && name.indexOf(textReplace)==-1){
            			messageError += "\nDebe ingresar: " + forms[formName].elements[name].getName().replace('txt_','').replace(/\_/g,' ');
            		}else{
            			messageError += "\nDebe ingresar: " + forms[formName].elements[name].getName().replace(textReplace,'').replace(/\_/g,' ');
            		}
            		
            		
            		if(validarCantCaracteres && propEncontrada==undefined){
            			messageError+=' Con '+ minCaracteres +' caracteres como mínimo.';
            		}
            	}else{
            		// forms[formName].elements[name].bgcolor = "#d4e8d4";
            	}
            }else if(dp.indexOf("cbo")!=-1){
               	if((validarCantCaracteres && forms[formName][dp]!=null && forms[formName][dp]<minCaracteres) ||  ""==utils.stringTrim(forms[formName][dp]) ){
            		
          		  //forms[formName].elements[name].bgcolor = "#ffbc78";
          		isValid = false;
          		if(propEncontrada && name.indexOf(textReplace)==-1){
          			messageError += "\nDebe ingresar: " + forms[formName].elements[name].getName().replace('txt_','').replace(/\_/g,' ');
          		}else{
          			messageError += "\nDebe ingresar: " + forms[formName].elements[name].getName().replace(textReplace,'').replace(/\_/g,' ');
          		}
          		
          		
          		if(validarCantCaracteres && propEncontrada==undefined){
          			messageError+=' Con '+ minCaracteres +' caracteres como mínimo.';
          		}
          	}else{
          		// forms[formName].elements[name].bgcolor = "#d4e8d4";
          	}
            }
            
            else {
                //forms[formName].elements[name].bgcolor = "#d4e8d4";
            }
            propEncontrada=false;
        }
    }
    
    return ok;
}

/**
 * @properties={typeid:24,uuid:"1F5E8318-8938-4567-A103-28CF3DE1BBDA"}
 */
function mostrarSoloLectura(){
//	forms.AsiVm_Monitoreo.elements.btn_editar.readOnly=true;
	forms.AsiVm_Monitoreo.elements.btn_imprimir.readOnly=true;
	forms.AsiVm_Monitoreo.elements.btn_grabar.enabled = false
	forms.AsiVm_Monitoreo.elements.cbo_arm.enabled = false;
	
//	globals.modificarCampos('AsiVm_Monitoreo', globals.setearEnModoLecturaCampos,null);
	
	var elementosTab1 = forms.AsiVm_Monitoreo.elements.tab_informe_1.getMaxTabIndex()
	for (var index = 1; index <= elementosTab1; index++) {
		var nombreFormulario = forms.AsiVm_Monitoreo.elements.tab_informe_1.getTabFormNameAt(index);
		globals.modificarCampos(nombreFormulario, globals.setearEnModoLecturaCampos,'tea_texto');
		
	}
	var elementosTab2 = forms.AsiVm_Monitoreo.elements.tab_informe_2.getMaxTabIndex()
	for (var index2 = 1; index2 <= elementosTab2; index2++) {
		var nombreFormulario2 = forms.AsiVm_Monitoreo.elements.tab_informe_2.getTabFormNameAt(index2);
		globals.modificarCampos(nombreFormulario2, globals.setearEnModoLecturaCampos,'tea_texto');
	}
	
	elements.grp_diagnostico.readOnly=true
	elements.grp_signovitale.readOnly=true

	
	/*elements.grp_diagnostico.readOnly=true
	elements.grp_signovitale.readOnly=true*/
	
//	globals.modificarCampos('AsiVm_Monitoreo', globals.setearEnModoLecturaCampos,'txt_tensionMin,txt_tensionMax,txt_temperatura,txt_frecuenciac,txt_frecuencia_respiratoria,cbo_temperatura');
}

/**
 * @properties={typeid:24,uuid:"B0F52F0D-F583-4840-B555-916805A87C95"}
 */
function mostrarModoEditable(){
	var elementosTab1 = forms.AsiVm_Monitoreo.elements.tab_informe_1.getMaxTabIndex()
	for (var index = 1; index <= elementosTab1; index++) {
		var nombreFormulario = forms.AsiVm_Monitoreo.elements.tab_informe_1.getTabFormNameAt(index);
		globals.modificarCampos(nombreFormulario, globals.habilitarCampos,'tea_texto');
		
	}
	var elementosTab2 = forms.AsiVm_Monitoreo.elements.tab_informe_2.getMaxTabIndex()
	for (var index2 = 1; index2 <= elementosTab2; index2++) {
		var nombreFormulario2 = forms.AsiVm_Monitoreo.elements.tab_informe_2.getTabFormNameAt(index2);
		globals.modificarCampos(nombreFormulario2, globals.habilitarCampos,'tea_texto');
	}
	
	/*elements.grp_diagnostico.readOnly=false
	elements.grp_signovitale.readOnly=false*/
	
	elements.grp_diagnostico.enabled=true
	elements.grp_signovitale.enabled=true
	forms.AsiVm_Monitoreo.elements.cbo_arm.enabled = true;
}

/**
 * TODO generated, please specify type and doc for the params
 * @param event
 *
 * @properties={typeid:24,uuid:"B2AC440A-4420-455B-A67E-E5E84AA1DB00"}
 */
function onAction_btnEditar(event) {
	// TODO Auto-generated method stub

	if(!asivm_ficha_monitoreo.hucimpresa==1){
	
//		forms.AsiVm_Monitoreo.elements.txt_diagnostico3.editable=true;
//		forms.AsiVm_Monitoreo.elements.txt_diagnostico3.enabled=true;
		forms.AsiVm_Monitoreo.elements.grp_signovitale.readOnly=false
		forms.AsiVm_Monitoreo.elements.grp_signovitale.readOnly=false

		
	}else{
			plugins.dialogs.showInfoDialog("Documento fue Impreso","Esta evolución ya no será posible editar");

	}
	
}

/**
 * Perform the element default action.
 *
 * @param {JSEvent} event the event that triggered the action
 *
 * @properties={typeid:24,uuid:"D14E2414-FE74-40E3-B067-18A801C40AE8"}
 */
function onActionPulsoFrencuencia(event) {
	// TODO Auto-generated method stub
	$isDirty = true;
//	forms.AsiVm_Monitoreo.controller.
	var secuencia = controller.getTabSequence();
	 var tabSeq=secuencia.indexOf(forms.AsiVm_Monitoreo.elements.txt_frecuencia_respiratoria.getName());
	 
	 forms.AsiVm_Monitoreo.controller.focusField(secuencia[tabSeq+1], true);
	return true
}

/**
 * Handle changed data.
 *
 * @param {Number} oldValue old value
 * @param {Number} newValue new value
 * @param {JSEvent} event the event that triggered the action
 *
 * @returns {Boolean}
 *
 * @properties={typeid:24,uuid:"E5E6EF63-F1C5-4584-8464-E680B08B5EBA"}
 */
function onDataChangeFrecuenciaRespiratoria(oldValue, newValue, event) {
	forms.AsiVm_Monitoreo.$isDirty=true
	globals.valida_rango_campo(0,100,newValue, oldValue,event,"0")
	if(!globals.errorDato){
		return false
	}else{
		elements.txt_frecuencia_respiratoria.requestFocus()
		return true	
	}
}

/**
 * TODO generated, please specify type and doc for the params
 * @param oldValue
 * @param newValue
 * @param event
 *
 * @properties={typeid:24,uuid:"4430E6FB-5375-4F7C-A64F-243EEE1454D1"}
 */
function onDataChangeSaturacion(oldValue, newValue, event) {
	forms.AsiVm_Monitoreo.$isDirty=true
	globals.valida_rango_campo(0,100,newValue, oldValue,event,"0")
	if(!globals.errorDato){
		return false
	}else{
		elements.txt_saturacion.requestFocus()
		return true	
	}
}

/**
 * Handle changed data.
 *
 * @param {Number} oldValue old value
 * @param {Number} newValue new value
 * @param {JSEvent} event the event that triggered the action
 *
 * @returns {Boolean}
 *
 * @properties={typeid:24,uuid:"B6178DEC-B21C-463A-9AD4-28D8FE0B12BC"}
 */
function onDataChangeArm(oldValue, newValue, event) {
	// TODO Auto-generated method stub
	$isDirty = true;
	return true
}


/**
 * TODO generated, please specify type and doc for the params
 * @param event
 *
 * @properties={typeid:24,uuid:"6BB85513-B6DA-40F3-A354-BE740AA25353"}
 */
function onActionEnterSecuence(event) {
	// TODO Auto-generated method stub
	var tabseq = forms.AsiVm_Monitoreo.controller.getTabSequence();
	if (tabseq.length > 1 && isNaN(event)) {
	var secActual= tabseq.indexOf(event.getElementName());
	    forms.AsiVm_Monitoreo.controller.focusField(tabseq[secActual+1], true);
	}
}

/**
 * Perform the element default action.
 *
 * @param {JSEvent} event the event that triggered the action
 *
 * @properties={typeid:24,uuid:"8F71EFD0-304F-4FE5-ADCA-CFA8AD7C61EE"}
 */
function onActionFrecuenciaRespiratoria(event) {
	// TODO Auto-generated method stub
	$isDirty = true;
//	forms.AsiVm_Monitoreo.controller.
	var secuencia = controller.getTabSequence();
	 var tabSeq=secuencia.indexOf(forms.AsiVm_Monitoreo.elements.txt_frecuencia_respiratoria.getName());
	 
	 forms.AsiVm_Monitoreo.controller.focusField(secuencia[tabSeq+1], true);
	return true
}

/**
 * Perform the element default action.
 *
 * @param {JSEvent} event the event that triggered the action
 *
 * @properties={typeid:24,uuid:"B835CB99-C8E1-463A-BFB6-46C30A01A6CA"}
 */
function onActionTemperatura(event) {
	// TODO Auto-generated method stub
	var secuencia = controller.getTabSequence();
	 var tabSeq=secuencia.indexOf(forms.AsiVm_Monitoreo.elements.txt_temperatura.getName());
	 
	 forms.AsiVm_Monitoreo.controller.focusField(secuencia[tabSeq+1], true);
	return true
}

/**
 * Callback method for when form is shown.
 *
 * @param {Boolean} firstShow form is shown first time after load
 * @param {JSEvent} event the event that triggered the action
 *
 * @properties={typeid:24,uuid:"2973C63B-7A84-4F3A-823C-0EA88A632639"}
 */
function onShowMonitoreo(firstShow, event) {
	// TODO Auto-generated method stub
	//mostrar monitoreos de la ficha o permitir generar nueva.
	initFormFirstShow();
	globals.errorDato=true
	elements.txt_paciente.requestFocus(); 
	var buscarAdmision = asivm_rel_buscar_admision
	globals.AsiVm_Fecha_dia = utils.dateFormat(application.getServerTimeStamp(),'dd/MM/yyyy hh:mm aa')
	//f_paciente = globals.AsiVm_paciente;
	//limpiarForm();
	//datos paciente.
	if(asivm_rel_buscar_admision_con_alta.getSize()==1){
		buscarAdmision = asivm_rel_buscar_admision_con_alta
	}
	f_paciente = formatear_HistClinInter(buscarAdmision.adm_histclin) + ' ' + utils.stringTrim(buscarAdmision.adm_apelnom);
	f_histClinUnica = buscarAdmision.adm_histclinuni;
	globals.AsiVm_histClinUnica  = buscarAdmision.adm_histclinuni;
	f_sexo = buscarAdmision.adm_sexo;
	f_edad = globals.CalculoEdad(buscarAdmision.adm_fecnac) + ' ' + globals.vTipoEdad;
	f_habita = buscarAdmision.adm_habita;
	f_cama = buscarAdmision.adm_cama;
	f_medico = utils.stringTrim(globals.Srv_Login_Sanatorio_vOperador);
	f_marca_arm = asivm_rel_admision_arm.admarm
	globals.AsiVm_obrCodigo = asivm_rel_admision_arm.adm_obrsoc;
	
if(asivm_buscar_monitoreo!=null && asivm_buscar_monitoreo.getSize() > 0){ //|| (dsHojaUco.getMaxRowIndex() == 1 && wCerrada == 1)

		
		//siempre es posible agrega evoluciones
		var monitoreoRegistros = databaseManager.createEmptyDataSet();
		monitoreoRegistros.addColumn('id');
		monitoreoRegistros.addColumn('fecha');
		monitoreoRegistros.addColumn('idficha');
		monitoreoRegistros.addColumn('texto');
		for(var j=1; j<=asivm_buscar_monitoreo.getSize(); j++){
			monitoreoRegistros.addRow([asivm_buscar_monitoreo.getRecord(j).fichakine_monitoreo_id
								,asivm_buscar_monitoreo.getRecord(j).fecha
								,asivm_buscar_monitoreo.getRecord(j).fichavm
								,utils.dateFormat(asivm_buscar_monitoreo.getRecord(j).fecha,'dd/MM/yyyy hh:mm aa')
								]);
		}
		//if(wCerrada == 1 && wImpresa == 0)
		if(asivm_fichakine.fecha_fin==null && asivm_rel_buscar_admision_con_alta.getSize()==0){
			monitoreoRegistros.addRow([0,null,0,'NUEVA']);
		}
		
			
		var $tipos = [JSColumn.NUMBER,JSColumn.DATETIME,JSColumn.NUMBER, JSColumn.TEXT];
		var $frm = solutionModel.getForm('Asivm_tbl_hcivm');
		$frm.dataSource =""
		$frm.dataSource = monitoreoRegistros.createDataSource('ds_hciuco', $tipos);
		forms.Asivm_tbl_hcivm.controller.recreateUI();
		
			var win2 = application.createWindow("seleccion_monitoreo", JSWindow.MODAL_DIALOG);
			win2.title = 'Monitoreos existentes de ficha';
			win2.resizable = false;
			win2.show(forms.Asivm_tbl_hcivm);
		
		
	}else{
		forms.AsiVm_Monitoreo.loadData()
	}
	application.updateUI();
	// Inicializando impresion
//	forms.AsiVm_Print.onShow_inicializarForm(true,null);
	
}


/**
 * Handle changed data.
 *
 * @param {Number} oldValue old value
 * @param {Number} newValue new value
 * @param {JSEvent} event the event that triggered the action
 *
 * @returns {Boolean}
 *
 * @properties={typeid:24,uuid:"B6722B5A-125E-4CBB-A38E-AEC7B576D9DA"}
 */
function onDataChangeTemperatura(oldValue, newValue, event) {
	forms.AsiVm_Monitoreo.$isDirty=true
	globals.valida_rango_campo(0,45,newValue, oldValue,event,"0")
	if(!globals.errorDato){
		return false
	}else{
		elements.txt_temperatura.requestFocus()
		return true	
	}
}

/**
 * Handle changed data.
 *
 * @param {Number} oldValue old value
 * @param {Number} newValue new value
 * @param {JSEvent} event the event that triggered the action
 *
 * @returns {Boolean}
 *
 * @properties={typeid:24,uuid:"0466478E-1BC8-454A-B449-4F8CF827B45C"}
 */
function onDataChangeFrecuenciaCardiaca(oldValue, newValue, event) {
	forms.AsiVm_Monitoreo.$isDirty=true
	globals.valida_rango_campo(0,250,newValue, oldValue,event,"0")
	if(!globals.errorDato){
		return false
	}else{
		elements.txt_frecuencia_cardiaca.requestFocus()
		return true	
	}
}

/**
 * Handle changed data.
 *
 * @param {Number} oldValue old value
 * @param {Number} newValue new value
 * @param {JSEvent} event the event that triggered the action
 *
 * @returns {Boolean}
 *
 * @properties={typeid:24,uuid:"ADAAB492-1497-475E-848C-6F19597922D6"}
 */
function onDataChangeTesionArterialMedia(oldValue, newValue, event) {
	forms.AsiVm_Monitoreo.$isDirty=true
	globals.valida_rango_campo(0,250,newValue, oldValue,event,"0")
	if(!globals.errorDato){
		return false
	}else{
		elements.txt_tension_arterial_media.requestFocus()
		return true	
	}
}

/**
 * Handle changed data.
 *
 * @param {Number} oldValue old value
 * @param {Number} newValue new value
 * @param {JSEvent} event the event that triggered the action
 *
 * @returns {Boolean}
 *
 * @properties={typeid:24,uuid:"D4A1CC5D-81A0-43DC-A62A-C89EECC8874E"}
 */
function onDataChangeTesionArterialMnima(oldValue, newValue, event) {
	forms.AsiVm_Monitoreo.$isDirty=true
	globals.valida_rango_campo(0,250,newValue, oldValue,event,"0")
	if(!globals.errorDato){
		return false
	}else{
		elements.txt_tension_minima.requestFocus()
		return true	
	}
}

/**
 * Handle changed data.
 *
 * @param {Number} oldValue old value
 * @param {Number} newValue new value
 * @param {JSEvent} event the event that triggered the action
 *
 * @returns {Boolean}
 *
 * @properties={typeid:24,uuid:"E94A037D-80B1-4166-AA32-228F4C470935"}
 */
function onDataChangeTesionArterialMaxima(oldValue, newValue, event) {
	forms.AsiVm_Monitoreo.$isDirty=true
	globals.valida_rango_campo(0,250,newValue, oldValue,event,"0")
	if(!globals.errorDato){
		return false
	}else{
		elements.txt_tension_máxima.requestFocus()
		return true	
	}
	
	
}

/**
 * Callback method when form is destroyed.
 *
 * @param {JSEvent} event the event that triggered the action
 *
 * @properties={typeid:24,uuid:"1A8C89A3-8D99-4155-8D96-639BF4C238A0"}
 */
function onUnload(event) {
	// TODO Auto-generated method stub
	
//	application.updateUI();
////	// Inicializando impresion
//	forms.AsiVm_Print.onShow_inicializarForm(true,null);
}

/**
 * Handle changed data.
 *
 * @param {Number} oldValue old value
 * @param {Number} newValue new value
 * @param {JSEvent} event the event that triggered the action
 *
 * @returns {Boolean}
 *
 * @properties={typeid:24,uuid:"DDA70012-B421-4038-9C66-8036151EC68D"}
 */
function onDataChange(oldValue, newValue, event) {
	// TODO Auto-generated method stub
	$isDirty = true;
	return true
}

/**
 * Handle changed data.
 *
 * @param {Number} oldValue old value
 * @param {Number} newValue new value
 * @param {JSEvent} event the event that triggered the action
 *
 * @returns {Boolean}
 *
 * @properties={typeid:24,uuid:"5AF34EAF-DF01-4B8A-958F-7FAAF186298B"}
 */
function onDataChangeArmMonitoreo(oldValue, newValue, event) {
	// TODO Auto-generated method stub
	$isDirty = true;
	return true
}
