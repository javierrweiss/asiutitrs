/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"B5C52165-EA45-4F06-A867-FD6A6810BC8D"}
 */
var f_edad = '';

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"F03554B7-C50B-46CF-AA62-1849867C5D59"}
 */
var f_histClinica = '';

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"A4C0BF20-1213-44CE-B02A-1A51A10D7A6C"}
 */
var f_afiliado = '';

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"4772ED05-FA33-4422-AF6D-3B7A364C13B3",variableType:4}
 */
var $_totalEscAlderete = 0;

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"D0241AAE-7281-4FEA-88F2-AD4581549357"}
 */
var horaIngreso = '';

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"2F7F0178-4776-407D-B732-D1298ACEAD16"}
 */
var fechaIngreso = '';

/**
 * @properties={typeid:35,uuid:"8F3A5C3C-2D61-449A-9F50-B92876914F89",variableType:-4}
 */
var f_cerrarForm = false;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"3D5C4F31-5948-4399-94A1-86B6CA17B7AA",variableType:4}
 */
var f_quirofano = 0;

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"8C5F5279-324F-46B1-8645-0A2CEC51FDCE"}
 */
var f_itvDesc = '';

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"C6869F79-7C33-4602-AC3E-0EF9144F52B8"}
 */
var f_html = '';

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"7FFA918B-C9A7-45B0-B190-FD82666280FB"}
 */
var f_instrumentista_cont = '';

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"037BF2C3-CEB6-419E-888F-1BE98DE15B75"}
 */
var f_especialista_cont = '';

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"85E86F22-92BD-4160-8E09-2FEB807C7F4B"}
 */
var f_ayudante_3_cont = '';

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"0C792CAE-0233-41A1-B6CE-8D10DDC3DBA4"}
 */
var f_ayudante_2_cont = '';

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"7F157DB9-F385-43EB-9BA6-D9BF0CD2AB74"}
 */
var f_ayudante_1_cont = '';

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"9A7BF783-6F01-42C0-818F-E42DAF2C738D"}
 */
var f_anestesista_cont = '';

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"DED65956-BDE7-4F7B-BA88-A6E7CB65340F",variableType:4}
 */
var indexTotal = 0;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"FDA414CC-5AD9-4610-B9E7-BB6FE1A2D261",variableType:4}
 */
var indexActual = 0;

/**
 * @properties={typeid:35,uuid:"FB6AF30F-491D-43B3-A679-84199AD0A054",variableType:-4}
 */
var dsIntervencion = databaseManager.createEmptyDataSet();

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"EC468817-7251-42BC-8D5F-0D5D200979A0"}
 */
var f_anestesista_hon = '';

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"A56FF9A9-EE40-421F-BC71-35200D46ACD3"}
 */
var f_instrumentista_hon = '';

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"B9D96E8F-F00E-4BCD-9346-C6EE1717DE15"}
 */
var f_ayudante_3_hon = '';

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"54032AF9-DBA6-4CAE-8F82-C96D25AB0F17"}
 */
var f_ayudante_2_hon = '';

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"A262CF49-0D48-4078-88B2-52FBD3ABE4CB"}
 */
var f_ayudante_1_hon = '';

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"4395F8BB-0050-445D-835F-53CA80EE4F72"}
 */
var f_especialista_hon = '';

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"E799DF2D-E43F-4CC5-AF58-323955427C15"}
 */
var f_instrumentista = '';

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"3670D7C7-9CCC-48E8-896F-BEDAD0DE6B2F"}
 */
var f_anestesista = '';

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"2B5CBA79-7E38-485F-942B-B9C5F32CF77D"}
 */
var f_ayudante_3 = '';

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"FE62D813-E693-456F-90E5-055C7187F087"}
 */
var f_ayudante_2 = '';

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"01C42281-8EF4-4067-9DFC-98FA0AC26376"}
 */
var f_ayudante_1 = '';

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"5447AF89-E406-427E-853E-396722C3CF98"}
 */
var f_especialista = '';

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"07DAA1B1-28EF-4FF5-98E2-ED851BEF4B8B"}
 */
var f_intervencion = '';

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"456DF56A-BC90-41F5-9A16-15F58BD9AA09"}
 */
var f_codigo = '';

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"69A127A0-A4CB-4D58-B40E-FD62F723EFC2"}
 */
var historiaClinica = '';

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"99E740E5-F44D-440B-889C-83A8431C7039"}
 */
var f_prueba = '';

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"6D0AAF77-B2EF-4942-991B-B701E36CF499"}
 */
var f_plan = '';

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"5D5FE421-16C0-4A25-9693-187C3366A606"}
 */
var f_cobertura = '';

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"42E1F423-9296-4F2D-8685-5B89886688E9"}
 */
var f_protocolo = '';

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"4CB0F73F-64AE-42E7-84EE-5D691D7340FE"}
 */
var f_fechaCarga = '';

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"12315FCB-DDA5-42FE-8527-A2688FC1A23C"}
 */
var f_paciente = '';

/**
 * Callback method for when form is shown.
 *
 * @param {Boolean} firstShow form is shown first time after load
 * @param {JSEvent} event the event that triggered the action
 *
 * @properties={typeid:24,uuid:"82D7B90F-0E78-4A9C-8941-BBE89BBB9E63"}
 */
function onShow_inicializarForm(firstShow, event) {
		
	limpiarIntervencionForm();
	for(var i=1;i<=9;i++){
		globals['proto'+i]='';
	}
	globals.tempHTML = '';
	
	var data = forms.consulta_288_lst_protocolo_quirurgico_ambulatorio.foundset.getSelectedRecord();
	historiaClinica = data.cirghistclinica;
	fechaIngreso = data.cirgfechaingreso;
	horaIngreso = data.cirghoraingreso;
	
	f_fechaCarga = String(data.cirgfechaingreso).substr(6,2) + '/' + String(data.cirgfechaingreso).substr(4,2) + '/' + String(data.cirgfechaingreso).substr(0,4); 
	f_paciente = data.histcabapellnom;
	f_protocolo = data.cirgprotocolo;
	f_cobertura = data.obr_razonsoc;
	f_plan = data.histcabplanx;
	f_itvDesc = data.itv_descripcion;
	f_quirofano = data.cirgnroquirofa;
	f_histClinica = data.cirghistclinica;
	f_edad = globals.consulta_288_calcularEdad(data.histcabfechanac,data.cirgfechaingreso) + ' ' + globals.vTipoEdad;
	f_afiliado = data.histcabnrobenef;
	
	globals.consulta_288_txtDiagnostico = '';
	globals.consulta_288_txtDiagnostico = getTextProtAmbulatorio(historiaClinica,fechaIngreso,horaIngreso,1);
	globals.consulta_288_txtHemoterapia = null;
	globals.consulta_288_txtIntensificador = null;
	globals.consulta_288_txtMonitoreo = null;
	globals.consulta_288_txtEvaluacionAnestPost = null;
	globals.consulta_288_html_evalAnestPre = null;
	globals.consulta_288_html_escAlderete = null;
	globals.consulta_288_html_laboratorio = null;
	
	forms.consulta_288_tbl_estudios.elements.lblResultado.text = 'Resultado:'
	if(forms.consulta_288_tbl_estudios.foundset.getSize() > 0)
		forms.consulta_288_tbl_estudios.foundset.clear();
	 
	forms.consulta_288_tbl_medicamentos.elements.lblResultado.text = 'Resultado:'
	if(forms.consulta_288_tbl_medicamentos.foundset.getSize() > 0)
		forms.consulta_288_tbl_medicamentos.foundset.clear();
	
	/*
	globals.gbl_protocolo = f_protocolo;
	globals.gbl_historiaClinica = historiaClinica;
	globals.gbl_grupo = 1;
	mostrarEvaluacion();
	
	var sql2 = 'SELECT nom.Nome_Tipo, nom.Nome_Codigo, nom.Nome_Descr, prof.medperapeynom especialista,cir.CiriPorcen_1'
		+ ' ,ayu_2.MedPerApeynom ayu2,cir.CiriPorcen_2, ayu_3.MedPerApeynom ayu3,cir.CiriPorcen_3,ayu_4.MedPerApeynom ayu4,cir.CiriPorcen_4'
		+ ' ,ayu_5.MedPerApeynom ayu5,cir.CiriPorcen_5, ayu_7.per_apelnom ayu7,cir.CiriPorcen_7,prof.medpertipoie'
		+ ' ,ayu_2.medpertipoie,ayu_3.medpertipoie,ayu_4.medpertipoie,ayu_5.medpertipoie'
		+ ' FROM tbc_cirugint_dtl cir'
		+ ' left join maestros.tbc_nomencla nom on nom.Nome_Codigo = cir.CiriCodNome and nom.Nome_Tipo = cir.CiriTipoNome'
		+ ' left join maestros.tbc_medicos_personal prof on prof.medpercod = cir.CiriCodMed_1'
		+ ' left join maestros.tbc_medicos_personal ayu_2 on ayu_2.MedPerCod = cir.CiriCodMed_2'
		+ ' left join maestros.tbc_medicos_personal ayu_3 on ayu_3.MedPerCod = cir.CiriCodMed_3'
		+ ' left join maestros.tbc_medicos_personal ayu_4 on ayu_4.MedPerCod = cir.CiriCodMed_4'
		+ ' left join maestros.tbc_medicos_personal ayu_5 on ayu_5.MedPerCod = cir.CiriCodMed_5'
		+ ' left join validalegajo.tbc_personal_login ayu_7 on ayu_7.per_legajo = cir.CiriCodMed_7'
		+ ' WHERE CiriCodNome <> 0 and CiriTipoNome <> 0'
		+ ' AND CiriHistCl = ' + historiaClinica
		+ ' AND CiriProtocolo = ' + f_protocolo;
		
		dsIntervencion = databaseManager.getDataSetByQuery('asistencial',sql2,null,-1);
		indexTotal = dsIntervencion.getMaxRowIndex();
		
		loadIntervencion(1);
		elements.tabs.tabIndex = 1;*/
	
	var sql2 = 'SELECT vcir.VcirTipoNome,vcir.VcirCodNome,nom.Nome_Descr\
				,prof.medperapeynom especialista,vcir.VcirTipEspec,vcir.VcirPorEspec\
				,ayu_1.MedPerApeynom ayu1,vcir.VcirTipAyud1,vcir.VcirPorAyud1\
				,ayu_2.MedPerApeynom ayu2,vcir.VcirTipAyud2,vcir.VcirPorAyud2\
				,aneste.MedPerApeynom aneste,vcir.VcirTipAneste,vcir.VcirPorAneste\
				,instru.per_apelnom instru,vcir.VcirTipInstru,vcir.VcirPorInstru\
				FROM tbc_val_ciru vcir\
				left join maestros.tbc_nomencla nom on nom.Nome_Codigo = vcir.VcirCodNome and nom.Nome_Tipo = vcir.VcirTipoNome\
				left join maestros.tbc_medicos_personal prof on prof.medpercod = vcir.VcirCodEspec\
				left join maestros.tbc_medicos_personal ayu_1 on ayu_1.MedPerCod = vcir.VcirCodAyud1\
				left join maestros.tbc_medicos_personal ayu_2 on ayu_2.MedPerCod = vcir.VcirCodAyud2\
				left join maestros.tbc_medicos_personal aneste on aneste.MedPerCod = vcir.VcirCodAneste\
				left join validalegajo.tbc_personal_login instru on instru.per_legajo = vcir.VcirCodInstru\
				WHERE vcir.VcirHistClinica = ' +  historiaClinica
				+ ' and vcir.VcirFechaIngreso = ' + data.cirgfechaingreso
				+ ' and vcir.VcirHoraIngreso = ' + data.cirghoraingreso;
	
	dsIntervencion = databaseManager.getDataSetByQuery('asistencial',sql2,null,-1);
	indexTotal = dsIntervencion.getMaxRowIndex();
	
	loadIntervencion(1);
	elements.tabs.tabIndex = 1
}

/**
 * @properties={typeid:24,uuid:"8C1BD305-5094-42FC-9EBA-5BBF98EFA936"}
 */
function loadIntervencion(fila) {
	
	if(dsIntervencion.getMaxRowIndex() > 0){		
		
		limpiarIntervencionForm();
		var code = dsIntervencion.getValue(fila,1);
		if(String(dsIntervencion.getValue(fila,1)).length < 10){
			code =  '0' + dsIntervencion.getValue(fila,1);
		}
		
		var codeNom = String(dsIntervencion.getValue(fila,2));
		if(codeNom.length == 5){
			code += ' 0' + codeNom.substr(0,1) + '.' + codeNom.substr(1,2) + '.' + codeNom.substr(3,2);
		}
		else{
			code += ' ' + codeNom.substr(0,2) + '.' + codeNom.substr(2,2) + '.' + codeNom.substr(4,2);
		}
		
		f_codigo = code;
		f_intervencion = dsIntervencion.getValue(fila,3);
		
		f_especialista = dsIntervencion.getValue(fila,4);
		f_especialista_cont = application.getValueListDisplayValue('vl_tipo_medico', dsIntervencion.getValue(fila,5));
		f_especialista_hon = formatearHonorario(dsIntervencion.getValue(fila,6));
		
		
		f_ayudante_1 = dsIntervencion.getValue(fila,7);
		f_ayudante_1_cont = application.getValueListDisplayValue('vl_tipo_medico', dsIntervencion.getValue(fila,8));
		f_ayudante_1_hon = formatearHonorario(dsIntervencion.getValue(fila,9));
		
		
		f_ayudante_2 = dsIntervencion.getValue(fila,10);
		f_ayudante_2_cont = application.getValueListDisplayValue('vl_tipo_medico', dsIntervencion.getValue(fila,11));
		f_ayudante_2_hon = formatearHonorario(dsIntervencion.getValue(fila,12));
		
		
		//f_ayudante_3 = dsIntervencion.getValue(fila,10);
		//f_ayudante_3_cont = application.getValueListDisplayValue('vl_tipo_medico', dsIntervencion.getValue(fila,19));
		//f_ayudante_3_hon = formatearHonorario(dsIntervencion.getValue(fila,11));
		
		
		f_anestesista = dsIntervencion.getValue(fila,13);
		f_anestesista_cont = application.getValueListDisplayValue('vl_tipo_medico', dsIntervencion.getValue(fila,14));
		f_anestesista_hon = formatearHonorario(dsIntervencion.getValue(fila,15));
		
		
		f_instrumentista = dsIntervencion.getValue(fila,16);
		f_anestesista_cont = application.getValueListDisplayValue('vl_tipo_medico', dsIntervencion.getValue(fila,17));
		f_instrumentista_hon = formatearHonorario(dsIntervencion.getValue(fila,18));
		
		indexActual = fila;
		elements.lbl_posicion.text = indexActual + ' de ' + indexTotal;		
	}
	
}

/**
 * Perform the element default action.
 *
 * @param {JSEvent} event the event that triggered the action
 *
 * @properties={typeid:24,uuid:"CF163EFB-22D2-443E-B79F-41973682480E"}
 */
function onAction_siguiente(event) {
	
	var indexNext = indexActual + 1;
	
	if( indexNext <= indexTotal ){
		loadIntervencion(indexNext);
	}
}

/**
 * @private
 * @properties={typeid:24,uuid:"CAAFE1EB-83F4-4151-9318-ADCE5847D96C"}
 */
function limpiarIntervencionForm() {
	
	f_anestesista = '';
	f_anestesista_hon = '';
	f_anestesista_cont = '';
	f_ayudante_1 = '';
	f_ayudante_1_hon = '';
	f_ayudante_1_cont = '';
	f_ayudante_2 = '';
	f_ayudante_2_hon = '';
	f_ayudante_2_cont = '';
	f_ayudante_3 = '';
	f_ayudante_3_hon = '';
	f_ayudante_3_cont = '';
	f_codigo = '';
	f_especialista = '';
	f_especialista_hon = '';
	f_especialista_cont = '';
	f_instrumentista = '';
	f_instrumentista_hon = '';
	f_instrumentista_cont = '';
	f_intervencion = '';	
}

/**
 * Perform the element default action.
 *
 * @param {JSEvent} event the event that triggered the action
 *
 * @properties={typeid:24,uuid:"E0393C47-E94A-4794-9F85-579FC6BF7184"}
 */
function onAction_anterior(event) {
	
	var indexPrevious = indexActual - 1;
	
	if(indexPrevious > 0){
		loadIntervencion(indexPrevious);
	}
}

/**
 * @properties={typeid:24,uuid:"D6932BF1-28B3-4E60-99D9-C2F49F311511"}
 */
function formatearHonorario(valor) {
	if(valor == 0.0)
		return valor ='';
	else
		return '%' + ' ' + valor;
}

/**
 * @properties={typeid:24,uuid:"E8F64AEF-5A36-4F56-BD70-7887C943388A"}
 */
function mostrarEvaluacion() {
		
	var names_campo = new Array();
	names_campo[0] = "anestxt_protocolo";
	names_campo[1] = "anestxt_grupo";
	names_campo[2] = "anestxt_nro1";
	names_campo[3] = "anestxt_secuen";
	names_campo[4] = "anestxt_linea";
	names_campo[5] = "anestxt_tope";
	names_campo[6] = "anestxt_filler";
	
	formatearEvaluacion(names_campo, 'tbc_aneste_txt_to_tbc_aneste_txt', 'gbl_evaluacionText')
}

/**
 * @properties={typeid:24,uuid:"5C2C8ED4-17BE-4E39-8836-E18A7037CA80"}
 */
function formatearEvaluacion(names, relacion, campo) {
	
	var name = new Array()
	name = names;
	var filas = foundset[relacion].getSize()
	globals[campo] = '';
	if (filas > 0)
	{
		foundset[relacion].sort('anestxt_protocolo asc, anestxt_grupo asc, anestxt_nro1 asc, anestxt_secuen asc')
		
		foundset[relacion].setSelectedIndex(1)
	    globals[campo] = foundset[relacion][name[4]];
		
		for (var j=2;j<filas+1;j++)
 		{
			foundset[relacion].setSelectedIndex(j)
			
			if (globals.txt_1 < 77200){
			    globals[campo] = globals[campo] + "\n" + foundset[relacion][name[4]];
			}
			else{
			    globals[campo] = globals[campo] + foundset[relacion][name[4]];
			    
			}    
		}
	}
	
}

/**
 * Callback method when the user changes tab in a tab panel or divider position in split pane.
 *
 * @param {Number} previousIndex index of tab shown before the change
 * @param {JSEvent} event the event that triggered the action
 *
 * @properties={typeid:24,uuid:"FCB93350-FA78-4B50-82DE-92D00C51AC83"}
 */
function onTabChange_cargarDatos(previousIndex, event) {
		
	switch(elements.tabs.tabIndex){
		case 1: 		
			break;
		case 2:
			if(globals.consulta_288_txtHemoterapia == null)
				globals.consulta_288_txtHemoterapia = getTextProtAmbulatorio(historiaClinica,fechaIngreso,horaIngreso,2);
			break;
		case 3:
			if(globals.consulta_288_txtMonitoreo == null)
				globals.consulta_288_txtMonitoreo = getTextProtAmbulatorio(historiaClinica,fechaIngreso,horaIngreso,3);
		
			break;
		case 4:
			if(forms.consulta_288_tbl_estudios.foundset.getSize() == 0)
				cargarEstudios();
			else
				forms.consulta_288_tbl_estudios.elements.nomenclador.requestFocus();
			break;
		case 5:
			if(forms.consulta_288_tbl_medicamentos.foundset.getSize() == 0)
				cargarMedicamentos();
			else
				forms.consulta_288_tbl_medicamentos.elements.nomenclador.requestFocus();
		break;
		case 6:
			if(globals.consulta_288_txtIntensificador == null)
				globals.consulta_288_txtIntensificador = getTextProtAmbulatorio(historiaClinica,fechaIngreso,horaIngreso,6);
		break;
		case 7:
			if(globals.consulta_288_html_evalAnestPre == null)
				cargarAnestesia();
		break;
		default:		
			break;
	}
}

/**
 * Handle hide window.
 *
 * @param {JSEvent} event the event that triggered the action
 *
 * @returns {Boolean}
 *
 * @properties={typeid:24,uuid:"DAB5E549-A781-4FEC-A99E-DDDD4322AF18"}
 */
function onHide_protocoloDetalle(event) {
	if(f_cerrarForm){
		var $win = application.getWindow(application.getActiveWindow().getName());
		if($win != null){
			$win.hide();
			$win.destroy();
		}
	}
	return f_cerrarForm;
}

/**
 * Perform the element default action.
 *
 * @param {JSEvent} event the event that triggered the action
 *
 * @properties={typeid:24,uuid:"80AC946E-CCD6-4747-8C3B-8EC38D9195A0"}
 */
function onAction_Cerrar(event) {
	f_cerrarForm = true;
	onHide_protocoloDetalle(event);
}

/**
 * @properties={typeid:24,uuid:"BDCE452D-5954-4940-A316-218D832CA130"}
 */
function getTextProtAmbulatorio(hist_Clinica,fecha_Ingreso,hora_Ingreso,grupo) {
	var text = '';
	
	var sql = 'select Proalinea from tbc_proamb_t\
	where ProaSecuencia > 0'
	+ ' and ProaFechaIngreso = ' + fecha_Ingreso
	+ ' and ProaHistClinica = ' + hist_Clinica
	+ ' and ProaHoraIngreso = ' + hora_Ingreso
	+ ' and ProaGrupo = ' + grupo 
	+ ' order by ProaSecuencia';
	
	var ds = databaseManager.getDataSetByQuery('asistencial',sql,null,-1);
	var i;
	var maxRow = ds.getMaxRowIndex();
	if(maxRow > 0){
		for(i=1; i<= maxRow; i++){
			text += utils.stringTrim(ds.getValue(i,1));
		}
	}
	
	return text; 
}

/**

 * @private
 *
 * @properties={typeid:24,uuid:"51351155-7AF0-46F4-8E13-03E60736B29C"}
 */
function cargarEstudios() {
	
	var sql = 'select nom.Nome_Tipo as tipo,nom.Nome_Codigo as nomenclador,nom.Nome_Descr as descripcion\
	,pg.PregCantidad as cantidad\
	from tbc_guardia g\
	inner join tbc_prest_guar pg on pg.PregHistClinica =  g.Guar_HistClinica and pg.PregFechaIngreso = g.Guar_FechaIngreso and pg.PregHoraIngreso = g.Guar_HoraIngreso\
	left join maestros.tbc_nomencla nom on nom.Nome_Codigo = pg.PregCodNome and nom.Nome_Tipo = pg.PregTipoNome\
	where (pg.PregTipoPrest = 7 or g.Guar_Especialidad  = 5)'
	+ ' and (pg.PregTipoPrest <> 1 and pg.PregTipoPrest<>3 and pg.PregTipoPrest<>98 and pg.PregTipoPrest<>99)'
	+ ' and g.Guar_HistClinica = ' + historiaClinica
	+ ' and g.Guar_FechaIngreso = ' + fechaIngreso
	+ ' and g.Guar_HoraIngreso = ' +  horaIngreso;

	var ds = databaseManager.getDataSetByQuery('asistencial',sql,null,-1);
	var i;
	var maxRow = ds.getMaxRowIndex();
	if(maxRow > 0){
		for(i=1; i<= maxRow; i++){
			
			var tipo = ds.getValue(i,1);
			if( tipo < 10){
				ds.setValue(i,1,'0' + tipo);
			}
			
			var code = formatearNomenclador(String(ds.getValue(i,2)));
			ds.setValue(i,2,code);
		}
		
		var frm = solutionModel.getForm('consulta_288_tbl_estudios');
		var tipos = [JSColumn.TEXT,JSColumn.TEXT,JSColumn.TEXT,JSColumn.INTEGER];
		frm.dataSource = ds.createDataSource('consulta_288_tbl_estudios', tipos);

		forms.consulta_288_tbl_estudios.controller.recreateUI();
		forms.consulta_288_tbl_estudios.elements.lblResultado.text = 'Resultado: ' + maxRow + ' items';
		forms.consulta_288_tbl_estudios.elements.nomenclador.requestFocus();
	}
	else
		forms.consulta_288_tbl_estudios.elements.lblResultado.text = 'Resultado:';
		
}

/**

 * @private
 *
 * @properties={typeid:24,uuid:"8AC07B60-E35B-45D0-A9D2-9F7F7737DC9B"}
 */
function cargarMedicamentos() {
	
	var sql = 'select pg.PregTipoNome,pg.PregCodNome as nomenclador,ar.art_descrip as descripcion,pg.PregCantidad as cantidad,ar.art_presenta as presenta\
		from tbc_prest_guar pg\
		left join maestros.tbc_articulos ar on ar.art_codigo = pg.PregCodNome\
		where pg.PregTipoPrest = 98 and	pg.PregTipoNome = 99'
		+ ' and pg.PregHistClinica = ' + historiaClinica
		+ ' and pg.PregFechaIngreso = ' + fechaIngreso
		+ ' and pg.PregHoraIngreso = ' +  horaIngreso;

		var ds = databaseManager.getDataSetByQuery('asistencial',sql,null,-1);
		var maxRow = ds.getMaxRowIndex();
		if(maxRow > 0){
			var frm = solutionModel.getForm('consulta_288_tbl_medicamentos');
			var tipos = [JSColumn.TEXT,JSColumn.TEXT,JSColumn.TEXT,JSColumn.INTEGER,JSColumn.TEXT];
			frm.dataSource = ds.createDataSource('consulta_288_tbl_medicamentos', tipos);

			forms.consulta_288_tbl_medicamentos.controller.recreateUI();
			forms.consulta_288_tbl_medicamentos.elements.lblResultado.text = 'Resultado: ' + maxRow + ' items';
			forms.consulta_288_tbl_medicamentos.elements.nomenclador.requestFocus();
		}
		else
			forms.consulta_288_tbl_medicamentos.elements.lblResultado.text = 'Resultado:';
}

/**

 * @private
 * @param {string} codeNom
 * @properties={typeid:24,uuid:"B875368C-BDAF-4116-9131-83A0820ADAB8"}
 */
function formatearNomenclador(codeNom) {
	var nomenclador = codeNom;
	
	if(codeNom.length == 4){
		nomenclador = '  ' + codeNom.substr(0,2) + '.' + codeNom.substr(2,2);
	}
	
	if(codeNom.toString().length == 5){
		nomenclador = '  0' + codeNom.substr(0,1) + '.' + codeNom.substr(1,2) + '.' + codeNom.substr(3,2);
	}
	
	if(codeNom.toString().length == 6){
		nomenclador = '  ' + codeNom.substr(0,2) + '.' + codeNom.substr(2,2) + '.' + codeNom.substr(4,2);
	}
		
	return nomenclador; 	
}

/**

 * @private
 *
 * @properties={typeid:24,uuid:"E4013677-1C9F-4FD0-9D27-5AD8C63978DF"}
 * @AllowToRunInFind
 */
function cargarAnestesia() {

	var fs = databaseManager.getFoundSet("asistencial",'tbc_anes_ambu');
	fs.find();
	fs['anestippac']=1;
	fs['aneshc'] = utils.stringToNumber(historiaClinica); 
	fs['anesfecingreso'] = utils.stringToNumber(fechaIngreso);
	fs['aneshoraingreso']= utils.stringToNumber(horaIngreso);
	fs.search();

	if(fs.getSize()>0){
		
		var texto = '';
		var valor
		var i;
		// carga de comentarios
		for(i=1;i<=10;i++){
			valor = utils.stringTrim(fs['anescoment_' + i]);
			
			if(valor.length > 0){
				if(texto.length == 0)
					texto += valor;
				else
					texto += '\n' + valor;
			}	
		}
		globals.consulta_288_txtAnestesiaComent = texto;
		
		// Carga de medicamentos de anestesia
		texto = '';
		valor = '';
		for(i=1;i<=10;i++){
			valor = utils.stringTrim(fs['anesmedctos_' + i]);
			
			if(valor.length > 0){
				if(texto.length == 0)
					texto += valor;
				else
					texto += '\n' + valor;
			}
		}
		globals.consulta_288_anestesiaMedic = texto;
		
		// Carga de evaluacion anestesica post-quirurgica
		if(globals.consulta_288_txtEvaluacionAnestPost == null)
			globals.consulta_288_txtEvaluacionAnestPost = getTextProtAmbulatorio(historiaClinica,fechaIngreso,horaIngreso,7);
		
		// Carga de evaluacion anestesica pre-quirurgica
		if(globals.consulta_288_html_evalAnestPre == null){
			
			var vector = new Array();
			var html = '';
			globals.consulta_288_html_evalAnestPre += '<html><body>';
		
			html=''
			//build a table for the addresses
			html += '<table width=100% cellpadding=1 cellspacing=0>'
				
			//1 Gastro Vascular
			vector = fs['ele1_1'];
			html += '<tr bgcolor="#cccccc">'
			html += '<td colspan="4" height=20>&nbsp;&nbsp;CARDIOVASCULAR</td>'
			html += '<td></td>'
			html += '<td></td>'
			html += '<td></td>'
			html += '</tr>'
			//fila 1
			html += '<tr>'
			html += '<td valign="top">I.M.</td>'
			html += '<td>' + getCodigoCardioVascular_1(vector[0]) + '</td>'
			html += '<td valign="top">I.C.C. Controlada</td>'
			html += '<td>' + getSI_NO(vector[9]) + '</td>'
			html += '</tr>'
			//fila 2
			html += '<tr>'
			html += '<td valign="top">H.T.A.</td>'
			html += '<td>' + getSI_NO(vector[1]) + '</td>'
			html += '<td valign="top">I.C.C. No Controlada</td>'
			html += '<td>' + getSI_NO(vector[10]) + '</td>'
			html += '</tr>'
			//fila 3
			html += '<tr>'
			html += '<td valign="top">H.I.V.</td>'
			html += '<td>'+ getSI_NO(vector[2]) + '</td>'
			html += '<td valign="top">Enf. Valvular Card.</td>'
			html += '<td>' + getSI_NO(vector[11]) + '</td>'
			html += '</tr>'
			//fila 4
			html += '<tr>'
			html += '<td valign="top">Arritmia que req. Ttto</td>'
			html += '<td>'+ getSI_NO(vector[3]) + '</td>'
			html += '<td valign="top">Angioplastia Anterior</td>'
			html += '<td>' + getCodigoCardioVascular_13(vector[12]) + '</td>'
			html += '</tr>'
			//fila 5
			html += '<tr>'
			html += '<td valign="top"> B. Bloqueantes</td>'
			html += '<td>' + getSI_NO(vector[4]) + '</td>'
			html += '<td valign="top">Cirug&#237;a Card. Anterior</td>'
			html += '<td>' + getCodigoCardioVascular_13(vector[13]) + '</td>'
			html += '</tr>'
			//fila 6
			html += '<tr>'
			html += '<td valign="top">Bloqueantes Canal del Ca</td>'
			html += '<td>' + getSI_NO(vector[5]) + '</td>'
			html += '<td valign="top">Enf. Card. Congenica</td>'
			html += '<td>' + getSI_NO(vector[14]) + '</td>'
			//fila7
			html += '<tr>'
			html += '<td valign="top">Marcapaso</td>'
			html += '<td>' + getSI_NO(vector[6]) + '</td>'
			html += '<td valign="top">E.C.G.</td>'
			html += '<td>' + getSI_NO(vector[15]) + '</td>'
			html += '</tr>'
			//fila8
			html += '<tr>'
			html += '<td valign="top">Angina con Actividad</td>'
			html += '<td>' + getSI_NO(vector[7]) + '</td>'
			html += '<td valign="top">Riesgo Cardiov. Habitual</td>'
			html += '<td>' + getCodigoCardioVascular_17(vector[16]) + '</td>'
			html += '</tr>'
			//fila9
			html += '<tr>'
			html += '<td valign="top">Angina en Reposo</td>'
			html += '<td>' + getSI_NO(vector[8]) + ' </td>'
			html += '</tr>'
				
			//2 Gastro Intestinal
			vector = fs['ele1_2'];
			html += '<tr bgcolor="#cccccc">'
			html += '<td colspan="4" height=20>&nbsp;&nbsp;GASTROINTESTINAL</td>'
			html += '</tr>'
			//fila 1
			html += '<tr>'
			html += '<td valign="top">Obesidad Morbida</td>'
			html += '<td>' + getSI_NO(vector[0]) + '</td>'
			html += '<td valign="top">Obstrucci&#243;n Intestinal</td>'
			html += '<td>' + getSI_NO(vector[3]) + '</td>'
			html += '</tr>'
			//fila 2
			html += '<tr>'
			html += '<td valign="top">Reflujo Gastroesofagico</td>'
			html += '<td>' + getSI_NO(vector[1]) + '</td>'
			html += '<td valign="top">Disfagia</td>'
			html += '<td>' + getSI_NO(vector[4]) + '</td>'
			html += '</tr>'
			//fila 3
			html += '<tr>'
			html += '<td valign="top">Hernia de Hiatus</td>'
			html += '<td>' + getSI_NO(vector[2]) + '</td>'
			
			html += '</tr>'
			//3 Dificultad Anestesica
			vector = fs['ele1_3'];
			html += '<tr bgcolor="#cccccc">'
			html += '<td colspan="4" height=20>&nbsp;&nbsp;DIFICULTAD ANESTESICA</td>'
			html += '</tr>'
			//fila 1
			html += '<tr>'
			html += '<td valign="top">Intubaci&#243;n Dificultosa</td>'
			html += '<td>' + getSI_NO(vector[0]) + '</td>'
			html += '<td valign="top">Estenosis Subglotica</td>'
			html += '<td>' + getSI_NO(vector[2]) + '</td>'
			html += '</tr>'
			//fila 2
			html += '<tr>'
			html += '<td valign="top">Hist. Fliar. Hiperten. Maligna</td>'
			html += '<td>' + getSI_NO(vector[1]) + '</td>'
			html += '<td valign="top">Paro Card&#237;aco</td>'
			html += '<td>' + getSI_NO(vector[3]) + '</td>'
			html += '</tr>'
				
			//4 Hepatico
			vector = fs['ele1_4'];
			html += '<tr bgcolor="#cccccc">'
			html += '<td colspan="4" height=20>&nbsp;&nbsp;HEPATICO</td>'
			html += '</tr>'
			//fila 1
			html += '<tr>'
			html += '<td valign="top">Enzimas Elevadas</td>'
			html += '<td>' + getSI_NO(vector[0]) + '</td>'
			html += '<td valign="top">Ascitis</td>'
			html += '<td>' + getSI_NO(vector[2]) + '</td>'
			html += '</tr>'
			//fila 2
			html += '<tr>'
			html += '<td valign="top">Hictericia</td>'
			html += '<td>' + getSI_NO(vector[1]) + '</td>'
			html += '</tr>'
			
			//5 Pulmonar
			vector = fs['ele1_5'];
			html += '<tr bgcolor="#cccccc">'
			html += '<td colspan="4" height=20>&nbsp;&nbsp;PULMONAR</td>'
			html += '</tr>'
			//fila 1
			html += '<tr>'
			html += '<td valign="top">Antecedentes de Fumador</td>'
			html += '<td>' + getCodigoPulmonar_1(vector[0]) + '</td>'
			html += '<td valign="top">E.P.O.C.</td>'
			html += '<td>' + getSI_NO(vector[3]) + '</td>'
			html += '</tr>'
			//fila 2
			html += '<tr>'
			html += '<td valign="top">Dejo de Fumar</td>'
			html += '<td>' + getCodigoCardioVascular_13(vector[1]) + '</td>'
			html += '<td valign="top">Embolismo Pulmonar</td>'
			html += '<td>' + getSI_NO(vector[4]) + '</td>'
			html += '</tr>'
			//fila 3
			html += '<tr>'
			html += '<td valign="top">Asma Bronquial</td>'
			html += '<td>' + getSI_NO(vector[2]) + '</td>'
			html += '<td valign="top">Traqueostom&#237;a</td>'
			html += '<td>' + getSI_NO(vector[5]) + '</td>'
			html += '</tr>'
			
			//6 Neurologico
			vector = fs['ele1_6'];
			html += '<tr bgcolor="#cccccc">'
			html += '<td colspan="4" height=20>&nbsp;&nbsp;NEUROLOGICO</td>'
			html += '</tr>'
			//fila 1
			html += '<tr>'
			html += '<td valign="top">Trastorno Convulsivo</td>'
			html += '<td>' + getSI_NO(vector[0]) + '</td>'
			html += '<td valign="top">Neuropat&#237;a Perif&#233;rica</td>'
			html += '<td>' + getSI_NO(vector[5]) + '</td>'
			html += '</tr>'
			//fila 2
			html += '<tr>'
			html += '<td valign="top">P.I.C. Elevada</td>'
			html += '<td>' + getSI_NO(vector[1]) + '</td>'
			html += '<td valign="top">Hidrocefalia</td>'
			html += '<td>' + getSI_NO(vector[6]) + '</td>'
			html += '</tr>'
			//fila 3
			html += '<tr>'
			html += '<td valign="top">Enfermedad Cerebrovascular</td>'
			html += '<td>' + getSI_NO(vector[2]) + '</td>'
			html += '<td valign="top">Retardo Mental</td>'
			html += '<td>' + getSI_NO(vector[7]) + '</td>'
			html += '</tr>'
			//fila 4
			html += '<tr>'
			html += '<td valign="top">Lesion Medula Espinal</td>'
			html += '<td>' + getSI_NO(vector[3]) + '</td>'
			html += '<td valign="top">S&#237;ndrome Depresivo</td>'
			html += '<td>' + getSI_NO(vector[8]) + '</td>'
			html += '</tr>'
			//fila 5
			html += '<tr>'
			html += '<td valign="top">Enfermedad Neuromuscular</td>'
			html += '<td>' + getSI_NO(vector[4]) + '</td>'
			html += '</tr>'
				
			//7 Endocrinos
			vector = fs['ele1_7'];
			html += '<tr bgcolor="#cccccc">'
			html += '<td colspan="4" height=20>&nbsp;&nbsp;ENDOCRINOS</td>'
			html += '</tr>'
			//fila 1
			html += '<tr>'
			html += '<td valign="top">Diabetes</td>'
			html += '<td>' + getCodigoEndocrinos_1(vector[0]) + '</td>'
			html += '<td valign="top">Ttto. Esteroide</td>'
			html += '<td>' + getSI_NO(vector[3]) + '</td>'
			html += '</tr>'
			//fila 2
			html += '<tr>'
			html += '<td valign="top">Hipertiroidismo</td>'
			html += '<td>' + getSI_NO(vector[1]) + '</td>'
			html += '<td valign="top">Anticonceptivos Orales</td>'
			html += '<td>' + getSI_NO(vector[4]) + '</td>'
			html += '</tr>'
			//fila 3
			html += '<tr>'
			html += '<td valign="top">Hipotiroidismo</td>'
			html += '<td>' + getSI_NO(vector[2]) + '</td>'
			html += '</tr>'
				
			//8 Actividades Diarias
			vector = fs['ele1_8'];
			html += '<tr bgcolor="#cccccc">'
			html += '<td colspan="4" height=20>&nbsp;&nbsp;ACTIVIDADES DIARIAS</td>'
			html += '</tr>'
			//fila 1
			html += '<tr>'
			html += '<td valign="top">Reposo Obligado</td>'
			html += '<td>' + getSI_NO(vector[0]) + '</td>'
			html += '<td valign="top">Dolor Cr&#243;nico</td>'
			html += '<td>' + getSI_NO(vector[3]) + '</td>'
			html += '</tr>'
			//fila 2
			html += '<tr>'
			html += '<td valign="top">Capaz Realiz. Ejercicios</td>'
			html += '<td>' + getSI_NO(vector[1]) + '</td>'
			html += '<td valign="top">Sordo</td>'
			html += '<td>' + getSI_NO(vector[4]) + '</td>'
			html += '</tr>'
			//fila 3
			html += '<tr>'
			html += '<td valign="top">Caquetico</td>'
			html += '<td>' + getSI_NO(vector[2]) + '</td>'
			html += '<td valign="top">Ciego</td>'
			html += '<td>' + getSI_NO(vector[5]) + '</td>'
			html += '</tr>'
				
			//9 Uso de drogas
			vector = fs['ele1_9'];
			html += '<tr bgcolor="#cccccc">'
			html += '<td colspan="4" height=20>&nbsp;&nbsp;USO DE DROGAS</td>'
			html += '</tr>'
			//fila 1
			html += '<tr>'
			html += '<td valign="top">Alcohol</td>'
			html += '<td>' + getCodigoUsoGrogas_1(vector[0]) + '</td>'
			html += '<td valign="top">Otras</td>'
			html += '<td>' + getSI_NO(vector[2]) + '</td>'
			html += '</tr>'
			//fila 2
			html += '<tr>'
			html += '<td valign="top">Coca&#237;na</td>'
			html += '<td>' + getSI_NO(vector[1]) + '</td>'
			html += '</tr>'
				
			//10 clasificacion A.S.A.
			vector = fs['ele1_10'];
			html += '<tr bgcolor="#cccccc">'
			html += '<td colspan="4" height=20>&nbsp;&nbsp;CLASIFICACION A.S.A.</td>'
			html += '</tr>'
			//fila 1
			html += '<tr>'
			html += '<td valign="top"></td>'
			html += '<td>' + getCodigoClasificacionASA_1(vector[0]) + '</td>'
			html += '</tr>'
				
			//11 Pediatrico
			vector = fs['ele1_11'];
			html += '<tr bgcolor="#cccccc">'
			html += '<td colspan="4" height=20>&nbsp;&nbsp;PEDIATRICO</td>'
			html += '</tr>'
			//fila 1
			html += '<tr>'
			html += '<td valign="top">Prematuro</td>'
			html += '<td>' + getSI_NO(vector[0]) + '</td>'
			html += '<td valign="top">Par&#225;lisis Cerebral</td>'
			html += '<td>' + getSI_NO(vector[2]) + '</td>'
			html += '</tr>'
			//fila 2
			html += '<tr>'
			html += '<td valign="top">Anomalia Congenita</td>'
			html += '<td>' + getSI_NO(vector[1]) + '</td>'
			html += '</tr>'
				
			//12 Obstetricos
			vector = fs['ele1_12'];
			html += '<tr bgcolor="#cccccc">'
			html += '<td colspan="4" height=20>&nbsp;&nbsp;OBSTETRICOS</td>'
			html += '</tr>'
			//fila 1
			html += '<tr>'
			html += '<td valign="top">Preeclampsia/Eclampsia</td>'
			html += '<td>' + getSI_NO(vector[0]) + '</td>'
			html += '<td valign="top">Embarazo</td>'
			html += '<td>' + getCodigoObstetrico_3(vector[2]) + '</td>'
			html += '</tr>'
			//fila 2
			html += '<tr>'
			html += '<td valign="top">Placenta Previa</td>'
			html += '<td>' + getSI_NO(vector[1]) + '</td>'
			html += '</tr>'	
				
			//13 Renal 
			vector = fs['ele1_13'];
			html += '<tr bgcolor="#cccccc">'
			html += '<td colspan="4" height=20>&nbsp;&nbsp;RENAL</td>'
			html += '</tr>'
			//fila 1
			html += '<tr>'
			html += '<td valign="top">Insuficiencia Renal</td>'
			html += '<td>' + getSI_NO(vector[0]) + '</td>'
			html += '<td valign="top">Hemodi&#225;lisis</td>'
			html += '<td>' + getSI_NO(vector[2]) + '</td>'
			html += '</tr>'
			//fila 2
			html += '<tr>'
			html += '<td valign="top">Falla Renal</td>'
			html += '<td>' + getSI_NO(vector[1]) + '</td>'
			html += '<td valign="top">Di&#225;lisis Peritoneal</td>'
			html += '<td>' + getSI_NO(vector[3]) + '</td>'
			html += '</tr>'
				
			//14 Infecciosas
			vector = fs['ele1_14'];
			html += '<tr bgcolor="#cccccc">'
			html += '<td colspan="4" height=20>&nbsp;&nbsp;INFECCIOSAS</td>'
			html += '</tr>'
			//fila 1
			html += '<tr>'
			html += '<td valign="top">S&#237;ndrome de Sepsis</td>'
			html += '<td>' + getSI_NO(vector[0]) + '</td>'
			html += '<td valign="top">Renal en las Ultimas 4 Semanas</td>'
			html += '<td>' + getSI_NO(vector[3]) + '</td>'
			html += '</tr>'
			//fila 2
			html += '<tr>'
			html += '<td valign="top">Hepatitis Activa</td>'
			html += '<td>' + getSI_NO(vector[1]) + '</td>'
			html += '<td valign="top">TBC. Activa</td>'
			html += '<td>' + getSI_NO(vector[4]) + '</td>'
			html += '</tr>'
			//fila 3
			html += '<tr>'
			html += '<td valign="top">A.I.D.S.</td>'
			html += '<td>' + getSI_NO(vector[2]) + '</td>'	
			html += '</tr>'
				
			//15 Hematologico
			vector = fs['ele1_15'];
			html += '<tr bgcolor="#cccccc">'
			html += '<td colspan="4" height=20>&nbsp;&nbsp;HEMATOLOGICO</td>'
			html += '</tr>'
			//fila 1
			html += '<tr>'
			html += '<td valign="top">Transtorno en el Sangrado</td>'
			html += '<td>' + getSI_NO(vector[0]) + '</td>'
			html += '<td valign="top">Anticoagulantes</td>'
			html += '<td>' + getCodigoHematologico_4(vector[3]) + '</td>'
			html += '</tr>'
			//fila 2
			html += '<tr>'
			html += '<td valign="top">Trombocitopenia</td>'
			html += '<td>' + getSI_NO(vector[1]) + '</td>'
			html += '<td valign="top">Anemia Hgb. &#60; 10</td>'
			html += '<td>' + getSI_NO(vector[4]) + '</td>'
			html += '</tr>'
			//fila 3
			html += '<td valign="top">Plaquetopenia &#60; 100.000</td>'
			html += '<td>' + getSI_NO(vector[2]) + '</td>'
			html += '<td valign="top">Transfusi&#243;n sangu&#237;nea &#60; 3 meses</td>'
			html += '<td>' + getSI_NO(vector[5]) + '</td>'
			
			//16 Otros
			vector = fs['ele1_16'];
			html += '<tr bgcolor="#cccccc">'
			html += '<td colspan="4" height=20>&nbsp;&nbsp;OTROS</td>'
			html += '</tr>'
			//fila 1
			html += '<tr>'
			html += '<td valign="top">Testigo de Jehova</td>'
			html += '<td>' + getSI_NO(vector[0]) + '</td>'
			html += '<td valign="top">Quemaduras Mas de 20 %</td>'
			html += '<td>' + getSI_NO(vector[3]) + '</td>'
			html += '</tr>'
			//fila 2
			html += '<tr>'
			html += '<td valign="top">Negaci&#243;n Transfusi&#243;n de Sangre</td>'
			html += '<td>' + getSI_NO(vector[1]) + '</td>'
			html += '<td valign="top">U.C.I. Preoperatorio</td>'
			html += '<td>' + getSI_NO(vector[4]) + '</td>'
			html += '</tr>'
			//fila 3
			html += '<tr>'
			html += '<td valign="top">Donante Sangre Aut&#243;loga</td>'
			html += '<td>' + getSI_NO(vector[2]) + '</td>'
			html += '<td valign="top">Alergia</td>'
			html += '<td>' + getSI_NO(vector[5]) + '</td>'
			html += '</tr>'
			
			//17 Registros habituales
			vector = fs['ele1_17'];
			html += '<tr bgcolor="#cccccc">'
			html += '<td colspan="4" height=20>&nbsp;&nbsp;REGISTROS HABITUALES</td>'
			html += '</tr>'
			//fila 1
			html += '<tr>'
			html += '<td valign="top">Presi&#243;n Arterial [max 14 min 10]</td>'
			html += '<td>' + getCodigoRegistroHabitual_1(vector[0]) + '</td>'
			html += '<td valign="top">Lentes de Contacto</td>'
			html += '<td>' + getSI_NO(vector[2]) + '</td>'
			html += '<td valign="top"></td>'
			html += '<td></td>'
			html += '</tr>'
			//fila 2
			html += '<tr>'
			html += '<td valign="top">Pr&#243;tesis Dentales</td>'
			html += '<td>' + getSI_NO(vector[1]) + '</td>'
			html += '<td valign="top">Estado An&#237;mico</td>'
			html += '<td>' + getCodigoRegistroHabitual_4(vector[3]) + '</td>'
			html += '<td valign="top"></td>'
			html += '<td></td>'
			html += '</tr>'
			
			html += '</table><p>'
			
			globals.consulta_288_html_evalAnestPre += html;
				
			globals.consulta_288_html_evalAnestPre += '</body></html>'
		}
		
		// Carga de escala alderete
		if(globals.consulta_288_html_escAlderete == null){
			$_totalEscAlderete = 0;
			globals.consulta_288_html_escAlderete += '<html><body>';
			html = '';
			html += '<table width=100% cellpadding=1 cellspacing=0>'
			
			//fila 1
			html += '<tr>'
			html += '<td width=15% valign="top">ACTIVIDAD:</td>'
			html += '<td width=85%>' + getCodigoEscalaAlderete_1(fs['anesesca_1']) + '</td>'
			html += '</tr>'
			//fila 2
			html += '<tr>'
			html += '<td width=15% valign="top">RESPIRACION:</td>'
			html += '<td width=85%>' + getCodigoEscalaAlderete_2(fs['anesesca_2']) + '</td>'
			html += '</tr>'
			//fila 3
			html += '<tr>'
			html += '<td width=15% valign="top">CIRCULACION:</td>'
			html += '<td width=85%>' + getCodigoEscalaAlderete_3(fs['anesesca_3']) + '</td>'
			html += '</tr>'
			//fila 4
			html += '<tr>'
			html += '<td width=15% valign="top">CONCIENCIA:</td>'
			html += '<td width=85%>' + getCodigoEscalaAlderete_4(fs['anesesca_4']) + '</td>'
			html += '</tr>'
			//fila 5
			html += '<tr>'
			html += '<td width=15% valign="top">SATURACION:</td>'
			html += '<td width=85%>' + getCodigoEscalaAlderete_5(fs['anesesca_5']) + '</td>'
			html += '</tr>'
			//fila 6
			html += '<tr>'
			html += '<td width=15% valign="top">TOTAL:</td>'
			html += '<td width=85%>' + (($_totalEscAlderete> 0 )?$_totalEscAlderete + " puntos.":"") + '</td>'
			html += '</tr>'
	
			html += '</table><p>'
			globals.consulta_288_html_escAlderete += html;
			globals.consulta_288_html_escAlderete += '</body></html>'
		}
		
		// Carga de laboratorio
		if(globals.consulta_288_html_laboratorio == null){
			globals.consulta_288_html_laboratorio += '<html><body>';
			html = '';
			html += '<table width=100% cellpadding=1 cellspacing=0>'
			
			//fila 1
			html += '<tr>'
			html += '<td width=15% valign="top">G.R. .........................</td>'
			html += '<td width=85%>' + ((fs['anesgr'] == 0)?"-":fs['anesgr']) + '</td>'
			html += '</tr>'
			//fila 2
			html += '<tr>'
			html += '<td width=15% valign="top">G.B. .........................</td>'
			html += '<td width=85%>' + ((fs['anesgb']==0)?"-":fs['anesgb']) + '</td>'
			html += '</tr>'
			//fila 3
			html += '<tr>'
			html += '<td width=15% valign="top">H.T.O. .....................</td>'
			html += '<td width=85%>' + ((fs['aneshto']==0)?"-":fs['aneshto']) + '</td>'
			html += '</tr>'
			//fila 4
			html += '<tr>'
			html += '<td width=15% valign="top">H.B. .........................</td>'
			html += '<td width=85%>' + ((fs['aneshb']==0)?"-":fs['aneshb']) + '</td>'
			html += '</tr>'
			//fila 5
			html += '<tr>'
			html += '<td width=15% valign="top">Gluc. .......................</td>'
			html += '<td width=85%>' + ((fs['anesgluc']==0)?"-":fs['anesgluc']) + '</td>'
			html += '</tr>'
			//fila 6
			html += '<tr>'
			html += '<td width=15% valign="top">URREA ..................</td>'
			html += '<td width=85%>' + ((fs['anesurea']==0)?"-":fs['anesurea']) + '</td>'
			html += '</tr>'
			//fila 7
			html += '<tr>'
			html += '<td width=15% valign="top">Colinest. ................</td>'
			html += '<td width=85%>' + ((fs['anescolinest']==0)?"-":fs['anescolinest']) + '</td>'
			html += '</tr>'
			//fila 8
			html += '<tr>'
			html += '<td width=15% valign="top">KPTT ......................</td>'
			html += '<td width=85%>' + ((fs['aneskptt']==0)?"-":fs['aneskptt']) + '</td>'
			html += '</tr>'
			//fila 9
			html += '<tr>'
			html += '<td width=15% valign="top">TPO. PROT. ..........</td>'
			html += '<td width=85%>' + ((fs['anestpoprot']==0)?"-":fs['anestpoprot']) + '</td>'
			html += '</tr>'
			//fila 10
			html += '<tr>'
			html += '<td width=15% valign="top">Grupo .....................</td>'
			html += '<td width=85%>' + ((fs['anesgrupo']==0)?"-":fs['anesgrupo']) + '</td>'
			html += '</tr>'
			//fila 11
			html += '<tr>'
			html += '<td width=15% valign="top">Factor RH. .............</td>'
			html += '<td width=85%>' + ((fs['anesfactrh']==0)?"-":fs['anesfactrh']) + '</td>'
			html += '</tr>'
			//fila 12
			html += '<tr>'
			html += '<td width=15% valign="top">Otros .......................</td>'
			html += '<td width=85%>' + ((fs['anesotroslab']==0)?"-":fs['anesotroslab']) + '</td>'
			html += '</tr>'
			
			html += '</table><p>'
			globals.consulta_288_html_laboratorio += html;
			globals.consulta_288_html_laboratorio += '</body></html>'
		}
		
	}
}

/**
 * TODO generated, please specify type and doc for the params
 * @param code
 *
 * @properties={typeid:24,uuid:"AD19DA40-3BCF-462C-94C4-8B4514918B2C"}
 */
function getSI_NO(code){
	var texto = 'Si';
	
	if(utils.stringToNumber(code) == 0)
		texto = 'No';
	return texto;
}

/**
 * TODO generated, please specify type and doc for the params
 * @param code
 *
 * @properties={typeid:24,uuid:"4E0EC44D-F731-4C11-82B1-367ABF907520"}
 */
function getCodigoCardioVascular_1(code){
	var texto = '';
	switch(utils.stringToNumber(code)){
		case 0:
			texto = 'No';
			break;
		case 1:
			texto = '&#60; 3 Meses';
			break;
		case 2:
			texto = '3-6 Meses';
			break;
		case 3:
			texto = '&#62; 6 Meses';
			break;
		default:
			break;
	}
	return texto;
}

/**
 * TODO generated, please specify type and doc for the params
 * @param code
 *
 * @properties={typeid:24,uuid:"9F73B8E3-0B98-407D-825D-86E782FD0801"}
 */
function getCodigoCardioVascular_13(code){
	var texto = '';
	switch(utils.stringToNumber(code)){
		case 0:
			texto = 'No';
			break;
		case 1:
			texto = '&#60; 3 Meses';
			break;
		case 2:
			texto = '&#62; 6 Meses';
			break;
		default:
			break;
	}
	return texto;
}

/**
 * TODO generated, please specify type and doc for the params
 * @param code
 *
 * @properties={typeid:24,uuid:"6EBE472C-4F88-45E1-94ED-A536BA50E4CE"}
 */
function getCodigoCardioVascular_17(code){
	var texto = '';
	switch(utils.stringToNumber(code)){
		case 0:
			texto = 'No';
			break;
		case 1:
			texto = 'I - Habitual';
			break;
		case 2:
			texto = 'II';
			break;
		case 3:
			texto = 'III';
			break;
		case 4:
			texto = 'IV';
			break;
		default:
			break;
	}
	return texto;
}

/**
 * TODO generated, please specify type and doc for the params
 * @param code
 *
 * @properties={typeid:24,uuid:"699E4C96-0E28-48FB-AD8D-E7052E2867D8"}
 */
function getCodigoPulmonar_1(code){
	var texto = '';
	switch(utils.stringToNumber(code)){
		case 0:
			texto = 'No';
			break;
		case 1:
			texto = '&#60; 10 Años';
			break;
		case 2:
			texto = '10-20 Años';
			break;
		case 3:
			texto = '&#62; 20 Años';
			break;
		default:
			break;
	}
	return texto;
}

/**
 * TODO generated, please specify type and doc for the params
 * @param code
 *
 * @properties={typeid:24,uuid:"8F199BA2-439D-47C5-A32E-91E63AF45CF2"}
 */
function getCodigoEndocrinos_1(code){
	var texto = '';
	switch(utils.stringToNumber(code)){
		case 0:
			texto = 'No';
			break;
		case 1:
			texto = 'Insulina';
			break;
		case 2:
			texto = 'Hipog. Oral';
			break;
		default:
			break;
	}
	return texto;
}

/**
 * TODO generated, please specify type and doc for the params
 * @param code
 *
 * @properties={typeid:24,uuid:"18DBD1FE-08B9-4632-BF3D-E37F301ECBEA"}
 */
function getCodigoUsoGrogas_1(code){
	var texto = '';
	switch(utils.stringToNumber(code)){
		case 0:
			texto = 'No';
			break;
		case 1:
			texto = '&#60; 1 Toma/Dia';
			break;
		case 2:
			texto = '&#62; 2 Toma/Dia';
			break;
		default:
			break;
	}
	return texto;
}

/**
 * TODO generated, please specify type and doc for the params
 * @param code
 *
 * @properties={typeid:24,uuid:"8ADEABBF-BAB1-46ED-B48C-E9700F99B1D4"}
 */
function getCodigoClasificacionASA_1(code){
	var texto = '';
	switch(utils.stringToNumber(code)){
		case 0:
			texto = 'No';
			break;
		case 1:
			texto = 'I';
			break;
		case 2:
			texto = 'II';
			break;
		case 3:
			texto = 'III';
			break;
		case 4:
			texto = 'IV';
			break;
		case 5:
			texto = 'V';
			break;
		default:
			break;
	}
	return texto;
}

/**
 * TODO generated, please specify type and doc for the params
 * @param code
 *
 * @properties={typeid:24,uuid:"9BD16773-5267-46B2-80BB-6CB189AFA1CF"}
 */
function getCodigoObstetrico_3(code){
	var texto = '';
	switch(utils.stringToNumber(code)){
		case 0:
			texto = 'No';
			break;
		case 1:
			texto = '1er. Trimestre';
			break;
		case 2:
			texto = '2do. Trimestre';
			break;
		case 3:
			
			break;
		case 4:
		texto = '3er. Trimestre';
			break;
		default:
			break;
	}
	return texto;
}

/**
 * TODO generated, please specify type and doc for the params
 * @param code
 *
 * @properties={typeid:24,uuid:"66CC02E3-5FA9-42D9-A08F-AFB6AF0E6390"}
 */
function getCodigoHematologico_4(code){
	var texto = '';
	switch(utils.stringToNumber(code)){
		case 0:
			texto = 'No';
			break;
		case 1:
			texto = 'Heparina';
			break;
		case 2:
			texto = 'Dicumarol';
			break;
		default:
			break;
	}
	return texto;
}

/**
 * TODO generated, please specify type and doc for the params
 * @param code
 *
 * @properties={typeid:24,uuid:"0217EF66-96FC-4A96-A7DA-B822E10FF52C"}
 */
function getCodigoRegistroHabitual_1(code){
	var texto = '';
	switch(utils.stringToNumber(code)){
		case 0:
			texto = 'No';
			break;
		case 1:
			texto = 'Alta';
			break;
		case 2:
			texto = 'Baja';
			break;
		case 3:
			texto = 'Desconoce';
			break;
		default:
			break;
	}
	return texto;
}

/**
 * TODO generated, please specify type and doc for the params
 * @param code
 *
 * @properties={typeid:24,uuid:"EC4CBA28-002D-44AC-8A96-DCC3FAD4C2B5"}
 */
function getCodigoRegistroHabitual_4(code){
	var texto = '';
	switch(utils.stringToNumber(code)){
		case 0:
			texto = 'No';
			break;
		case 1:
			texto = 'Exitado';
			break;
		case 2:
			texto = 'Deprimido';
			break;
		case 3:
			texto = 'Ansioso';
			break;
		case 4:
			texto = 'Colaborador';
			break;
		case 5:
			texto = 'Hiperemotivo';
			break;
		case 6:
			texto = 'Comatoso';
			break;
		case 7:
			texto = 'Indiferente';
			break;
		default:
			break;
	}
	return texto;
}

/**
 * TODO generated, please specify type and doc for the params
 * @param code
 *
 * @properties={typeid:24,uuid:"4D66477F-9208-46C5-9F8C-354B5602CD7F"}
 */
function getCodigoEscalaAlderete_1(code){
	var texto = '';
	switch(utils.stringToNumber(code)){
		case 0:
			break;
		case 1:
			texto = 'Incapaz de mover estremidades.';
			break;
		case 2:
			texto = 'Mueve 2 extremidades voluntariamente o ante ordenes.';
			$_totalEscAlderete += 1;
			break;
		case 3:
			texto = 'Mueve 4 extremidades voluntariamente o ante ordenes.';
			$_totalEscAlderete += 2;
			break;
		default:
			break;
	}
	return texto;
}

/**
 * TODO generated, please specify type and doc for the params
 * @param code
 *
 * @properties={typeid:24,uuid:"53F288DB-B723-4309-99FF-5E2D22C888D3"}
 */
function getCodigoEscalaAlderete_2(code){
	var texto = '';
	switch(utils.stringToNumber(code)){
		case 0:
			break;
		case 1:
			texto = 'Apnea.';
			break;
		case 2:
			texto = 'Disnea o limitacion a la respiracion.';
			$_totalEscAlderete += 1;
			break;
		case 3:
			texto = 'Capaz de respirar profundamente y toser libremente.';
			$_totalEscAlderete += 2;
			break;
		default:
			break;
	}
	return texto;
}

/**
 * TODO generated, please specify type and doc for the params
 * @param code
 *
 * @properties={typeid:24,uuid:"3292C584-5AD3-41C1-AF30-EEC208595D6F"}
 */
function getCodigoEscalaAlderete_3(code){
	var texto = '';
	switch(utils.stringToNumber(code)){
		case 0:
			break;
		case 1:
			texto = 'Presion arterial &#62; 50 % del nivel preanestesico.';
			break;
		case 2:
			texto = 'Presion arterial 20 - 49 % del nivel preanestesico.';
			$_totalEscAlderete += 1;
			break;
		case 3:
			texto = 'Presion arterial &#60; 20 % del nivel preanestesico.';
			$_totalEscAlderete += 2;
			break;
		default:
			break;
	}
	return texto;
}

/**
 * TODO generated, please specify type and doc for the params
 * @param code
 *
 * @properties={typeid:24,uuid:"67E74413-FE58-4E90-85B9-99A53C2497FF"}
 */
function getCodigoEscalaAlderete_4(code){
	var texto = '';
	switch(utils.stringToNumber(code)){
		case 0:
			break;
		case 1:
			texto = 'No responde.';
			break;
		case 2:
			texto = 'Responde a la llamada.';
			$_totalEscAlderete += 1;
			break;
		case 3:
			texto = 'Completamente despierto.';
			$_totalEscAlderete += 2;
			break;
		default:
			break;
	}
	return texto;
}

/**
 * TODO generated, please specify type and doc for the params
 * @param code
 *
 * @properties={typeid:24,uuid:"9FF3D09E-962A-41C5-9ED1-07007C476E98"}
 */
function getCodigoEscalaAlderete_5(code){
	var texto = '';
	switch(utils.stringToNumber(code)){
		case 0:
			break;
		case 1:
			texto = 'SaO2 &#60; 90 % con O2 suplementario.';
			break;
		case 2:
			texto = 'Necesita O2 para mantener SaO2 &#62; 90.';
			$_totalEscAlderete += 1;
			break;
		case 3:
			texto = 'Mantiene SaO2 &#62; 92 % con aire ambiente de oxigeno.';
			$_totalEscAlderete += 2;
			break;
		default:
			break;
	}
	return texto;
}
