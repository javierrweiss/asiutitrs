/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"08AB2A5D-424D-4C9D-B06A-6A09BA92EBB9",variableType:4}
 */
var Palab_medPerCodPrint = 0;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"642FE9B9-F51A-4D4B-A99C-A964C1E3CCDF",variableType:4}
 */
var Palab_prot4Print = 0;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"113A40DC-F324-4184-BDF0-85D391CBEBCA",variableType:4}
 */
var Palab_det3Print = 0;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"4FA1F17C-5F02-46E2-B7DA-82E2BABC177E",variableType:4}
 */
var Palab_det2Print = 0;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"59300CDD-E44E-465D-A588-24FCC7BFD771",variableType:4}
 */
var Palab_det1Print = 0;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"F897C127-667F-4628-9EEF-4DACC650FD04",variableType:4}
 */
var Palab_sfSectorPrint = 0;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"60214E10-82A1-426F-B8FF-5ED11BAA5EE4",variableType:4}
 */
var Palab_sfEmpresaPrint = 0;

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"EBBD4BAA-5851-4270-823F-DF18F01D0A9C"}
 */
var Palab_ploPlanxPrint = '';

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"EE2D5BA8-D6E5-448D-BA5E-C8718D52351D",variableType:4}
 */
var Palab_ploObraPrint = 0;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"C0442C7F-4F99-4482-9A24-7E9F3B8263BE",variableType:4}
 */
var Palab_obrCodigoPrint = 0;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"9B52671F-BD2E-40E4-A8F6-A500FD82323C",variableType:4}
 */
var Palab_admHistClin = 0;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"5F7FC677-9449-4C57-A5DC-9F38FDE8CD50",variableType:4}
 */
var Palab_achHistCl = 0;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"B45034A8-0D57-4BC9-918D-274D26213100",variableType:4}
 */
var Palab_hisclinPrint = 0;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"413FFBA3-20D2-4A7E-9082-EFCEC5722EF1",variableType:4}
 */
var Palab_codAutoHist = 0;

/**
 * @properties={typeid:35,uuid:"2AE1FFFC-2A46-478F-AF32-6D92ECA07DF8",variableType:-4}
 */
var Palab_listAnalisis = new Array();

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"BC25C7A9-D38B-477C-AAA7-9D6378B8CC22",variableType:4}
 */
var Palab_perLegajo = 0;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"0D9583F5-2833-48E2-B3AE-0BB4BB1DF4E0",variableType:4}
 */
var Palab_medCodigo = 0;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"B9AB32D0-06C5-426F-B271-F27F524E090B",variableType:4}
 */
var Palab_ana1 = 0;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"14BD37B4-F6B7-4538-8012-F614AB2BFEEE",variableType:4}
 */
var Palab_ana24 = 0;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"D2409FA3-A009-4732-86DC-DC4F084210B1",variableType:4}
 */
var Palab_proto5 = 0;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"9B91917A-A250-468E-A9AE-8258E2660453",variableType:4}
 */
var Palab_proto4 = 0;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"9DFD4089-3E28-42BA-BD2E-0A2F51511185",variableType:4}
 */
var Palab_proto1 = 0;

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"65C5473F-EDFB-406F-8178-E93051B8961D"}
 */
var Palab_anaCodAlfa = '';

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"46FDC70A-BA8F-433A-960A-6ED0882259C4",variableType:4}
 */
var Palab_anaCod = 0;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"230D1943-4728-44D8-B046-3014E3929B77",variableType:4}
 */
var Palab_utiliza = 0;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"72CDB793-F21E-4B21-A9FA-B8F4241A47A5",variableType:4}
 */
var Palab_obrCodigo = 0;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"A3E69979-5452-44DB-A662-A9A270CBADCB",variableType:4}
 */
var Palab_eventSourceButton = 0;

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"FB514863-C107-4B12-AA1D-FCB6BB305AA4"}
 */
var Palab_hisclistrynro = '';

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"E1052665-6B38-4959-9980-C64F48A1969E",variableType:4}
 */
var Palab_hisclin = 0;
/**
 * @properties={typeid:35,uuid:"A8BE6A49-3FAD-4726-896A-8FDF0AED62AE",variableType:-4}
 */
var gbl_permisos_Palab = new Array();

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"E7071EE2-CE84-4D03-A492-89944A38707B"}
 */
var Palab_vPassOperador = '';
/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"B6FD65D4-FA4F-4B86-AB7C-641EF3A2B25D",variableType:4}
 */
var Palab_vTipoTecnico = 0;
/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"A2441261-14AF-4BF6-BA41-60C33D7DB863",variableType:4}
 */
var Palab_vTipoOperador = 0;
/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"1134A62C-5AFD-4BE9-B729-71565DDA0740",variableType:4}
 */
var Palab_digito_verificador = 0;
/**
 * @properties={typeid:35,uuid:"D04ABFE5-6C61-4AB1-9C0D-EDCC5196670E",variableType:-4}
 */
var Palab_vDigVerif = false;
/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"14C42E84-E701-465B-835B-A343EC036501",variableType:4}
 */
var Palab_vlargo = 0;
/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"70388B90-AF1C-4DA7-9EF3-76494C508DF7",variableType:4}
 */
var Palab_vClave = 0;
/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"2CCB682D-059C-48B3-9195-63E9D7A92B76"}
 */
var Palab_vOperador = '';
/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"621A5423-668E-4C5C-9900-38AD2CF8C257",variableType:4}
 */
var Palab_vLega = 0;
/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"11D059B5-C3D5-4B31-B2F2-D99BED4CD90E",variableType:4}
 */
var Palab_vLegajo = 0;
/**
 * @properties={typeid:35,uuid:"1EC65851-74C4-4F50-9B00-B04007B06633",variableType:-4}
 */
var Palab_esAnestesista = false;
/**
 * @properties={typeid:35,uuid:"AAC787CA-71E9-44B9-84D2-B26E9735CE24",variableType:-4}
 */
var Palab_vSolomedicos = true;
/**
 * @properties={typeid:35,uuid:"69C00586-13C0-4F52-A0B0-C7F255EACC6E",variableType:-4}
 */
var Palab_permisos = new Array();



/**
 * @properties={typeid:24,uuid:"F345CB81-1006-44D4-87E6-00CC72696C0C"}
 */
function onSolutionOpen_palab() {
	
	plugins.window.getMenuBar().setVisible(false)
    plugins.window.setToolBarAreaVisible(false)
    
    var names1 = plugins.window.getToolbarNames();
    for (var i = 0 ; i < names1.length ; i++) {
         plugins.window.removeToolBar(names1[i])
    }    
    plugins.window.setFullScreen(false)
    plugins.window.getMenuBar().setVisible(false)
    plugins.window.setToolBarAreaVisible(false)
	plugins.window.setStatusBarVisible(false);
    
    databaseManager.setAutoSave(false);
}

/**
 * @properties={typeid:24,uuid:"5088CBEF-205E-409B-808D-B03D18D5D07B"}
 */
function Palab_formatearHistclin() {
	var histClin = '';
	if(arguments[0] != undefined)
		histClin =  arguments[0].toString().substr(0,arguments[0].toString().length-1)+"/"+arguments[0].toString().substr(arguments[0].toString().length -1,1)	

	return histClin;
}

/**
 * TODO generated, please specify type and doc for the params
 * @param fecha_nac
 * @param fechaHasta
 *
 * @properties={typeid:24,uuid:"18152486-2614-49EF-8199-3206F5DC297A"}
 */
function Palab_calcularEdad(fecha_nac,fechaHasta) {
	var final_mes = new Array(31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31);

	//globals.fecha_aux = fecha_nac;
	var fecha_aux1 = fecha_nac.toString()
	var anio_nac = utils.stringToNumber(fecha_aux1.substr(0,4))
	var mes_nac = utils.stringToNumber(fecha_aux1.substr(4,2))
	var dia_nac = utils.stringToNumber(fecha_aux1.substr(6,2))
	
	var fecha_aux2 = fechaHasta.toString()
	var anio_hasta = utils.stringToNumber(fecha_aux2.substr(0,4))
	var mes_hasta = utils.stringToNumber(fecha_aux2.substr(4,2))
	var dia_hasta = utils.stringToNumber(fecha_aux2.substr(6,2))
	
	var anio_actual = anio_hasta;
	var resto = anio_actual % 4;
	if (resto == 0) final_mes[1] = 29;
	var edad = anio_hasta - anio_nac;
	if (edad != 0) {
		if ((mes_hasta) < mes_nac) {
			--edad;
		} else {
			if ((mes_hasta) == mes_nac) {
				if (dia_hasta < dia_nac) {
					--edad;
				}
			}
		}
		
		if (edad > 1) {
			globals.vTipoEdad = "años";
		} else {
			if (edad == 1){
			    globals.vTipoEdad = "año";
			}else{
				if (mes_nac > (mes_hasta)){
					edad = mes_nac - (mes_hasta) 
				}else{
				    edad = (mes_hasta) - mes_nac
				}
				if (edad != 0) {
					if (edad > 1) {
						globals.vTipoEdad = "meses";
					} else {
						if (dia_hasta < dia_nac) {
							edad = (dia_hasta + final_mes[mes_nac]) - dia_nac;
							globals.vTipoEdad = "días"
						} else {
							globals.vTipoEdad = "mes";
						}
					}
				} else {
					if (dia_nac > (mes_hasta)){
						edad = dia_nac - (mes_hasta) 
					}else{
					    edad = dia_hasta - dia_nac
					}
					if (edad > 1) {
						globals.vTipoEdad = "días";
					} else {
						edad = 1;
						globals.vTipoEdad = "día";
					}
				}				
			}				
		}
	} else {
		if (mes_nac > (mes_hasta)){
			edad = mes_nac - (mes_hasta) 
		}else{
		    edad = (mes_hasta) - mes_nac
		}
		if (edad != 0) {
			if (edad > 1) {
				globals.vTipoEdad = "meses";
			} else {
				if (dia_hasta < dia_nac) {
					edad = (dia_hasta + final_mes[mes_nac]) - dia_nac;
					globals.vTipoEdad = "días"
				} else {
					globals.vTipoEdad = "mes";
				}
			}
		} else {
			if (dia_nac > (mes_hasta)){
				edad = dia_nac - (mes_hasta) 
			}else{
			    edad = dia_hasta - dia_nac
			}
			if (edad > 1) {
				globals.vTipoEdad = "días";
			} else {
				edad = 1;
				globals.vTipoEdad = "día";
			}
		}
	}
	return edad
}

/**
 * @properties={typeid:24,uuid:"C2DE9F09-03FA-4524-9FEC-BA67D75C80FA"}
 * @AllowToRunInFind
 */
function llamada_a_Palabint(args) {
	
	var globalVariables = solutionModel.getGlobalVariables('globals');
	for (var e in globalVariables){
		globalVariables[e]=globalVariables[e].defaultValue
		
	}
	
	if(args != null && args !=''){
		args = args.toString()
		args=args.split(';')
		globals.vLegajo=utils.stringToNumber(args[0])
		globals.vLega=utils.stringToNumber(args[1])
		globals.vOperador=args[2]
		globals.vTipoOperador=utils.stringToNumber(args[3])
		globals.gbl_transacciones_1=0
		globals.vEmpresa=args[5]
		globals.gbl_expanding_Nodes=args[6]
		globals.gbl_title = ' '
	}
    

    //Cargar permisos
    var $ip         = application.getIPAddress()
    var $solucion   =  application.getSolutionName()
    var $Args       = new Array()
    var $SQL ="select  PERF.codigo_perfil, PERF.codigo_solucion, PERF.codigo_formulario, PERF.codigo_elemento, "
             +"PERF.visible, PERF.accesible, SOL.control_acceso "
             +"from tbl_permiso "
             +"left join tbl_perfil_itm PERF on tbl_permiso.codigo_perfil = PERF.codigo_perfil "
             +"left join tbl_solucion SOL on PERF.codigo_solucion = SOL.codigo "
             +"where tbl_permiso.codigo_legajo = "
             + globals.vLega
             if (globals.vLega == 0){
                 $SQL = $SQL + " and ip = '"
                 + $ip + "'"
             }
             $SQL = $SQL + " and PERF.codigo_solucion = '"
             + $solucion
             +"' order by PERF.codigo_perfil asc, PERF.codigo_solucion asc, PERF.codigo_formulario asc, PERF.codigo_elemento asc"
    gbl_permisos_Palab = databaseManager.getDataSetByQuery("desal", $SQL, $Args, -1);
    var $max = gbl_permisos_Palab.getMaxRowIndex()
    if(!$max){ return}

    //Pide legajo si la Solucion lo requiere
    //if(gbl_permisos_Palab.getValue(1,7)== true){
    var win = application.createWindow("legajo_medico",JSWindow.MODAL_DIALOG)	
    win.title= 'Ingrese Legajo del médico'
    win.setSize(570,260)
    win.resizable = false
    win.show(forms.Palab_dlg_pideLegajoMedico)
	//win.destroy()
	if(globals.Palab_esAnestesista && globals.Palab_vSolomedicos ){}
	else{return}
    
   
      //  if(globals.gbl_user == false){return}
        
        globals.Palab_medCodigo=globals.Palab_vLega;
    	globals.Palab_medPerCodPrint=globals.Palab_vLega
        //Muestra Formulario Principal
   
        var $form = 'Palab_frm_palab_inter'
        
               
         globals.gbl_transacciones_1=0
         globals.gbl_permisos=gbl_permisos_Palab
         globals.vOperadorActual=globals.vOperador
         win = application.createWindow("Menu_itm",JSWindow.MODAL_DIALOG)
         win.title= globals.gbl_title
         win.resizable = true
		 win.resetBounds()
         win.show(forms[$form])
         win.destroy()
   
}


/**
 * @properties={typeid:24,uuid:"9A764000-951C-46A8-BDBC-7A080D30FCE7"}
 */
function palab_calculaDigitoVerificador() {
	var aux_dig = new Array(5);
	if(globals.Palab_vlargo==2){
		aux_dig[0] = 0
		aux_dig[1] = 0
		aux_dig[2] = 0
		aux_dig[3] = globals.Palab_vLega.toString().substr(0,1);
		aux_dig[4] = globals.Palab_vLega.toString().substr(1,1);
	}else{
		if (globals.Palab_vlargo==3){
			aux_dig[0] = 0
			aux_dig[1] = 0
			aux_dig[2] = globals.Palab_vLega.toString().substr(0,1);
			aux_dig[3] = globals.Palab_vLega.toString().substr(1,1);
			aux_dig[4] = globals.Palab_vLega.toString().substr(2,1);
		}else{
			if(globals.Palab_vlargo==4){
				aux_dig[0] = 0
				aux_dig[1] = globals.Palab_vLega.toString().substr(0,1);
				aux_dig[2] = globals.Palab_vLega.toString().substr(1,1);
				aux_dig[3] = globals.Palab_vLega.toString().substr(2,1);
				aux_dig[4] = globals.Palab_vLega.toString().substr(3,1);
			}else{
				if(globals.Palab_vlargo==5){
					aux_dig[0] = globals.Palab_vLega.toString().substr(0,1);
					aux_dig[1] = globals.Palab_vLega.toString().substr(1,1);
					aux_dig[2] = globals.Palab_vLega.toString().substr(2,1);
					aux_dig[3] = globals.Palab_vLega.toString().substr(3,1);
					aux_dig[4] = globals.Palab_vLega.toString().substr(4,1);
				}
			}
		}
	}
	var verificador = 0;
	verificador = utils.stringToNumber(aux_dig[1]) + utils.stringToNumber(aux_dig[2]) * 3 + utils.stringToNumber(aux_dig[3]) * 9 + utils.stringToNumber(aux_dig[4]) * 7;
	var larg = verificador.toString().length - 1;
	if(globals.Palab_digito_verificador!=verificador.toString().substr(larg,1)){
		globals.Palab_vDigVerif=false
	}

}