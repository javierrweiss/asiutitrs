/**
 * @properties={typeid:35,uuid:"981BC470-B6DC-4EE8-B97F-FCFF501EBB63",variableType:-4}
 */
var AsiUcoTrs_bloqueado = false;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"C8D19501-4804-4715-A2C7-BF7B66542E41",variableType:8}
 */
var AsiUcoTrs_alerHistClin = 0;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"6B478369-6B2F-45CB-B9FD-E7B92EAF14CF",variableType:4}
 */
var AsiUcoTrs_txtItem = 0;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"9F7D0D1A-F975-40FC-82D1-3126BE800706",variableType:4}
 */
var AsiUcoTrs_txtHora = 0;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"966AD170-9309-4F21-AAF7-2EEE2736D0D6",variableType:4}
 */
var AsiUcoTrs_txtGrupo = 0;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"BEB7D874-90D9-462E-BD82-D8A8976A3778",variableType:4}
 */
var AsiUcoTrs_txtFecha = 0;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"6D9C07EB-C16E-4D5B-8D32-35B9BB7A7550",variableType:8}
 */
var AsiUcoTrs_txtHistClinica = 0;

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"33A13B26-AE18-423B-BEAC-6CF8EC69F17D"}
 */
var AsiUcoTrs_patDataProvider = null;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"4ECFB8C6-7691-43C0-8674-FDD8EC847BB1",variableType:8}
 */
var AsiUcoTrs_hiuHisCli_scroll = 0;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"ED045F10-B120-4C00-B377-BCA855B29334",variableType:4}
 */
var AsiUcoTrs_hiuHora = 0;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"0204D2A4-0DD7-4B06-A6D4-6AD9DB479E44",variableType:4}
 */
var AsiUcoTrs_hiuFecha = 0;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"F72D046A-B549-4869-BC33-1FF14EF1B0CD",variableType:8}
 */
var AsiUcoTrs_hiuHisCli = 0;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"675A46FB-7FA4-4E1B-B70C-75E3EC8C1364",variableType:8}
 */
var AsiUcoTrs_adm_HistClin = 0;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"A0C2FF36-B1BB-4C1E-987C-92D24451D908",variableType:4}
 */
var AsiUcoTrs_nroHabi = 0;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"477EEEF7-E5DC-4E5B-9C6F-70D950B28392",variableType:4}
 */
var AsiUcoTrs_obrCodigo = 0;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"E847BBE9-E094-4754-B358-F3B1A077FDE1",variableType:4}
 */
var AsiUcoTrs_hisclin = 0;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"C28B7C40-63F0-4702-A215-E87C15149650",variableType:4}
 */
var AsiUcoTrs_eventSourceButton = 0;

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"AC803AB5-F24F-4D55-84B9-9F6EA7495D63"}
 */
var AsiUcoTrs_hisclistrynro = '';

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"1B6C6468-D315-48E4-8C6E-E651A4AEFDF6",variableType:4}
 */
var AsiUcoTrs_vTipoTecnico = 0;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"A92998DC-D772-4110-839F-D2851FD66590",variableType:4}
 */
var AsiUcoTrs_vTipoOperador = 0;

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"9820967D-F487-46C7-A766-408DCE876452"}
 */
var AsiUcoTrs_vPassOperador = '';

/**
 * @properties={typeid:35,uuid:"B8CD1CAF-1804-4C9E-A7A4-A0DC10CDB50D",variableType:-4}
 */
var AsiUcoTrs_vDigVerif = false;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"79C21DCB-CF0C-471D-B5E4-8FE8D90DEBC7",variableType:8}
 */
var AsiUcoTrs_digito_verificador = 0;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"357C90E8-7636-41E4-9024-62E9D1412EAA",variableType:8}
 */
var AsiUcoTrs_vlargo = 0;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"9900ACD2-F9AB-47E1-B50A-A8BA2CCD70E9",variableType:4}
 */
var AsiUcoTrs_vEspeMed = 0;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"87FE2729-43AF-40C4-BCC3-2291CCCB8E83",variableType:8}
 */
var AsiUcoTrs_vClave = 0;

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"D824759C-B98F-4038-8A5B-B7D602BC11F4"}
 */
var AsiUcoTrs_vOperador = '';

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"9CF0363F-FE49-43A8-BFF0-74919369D436",variableType:8}
 */
var AsiUcoTrs_vLega = 0;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"CB606686-28CA-4B15-A237-DF21FFD49880",variableType:8}
 */
var AsiUcoTrs_vLegajo = 0;

/**
 * @properties={typeid:35,uuid:"92AB5485-CE48-4456-BF85-DCC061933E03",variableType:-4}
 */
var AsiUcoTrs_esAnestesista = false;

/**
 * @properties={typeid:35,uuid:"C64FA4CD-8EEC-4A96-BFFC-94BE5ADEBDD4",variableType:-4}
 */
var AsiUcoTrs_vSolomedicos = true;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"AF3374FC-9253-4230-A34D-13B81B8B6E01",variableType:-4}
 */
var AsiUcoTrs_permisos = new Array();

/**
 * @properties={typeid:24,uuid:"64CBFD7D-C451-4712-A820-0A877034D798"}
 */
function onSolutionOpen_AsiUcoTrs() {
	
	plugins.window.getMenuBar().setVisible(false)
    plugins.window.setToolBarAreaVisible(false)
    
    var names1 = plugins.window.getToolbarNames();
    for (var i = 0 ; i < names1.length ; i++) {
         plugins.window.removeToolBar(names1[i])
    }    
    plugins.window.setFullScreen(false)
    plugins.window.getMenuBar().setVisible(false)
    plugins.window.setToolBarAreaVisible(false)
	plugins.window.setStatusBarVisible(false);
    
    databaseManager.setAutoSave(false)
}

/**
 * TODO generated, please specify type and doc for the params
 * @param args
 *
 * @properties={typeid:24,uuid:"CB40D3AE-006F-40F9-8D7A-11235FFA79C5"}
 */
function llamada_desde_Menu(args) {
	
	// Trae datos desde el Menu
	args = args.toString()
	args=args.split(';') 
	globals.vLegajo=utils.stringToNumber(args[0])
	globals.vLega=utils.stringToNumber(args[1])
	globals.vOperador=args[2]
	globals.vTipoOperador=utils.stringToNumber(args[3])
	globals.gbl_transacciones_1= 0 //args[4] 
	globals.vEmpresa=args[5]
	globals.gbl_expanding_Nodes=args[6]
	globals.gbl_title= 'Historia Clínica de Ingreso a Piso'
	forms.frm_menu.elements.frm_main.dividerLocation = 0.20	// divide ventana
	application.updateUI()
	
	//Cargar permisos
	var $ip         = application.getIPAddress()
	var $solucion   =  application.getSolutionName()	
	var $Args       = new Array()
	var $SQL ="select  PERF.codigo_perfil, PERF.codigo_solucion, PERF.codigo_formulario, PERF.codigo_elemento, " 
             +"PERF.visible, PERF.accesible "
	         +"from tbl_permiso "
             +"left join tbl_perfil_itm PERF on tbl_permiso.codigo_perfil = PERF.codigo_perfil "             
             +"where tbl_permiso.codigo_legajo = "
             + globals.vLega
			 if (globals.vLega == 0){
				 $SQL = $SQL + " and ip = '"
				 + $ip + "'"
			 }
			 $SQL = $SQL + " and PERF.codigo_solucion = '"
			 + $solucion
             +"' order by PERF.codigo_perfil asc, PERF.codigo_solucion asc, PERF.codigo_formulario asc, PERF.codigo_elemento asc"
    globals.AsiUcoTrs_permisos = databaseManager.getDataSetByQuery("desal", $SQL, $Args, -1);	
    var $max = globals.AsiUcoTrs_permisos.getMaxRowIndex()
	if(!$max){ return}
    
	//Pide legajo de medico para acceder al form
	globals.AsiUcoTrs_vSolomedicos=true
	globals.AsiUcoTrs_esAnestesista=false
	globals.AsiUcoTrs_vLegajo=0
	globals.AsiUcoTrs_vLega=0
	globals.AsiUcoTrs_vOperador=''
	globals.AsiUcoTrs_vClave=0
	globals.AsiUcoTrs_vEspeMed = 0;
    var win = application.createWindow("legajo_medico",JSWindow.MODAL_DIALOG)	
    win.title= 'Ingrese Legajo del médico'
    win.setSize(570,260)
    win.resizable = false
    win.show(forms.AsiUcoTrs_dlg_pideLegajoMedico)
	win.destroy()
	if(globals.AsiUcoTrs_esAnestesista && globals.AsiUcoTrs_vSolomedicos ){}
	else{return}

	//Muestra Formulario Principal
	win = application.createWindow("Menu_item",JSWindow.MODAL_DIALOG)	
    win.title= globals.gbl_title
    win.resizable = false	
    win.show(forms.AsiUcoTrs_frm_hciuco)
	win.destroy()
	
}

/**
 * @properties={typeid:24,uuid:"C73D21C2-3C8A-4639-B402-399C355CD2AB"}
 */
function AsiUcoTrs_formatearHistclin() {
	var histClin = '';
	if(arguments[0] != undefined)
		histClin =  arguments[0].toString().substr(0,arguments[0].toString().length-1)+"/"+arguments[0].toString().substr(arguments[0].toString().length -1,1)	

	return histClin;
}

/**
 * TODO generated, please specify type and doc for the params
 * @param realValue
 *
 * @properties={typeid:24,uuid:"04E38231-D0E5-4414-A0F7-4F1477907917"}
 */
function AsiUcoTrs_convertNumberToHour_HHMM(realValue) {
	
	var hora = "";
	if(realValue != null){
		var value = Number(realValue);
		if(value < 1){
			hora = "00:00";
		}
		else{
			if(value < 10){
				hora = "00:0" + value.toString().substr(0,1);
			}
			else{
				if(value < 100){
					hora = "00:" + value.toString().substr(0,2);
				}
				else{
					if(value < 1000){
						hora = "0" + value.toString().substr(0,1) + ":" + value.toString().substr(1,2);
					}
					else{
						if(value <= 2359){
							hora = value.toString().substr(0,2) + ":" + value.toString().substr(2,2);
						}
					}
				}
			}
		}
	}
	
	return hora;
}

/**
 * @properties={typeid:24,uuid:"BBE00B1F-D140-43B8-9F98-93AF425313CF"}
 */
function AsiUcoTrs_calculaDigitoVerificador() {
	var aux_dig = new Array(5);
	if(globals.AsiUcoTrs_vlargo==2){
		aux_dig[0] = 0
		aux_dig[1] = 0
		aux_dig[2] = 0
		aux_dig[3] = globals.AsiUcoTrs_vLega.toString().substr(0,1);
		aux_dig[4] = globals.AsiUcoTrs_vLega.toString().substr(1,1);
	}else{
		if (globals.AsiUcoTrs_vlargo==3){
			aux_dig[0] = 0
			aux_dig[1] = 0
			aux_dig[2] = globals.AsiUcoTrs_vLega.toString().substr(0,1);
			aux_dig[3] = globals.AsiUcoTrs_vLega.toString().substr(1,1);
			aux_dig[4] = globals.AsiUcoTrs_vLega.toString().substr(2,1);
		}else{
			if(globals.AsiUcoTrs_vlargo==4){
				aux_dig[0] = 0
				aux_dig[1] = globals.AsiUcoTrs_vLega.toString().substr(0,1);
				aux_dig[2] = globals.AsiUcoTrs_vLega.toString().substr(1,1);
				aux_dig[3] = globals.AsiUcoTrs_vLega.toString().substr(2,1);
				aux_dig[4] = globals.AsiUcoTrs_vLega.toString().substr(3,1);
			}else{
				if(globals.AsiUcoTrs_vlargo==5){
					aux_dig[0] = globals.AsiUcoTrs_vLega.toString().substr(0,1);
					aux_dig[1] = globals.AsiUcoTrs_vLega.toString().substr(1,1);
					aux_dig[2] = globals.AsiUcoTrs_vLega.toString().substr(2,1);
					aux_dig[3] = globals.AsiUcoTrs_vLega.toString().substr(3,1);
					aux_dig[4] = globals.AsiUcoTrs_vLega.toString().substr(4,1);
				}
			}
		}
	}
	var verificador = 0;
	verificador = utils.stringToNumber(aux_dig[1]) + utils.stringToNumber(aux_dig[2]) * 3 + utils.stringToNumber(aux_dig[3]) * 9 + utils.stringToNumber(aux_dig[4]) * 7;
	var larg = verificador.toString().length - 1;
	if(globals.AsiUcoTrs_digito_verificador!=verificador.toString().substr(larg,1)){
		globals.AsiUcoTrs_vDigVerif=false
	}

}
